machine:
  java:
    version: oraclejdk8

dependencies:
  pre:
    - sudo apt-get update; sudo apt-get install nsis git
    - wget http://www.mirrorservice.org/sites/downloads.sourceforge.net/l/la/launch4j/launch4j-3/3.8/launch4j-3.8-linux.tgz
    - tar xzf launch4j-3.8-linux.tgz
    - cd launch4j
    - chmod +x launch4j
  override:
    - TERM=dumb ./gradlew dependencies

test:
  override:
    - TERM=dumb ./gradlew test
  post:
    - TERM=dumb export PATH=$PATH:`pwd`/launch4j && ./gradlew -Pdev=true -PnsisExec="/usr/bin/makensis" release --stacktrace
    - TERM=dumb ./gradlew makeReleasesAvailableOnCircleCI
