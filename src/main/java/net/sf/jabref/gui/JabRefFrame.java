begin_unit|revision:0.9.5;language:Java;cregit-version:0.0.1
begin_comment
comment|/*  Copyright (C) 2003-2015 JabRef contributors.     This program is free software; you can redistribute it and/or modify     it under the terms of the GNU General Public License as published by     the Free Software Foundation; either version 2 of the License, or     (at your option) any later version.      This program is distributed in the hope that it will be useful,     but WITHOUT ANY WARRANTY; without even the implied warranty of     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the     GNU General Public License for more details.      You should have received a copy of the GNU General Public License along     with this program; if not, write to the Free Software Foundation, Inc.,     51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA. */
end_comment

begin_package
DECL|package|net.sf.jabref.gui
package|package
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|gui
package|;
end_package

begin_import
import|import
name|java
operator|.
name|awt
operator|.
name|Component
import|;
end_import

begin_import
import|import
name|java
operator|.
name|awt
operator|.
name|Cursor
import|;
end_import

begin_import
import|import
name|java
operator|.
name|awt
operator|.
name|Dimension
import|;
end_import

begin_import
import|import
name|java
operator|.
name|awt
operator|.
name|Font
import|;
end_import

begin_import
import|import
name|java
operator|.
name|awt
operator|.
name|Frame
import|;
end_import

begin_import
import|import
name|java
operator|.
name|awt
operator|.
name|GraphicsEnvironment
import|;
end_import

begin_import
import|import
name|java
operator|.
name|awt
operator|.
name|GridBagConstraints
import|;
end_import

begin_import
import|import
name|java
operator|.
name|awt
operator|.
name|GridBagLayout
import|;
end_import

begin_import
import|import
name|java
operator|.
name|awt
operator|.
name|Insets
import|;
end_import

begin_import
import|import
name|java
operator|.
name|awt
operator|.
name|Rectangle
import|;
end_import

begin_import
import|import
name|java
operator|.
name|awt
operator|.
name|Toolkit
import|;
end_import

begin_import
import|import
name|java
operator|.
name|awt
operator|.
name|Window
import|;
end_import

begin_import
import|import
name|java
operator|.
name|awt
operator|.
name|event
operator|.
name|ActionEvent
import|;
end_import

begin_import
import|import
name|java
operator|.
name|awt
operator|.
name|event
operator|.
name|KeyAdapter
import|;
end_import

begin_import
import|import
name|java
operator|.
name|awt
operator|.
name|event
operator|.
name|KeyEvent
import|;
end_import

begin_import
import|import
name|java
operator|.
name|awt
operator|.
name|event
operator|.
name|MouseAdapter
import|;
end_import

begin_import
import|import
name|java
operator|.
name|awt
operator|.
name|event
operator|.
name|WindowAdapter
import|;
end_import

begin_import
import|import
name|java
operator|.
name|awt
operator|.
name|event
operator|.
name|WindowEvent
import|;
end_import

begin_import
import|import
name|java
operator|.
name|io
operator|.
name|File
import|;
end_import

begin_import
import|import
name|java
operator|.
name|io
operator|.
name|IOException
import|;
end_import

begin_import
import|import
name|java
operator|.
name|net
operator|.
name|URL
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|ArrayList
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Arrays
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|HashMap
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|HashSet
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|LinkedList
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|List
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|SortedSet
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Vector
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|AbstractAction
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|Action
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|Box
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|ImageIcon
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|JButton
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|JComponent
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|JDialog
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|JEditorPane
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|JFrame
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|JLabel
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|JMenu
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|JMenuBar
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|JOptionPane
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|JPanel
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|JProgressBar
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|JScrollPane
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|JSplitPane
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|JTabbedPane
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|JToggleButton
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|JToolBar
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|KeyStroke
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|ScrollPaneConstants
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|SwingConstants
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|SwingUtilities
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|TransferHandler
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|UIManager
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|WindowConstants
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|event
operator|.
name|ChangeEvent
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|event
operator|.
name|ChangeListener
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|*
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|gui
operator|.
name|action
operator|.
name|AutoLinkFilesAction
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|gui
operator|.
name|worker
operator|.
name|AbstractWorker
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|gui
operator|.
name|worker
operator|.
name|MarkEntriesAction
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|gui
operator|.
name|preftabs
operator|.
name|PreferencesDialog
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|imports
operator|.
name|*
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|logic
operator|.
name|l10n
operator|.
name|Localization
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|logic
operator|.
name|util
operator|.
name|OS
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|model
operator|.
name|BibtexDatabase
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|model
operator|.
name|BibtexEntry
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|model
operator|.
name|BibtexEntryType
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|commons
operator|.
name|logging
operator|.
name|Log
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|commons
operator|.
name|logging
operator|.
name|LogFactory
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|export
operator|.
name|AutoSaveManager
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|export
operator|.
name|ExportCustomizationDialog
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|export
operator|.
name|ExportFormats
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|export
operator|.
name|SaveAllAction
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|export
operator|.
name|SaveDatabaseAction
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|external
operator|.
name|ExternalFileTypeEditor
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|external
operator|.
name|PushToApplicationButton
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|groups
operator|.
name|EntryTableTransferHandler
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|groups
operator|.
name|GroupSelector
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|gui
operator|.
name|menus
operator|.
name|help
operator|.
name|ForkMeOnGitHubAction
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|gui
operator|.
name|help
operator|.
name|HelpAction
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|gui
operator|.
name|help
operator|.
name|HelpDialog
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|gui
operator|.
name|journals
operator|.
name|ManageJournalsAction
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|oo
operator|.
name|OpenOfficePanel
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|specialfields
operator|.
name|Printed
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|specialfields
operator|.
name|Priority
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|specialfields
operator|.
name|Quality
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|specialfields
operator|.
name|Rank
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|specialfields
operator|.
name|ReadStatus
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|specialfields
operator|.
name|Relevance
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|specialfields
operator|.
name|SpecialFieldsUtils
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|sql
operator|.
name|importer
operator|.
name|DbImportAction
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|gui
operator|.
name|undo
operator|.
name|NamedCompound
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|gui
operator|.
name|undo
operator|.
name|UndoableInsertEntry
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|gui
operator|.
name|undo
operator|.
name|UndoableRemoveEntry
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|util
operator|.
name|ManageKeywordsAction
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|util
operator|.
name|MassSetFieldAction
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|logic
operator|.
name|util
operator|.
name|StringUtil
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|util
operator|.
name|Util
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|wizard
operator|.
name|auximport
operator|.
name|gui
operator|.
name|FromAuxDialog
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|wizard
operator|.
name|integrity
operator|.
name|gui
operator|.
name|IntegrityWizard
import|;
end_import

begin_import
import|import
name|com
operator|.
name|jgoodies
operator|.
name|looks
operator|.
name|HeaderStyle
import|;
end_import

begin_import
import|import
name|com
operator|.
name|jgoodies
operator|.
name|looks
operator|.
name|Options
import|;
end_import

begin_import
import|import
name|osx
operator|.
name|macadapter
operator|.
name|MacAdapter
import|;
end_import

begin_comment
comment|/**  * The main window of the application.  */
end_comment

begin_class
DECL|class|JabRefFrame
specifier|public
class|class
name|JabRefFrame
extends|extends
name|JFrame
implements|implements
name|OutputPrinter
block|{
DECL|field|serialVersionUID
specifier|private
specifier|static
specifier|final
name|long
name|serialVersionUID
init|=
literal|1L
decl_stmt|;
DECL|field|contentPane
specifier|final
name|JSplitPane
name|contentPane
init|=
operator|new
name|JSplitPane
argument_list|()
decl_stmt|;
DECL|field|prefs
specifier|final
name|JabRefPreferences
name|prefs
init|=
name|Globals
operator|.
name|prefs
decl_stmt|;
DECL|field|prefsDialog
specifier|private
name|PreferencesDialog
name|prefsDialog
decl_stmt|;
DECL|field|lastTabbedPanelSelectionIndex
specifier|private
name|int
name|lastTabbedPanelSelectionIndex
init|=
operator|-
literal|1
decl_stmt|;
comment|// The sidepane manager takes care of populating the sidepane.
DECL|field|sidePaneManager
specifier|public
name|SidePaneManager
name|sidePaneManager
decl_stmt|;
DECL|field|tabbedPane
specifier|public
name|JTabbedPane
name|tabbedPane
decl_stmt|;
comment|// initialized at constructor
DECL|field|marg
specifier|private
specifier|final
name|Insets
name|marg
init|=
operator|new
name|Insets
argument_list|(
literal|1
argument_list|,
literal|0
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|)
decl_stmt|;
DECL|field|jabRef
specifier|private
specifier|final
name|JabRef
name|jabRef
decl_stmt|;
DECL|field|LOGGER
specifier|private
specifier|static
specifier|final
name|Log
name|LOGGER
init|=
name|LogFactory
operator|.
name|getLog
argument_list|(
name|JabRefFrame
operator|.
name|class
argument_list|)
decl_stmt|;
DECL|class|ToolBar
class|class
name|ToolBar
extends|extends
name|JToolBar
block|{
DECL|field|serialVersionUID
specifier|private
specifier|static
specifier|final
name|long
name|serialVersionUID
init|=
literal|1L
decl_stmt|;
DECL|method|addAction (Action a)
name|void
name|addAction
parameter_list|(
name|Action
name|a
parameter_list|)
block|{
name|JButton
name|b
init|=
operator|new
name|JButton
argument_list|(
name|a
argument_list|)
decl_stmt|;
name|b
operator|.
name|setText
argument_list|(
literal|null
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|OS
operator|.
name|OS_X
condition|)
block|{
name|b
operator|.
name|setMargin
argument_list|(
name|marg
argument_list|)
expr_stmt|;
block|}
name|add
argument_list|(
name|b
argument_list|)
expr_stmt|;
block|}
block|}
DECL|field|tlb
specifier|final
name|ToolBar
name|tlb
init|=
operator|new
name|ToolBar
argument_list|()
decl_stmt|;
DECL|field|mb
specifier|private
specifier|final
name|JMenuBar
name|mb
init|=
operator|new
name|JMenuBar
argument_list|()
decl_stmt|;
DECL|field|gbl
specifier|private
specifier|final
name|GridBagLayout
name|gbl
init|=
operator|new
name|GridBagLayout
argument_list|()
decl_stmt|;
DECL|field|con
specifier|private
specifier|final
name|GridBagConstraints
name|con
init|=
operator|new
name|GridBagConstraints
argument_list|()
decl_stmt|;
DECL|field|statusLine
specifier|final
name|JLabel
name|statusLine
init|=
operator|new
name|JLabel
argument_list|(
literal|""
argument_list|,
name|SwingConstants
operator|.
name|LEFT
argument_list|)
decl_stmt|;
DECL|field|statusLabel
specifier|private
specifier|final
name|JLabel
name|statusLabel
init|=
operator|new
name|JLabel
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Status"
argument_list|)
operator|+
literal|':'
argument_list|,
name|SwingConstants
operator|.
name|LEFT
argument_list|)
decl_stmt|;
DECL|field|progressBar
specifier|private
specifier|final
name|JProgressBar
name|progressBar
init|=
operator|new
name|JProgressBar
argument_list|()
decl_stmt|;
DECL|field|fileHistory
specifier|private
specifier|final
name|FileHistory
name|fileHistory
init|=
operator|new
name|FileHistory
argument_list|(
name|prefs
argument_list|,
name|this
argument_list|)
decl_stmt|;
DECL|field|sysTray
specifier|private
name|SysTray
name|sysTray
decl_stmt|;
comment|// The help window.
DECL|field|helpDiag
specifier|public
specifier|final
name|HelpDialog
name|helpDiag
init|=
operator|new
name|HelpDialog
argument_list|(
name|this
argument_list|)
decl_stmt|;
comment|// Here we instantiate menu/toolbar actions. Actions regarding
comment|// the currently open database are defined as a GeneralAction
comment|// with a unique command string. This causes the appropriate
comment|// BasePanel's runCommand() method to be called with that command.
comment|// Note: GeneralAction's constructor automatically gets translations
comment|// for the name and message strings.
comment|/* References to the toggle buttons in the toolbar */
comment|// the groups interface
DECL|field|groupToggle
specifier|public
name|JToggleButton
name|groupToggle
decl_stmt|;
DECL|field|searchToggle
specifier|public
name|JToggleButton
name|searchToggle
decl_stmt|;
DECL|field|previewToggle
specifier|public
name|JToggleButton
name|previewToggle
decl_stmt|;
DECL|field|highlightAny
specifier|public
name|JToggleButton
name|highlightAny
decl_stmt|;
DECL|field|highlightAll
specifier|public
name|JToggleButton
name|highlightAll
decl_stmt|;
DECL|field|open
specifier|final
name|OpenDatabaseAction
name|open
init|=
operator|new
name|OpenDatabaseAction
argument_list|(
name|this
argument_list|,
literal|true
argument_list|)
decl_stmt|;
specifier|private
specifier|final
name|AbstractAction
DECL|field|close
name|close
init|=
operator|new
name|CloseDatabaseAction
argument_list|()
decl_stmt|;
DECL|field|quit
specifier|private
specifier|final
name|AbstractAction
name|quit
init|=
operator|new
name|CloseAction
argument_list|()
decl_stmt|;
DECL|field|selectKeys
specifier|private
specifier|final
name|AbstractAction
name|selectKeys
init|=
operator|new
name|SelectKeysAction
argument_list|()
decl_stmt|;
DECL|field|newDatabaseAction
specifier|private
specifier|final
name|AbstractAction
name|newDatabaseAction
init|=
operator|new
name|NewDatabaseAction
argument_list|()
decl_stmt|;
DECL|field|newSubDatabaseAction
specifier|private
specifier|final
name|AbstractAction
name|newSubDatabaseAction
init|=
operator|new
name|NewSubDatabaseAction
argument_list|()
decl_stmt|;
DECL|field|integrityCheckAction
specifier|private
specifier|final
name|AbstractAction
name|integrityCheckAction
init|=
operator|new
name|IntegrityCheckAction
argument_list|()
decl_stmt|;
DECL|field|forkMeOnGitHubAction
specifier|private
specifier|final
name|AbstractAction
name|forkMeOnGitHubAction
init|=
operator|new
name|ForkMeOnGitHubAction
argument_list|()
decl_stmt|;
DECL|field|help
specifier|private
specifier|final
name|AbstractAction
name|help
init|=
operator|new
name|HelpAction
argument_list|(
literal|"JabRef help"
argument_list|,
name|helpDiag
argument_list|,
name|GUIGlobals
operator|.
name|baseFrameHelp
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"JabRef help"
argument_list|)
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Help"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|contents
specifier|private
specifier|final
name|AbstractAction
name|contents
init|=
operator|new
name|HelpAction
argument_list|(
literal|"Help contents"
argument_list|,
name|helpDiag
argument_list|,
name|GUIGlobals
operator|.
name|helpContents
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Help contents"
argument_list|)
argument_list|,
name|GUIGlobals
operator|.
name|getIconUrl
argument_list|(
literal|"helpContents"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|about
specifier|private
specifier|final
name|AbstractAction
name|about
init|=
operator|new
name|HelpAction
argument_list|(
literal|"About JabRef"
argument_list|,
name|helpDiag
argument_list|,
name|GUIGlobals
operator|.
name|aboutPage
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"About JabRef"
argument_list|)
argument_list|,
name|GUIGlobals
operator|.
name|getIconUrl
argument_list|(
literal|"about"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|editEntry
specifier|private
specifier|final
name|AbstractAction
name|editEntry
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"edit"
argument_list|,
literal|"Edit entry"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Edit entry"
argument_list|)
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Edit entry"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|focusTable
specifier|private
specifier|final
name|AbstractAction
name|focusTable
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"focusTable"
argument_list|,
literal|"Focus entry table"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Move the keyboard focus to the entry table"
argument_list|)
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Focus entry table"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|save
specifier|private
specifier|final
name|AbstractAction
name|save
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"save"
argument_list|,
literal|"Save database"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Save database"
argument_list|)
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Save database"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|saveAs
specifier|private
specifier|final
name|AbstractAction
name|saveAs
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"saveAs"
argument_list|,
literal|"Save database as ..."
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Save database as ..."
argument_list|)
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Save database as ..."
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|saveAll
specifier|private
specifier|final
name|AbstractAction
name|saveAll
init|=
operator|new
name|SaveAllAction
argument_list|(
name|JabRefFrame
operator|.
name|this
argument_list|)
decl_stmt|;
DECL|field|saveSelectedAs
specifier|private
specifier|final
name|AbstractAction
name|saveSelectedAs
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"saveSelectedAs"
argument_list|,
literal|"Save selected as ..."
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Save selected as ..."
argument_list|)
argument_list|,
name|GUIGlobals
operator|.
name|getIconUrl
argument_list|(
literal|"saveAs"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|saveSelectedAsPlain
specifier|private
specifier|final
name|AbstractAction
name|saveSelectedAsPlain
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"saveSelectedAsPlain"
argument_list|,
literal|"Save selected as plain BibTeX ..."
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Save selected as plain BibTeX ..."
argument_list|)
argument_list|,
name|GUIGlobals
operator|.
name|getIconUrl
argument_list|(
literal|"saveAs"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|exportAll
specifier|private
specifier|final
name|AbstractAction
name|exportAll
init|=
name|ExportFormats
operator|.
name|getExportAction
argument_list|(
name|this
argument_list|,
literal|false
argument_list|)
decl_stmt|;
DECL|field|exportSelected
specifier|private
specifier|final
name|AbstractAction
name|exportSelected
init|=
name|ExportFormats
operator|.
name|getExportAction
argument_list|(
name|this
argument_list|,
literal|true
argument_list|)
decl_stmt|;
DECL|field|importCurrent
specifier|private
specifier|final
name|AbstractAction
name|importCurrent
init|=
name|ImportFormats
operator|.
name|getImportAction
argument_list|(
name|this
argument_list|,
literal|false
argument_list|)
decl_stmt|;
DECL|field|importNew
specifier|private
specifier|final
name|AbstractAction
name|importNew
init|=
name|ImportFormats
operator|.
name|getImportAction
argument_list|(
name|this
argument_list|,
literal|true
argument_list|)
decl_stmt|;
DECL|field|nextTab
specifier|public
specifier|final
name|AbstractAction
name|nextTab
init|=
operator|new
name|ChangeTabAction
argument_list|(
literal|true
argument_list|)
decl_stmt|;
DECL|field|prevTab
specifier|public
specifier|final
name|AbstractAction
name|prevTab
init|=
operator|new
name|ChangeTabAction
argument_list|(
literal|false
argument_list|)
decl_stmt|;
DECL|field|sortTabs
specifier|private
specifier|final
name|AbstractAction
name|sortTabs
init|=
operator|new
name|SortTabsAction
argument_list|(
name|this
argument_list|)
decl_stmt|;
DECL|field|undo
specifier|private
specifier|final
name|AbstractAction
name|undo
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"undo"
argument_list|,
literal|"Undo"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Undo"
argument_list|)
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Undo"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|redo
specifier|private
specifier|final
name|AbstractAction
name|redo
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"redo"
argument_list|,
literal|"Redo"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Redo"
argument_list|)
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Redo"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|forward
specifier|final
name|AbstractAction
name|forward
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"forward"
argument_list|,
literal|"Forward"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Forward"
argument_list|)
argument_list|,
literal|"right"
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Forward"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|back
specifier|final
name|AbstractAction
name|back
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"back"
argument_list|,
literal|"Back"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Back"
argument_list|)
argument_list|,
literal|"left"
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Back"
argument_list|)
argument_list|)
decl_stmt|;
specifier|private
specifier|final
name|AbstractAction
comment|//cut = new GeneralAction("cut", "Cut", Globals.lang("Cut"),
comment|//   GUIGlobals.cutIconFile,
comment|//   prefs.getKey("Cut")),
DECL|field|delete
name|delete
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"delete"
argument_list|,
literal|"Delete"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Delete"
argument_list|)
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Delete"
argument_list|)
argument_list|)
decl_stmt|;
specifier|private
specifier|final
name|AbstractAction
comment|//copy = new GeneralAction("copy", "Copy", Globals.lang("Copy"),
comment|//                         GUIGlobals.copyIconFile,
comment|//                         prefs.getKey("Copy")),
DECL|field|copy
name|copy
init|=
operator|new
name|EditAction
argument_list|(
literal|"copy"
argument_list|,
name|GUIGlobals
operator|.
name|getIconUrl
argument_list|(
literal|"copy"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|paste
specifier|private
specifier|final
name|AbstractAction
name|paste
init|=
operator|new
name|EditAction
argument_list|(
literal|"paste"
argument_list|,
name|GUIGlobals
operator|.
name|getIconUrl
argument_list|(
literal|"paste"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|cut
specifier|private
specifier|final
name|AbstractAction
name|cut
init|=
operator|new
name|EditAction
argument_list|(
literal|"cut"
argument_list|,
name|GUIGlobals
operator|.
name|getIconUrl
argument_list|(
literal|"cut"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|mark
specifier|private
specifier|final
name|AbstractAction
name|mark
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"markEntries"
argument_list|,
literal|"Mark entries"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Mark entries"
argument_list|)
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Mark entries"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|unmark
specifier|private
specifier|final
name|AbstractAction
name|unmark
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"unmarkEntries"
argument_list|,
literal|"Unmark entries"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Unmark entries"
argument_list|)
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Unmark entries"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|unmarkAll
specifier|private
specifier|final
name|AbstractAction
name|unmarkAll
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"unmarkAll"
argument_list|,
literal|"Unmark all"
argument_list|)
decl_stmt|;
DECL|field|toggleRelevance
specifier|private
specifier|final
name|AbstractAction
name|toggleRelevance
init|=
operator|new
name|GeneralAction
argument_list|(
name|Relevance
operator|.
name|getInstance
argument_list|()
operator|.
name|getValues
argument_list|()
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|.
name|getActionName
argument_list|()
argument_list|,
name|Relevance
operator|.
name|getInstance
argument_list|()
operator|.
name|getValues
argument_list|()
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|.
name|getMenuString
argument_list|()
argument_list|,
name|Relevance
operator|.
name|getInstance
argument_list|()
operator|.
name|getValues
argument_list|()
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|.
name|getToolTipText
argument_list|()
argument_list|)
decl_stmt|;
DECL|field|toggleQualityAssured
specifier|private
specifier|final
name|AbstractAction
name|toggleQualityAssured
init|=
operator|new
name|GeneralAction
argument_list|(
name|Quality
operator|.
name|getInstance
argument_list|()
operator|.
name|getValues
argument_list|()
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|.
name|getActionName
argument_list|()
argument_list|,
name|Quality
operator|.
name|getInstance
argument_list|()
operator|.
name|getValues
argument_list|()
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|.
name|getMenuString
argument_list|()
argument_list|,
name|Quality
operator|.
name|getInstance
argument_list|()
operator|.
name|getValues
argument_list|()
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|.
name|getToolTipText
argument_list|()
argument_list|)
decl_stmt|;
DECL|field|togglePrinted
specifier|private
specifier|final
name|AbstractAction
name|togglePrinted
init|=
operator|new
name|GeneralAction
argument_list|(
name|Printed
operator|.
name|getInstance
argument_list|()
operator|.
name|getValues
argument_list|()
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|.
name|getActionName
argument_list|()
argument_list|,
name|Printed
operator|.
name|getInstance
argument_list|()
operator|.
name|getValues
argument_list|()
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|.
name|getMenuString
argument_list|()
argument_list|,
name|Printed
operator|.
name|getInstance
argument_list|()
operator|.
name|getValues
argument_list|()
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|.
name|getToolTipText
argument_list|()
argument_list|)
decl_stmt|;
specifier|private
specifier|final
name|AbstractAction
comment|//    	priority = new GeneralAction("setPriority", "Set priority",
comment|//    			                                            Globals.lang("Set priority")),
DECL|field|manageSelectors
name|manageSelectors
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"manageSelectors"
argument_list|,
literal|"Manage content selectors"
argument_list|)
decl_stmt|;
DECL|field|saveSessionAction
specifier|private
specifier|final
name|AbstractAction
name|saveSessionAction
init|=
operator|new
name|SaveSessionAction
argument_list|()
decl_stmt|;
DECL|field|loadSessionAction
specifier|public
specifier|final
name|AbstractAction
name|loadSessionAction
init|=
operator|new
name|LoadSessionAction
argument_list|()
decl_stmt|;
DECL|field|incrementalSearch
specifier|private
specifier|final
name|AbstractAction
name|incrementalSearch
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"incSearch"
argument_list|,
literal|"Incremental search"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Start incremental search"
argument_list|)
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Incremental search"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|normalSearch
specifier|private
specifier|final
name|AbstractAction
name|normalSearch
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"search"
argument_list|,
literal|"Search"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Search"
argument_list|)
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Search"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|toggleSearch
specifier|private
specifier|final
name|AbstractAction
name|toggleSearch
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"toggleSearch"
argument_list|,
literal|"Search"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Toggle search panel"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|copyKey
specifier|private
specifier|final
name|AbstractAction
name|copyKey
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"copyKey"
argument_list|,
literal|"Copy BibTeX key"
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Copy BibTeX key"
argument_list|)
argument_list|)
decl_stmt|;
specifier|private
specifier|final
name|AbstractAction
comment|//"Put a BibTeX reference to the selected entries on the clipboard",
DECL|field|copyCiteKey
name|copyCiteKey
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"copyCiteKey"
argument_list|,
literal|"Copy \\cite{BibTeX key}"
argument_list|,
comment|//"Put a BibTeX reference to the selected entries on the clipboard",
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Copy \\cite{BibTeX key}"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|copyKeyAndTitle
specifier|private
specifier|final
name|AbstractAction
name|copyKeyAndTitle
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"copyKeyAndTitle"
argument_list|,
literal|"Copy BibTeX key and title"
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Copy BibTeX key and title"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|mergeDatabaseAction
specifier|private
specifier|final
name|AbstractAction
name|mergeDatabaseAction
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"mergeDatabase"
argument_list|,
literal|"Append database"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Append contents from a BibTeX database into the currently viewed database"
argument_list|)
argument_list|,
name|GUIGlobals
operator|.
name|getIconUrl
argument_list|(
literal|"open"
argument_list|)
argument_list|)
decl_stmt|;
specifier|private
specifier|final
name|AbstractAction
comment|//prefs.getKey("Open")),
comment|/*remove = new GeneralAction("remove", "Remove", "Remove selected entries",               GUIGlobals.removeIconFile),*/
DECL|field|selectAll
name|selectAll
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"selectAll"
argument_list|,
literal|"Select all"
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Select all"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|replaceAll
specifier|private
specifier|final
name|AbstractAction
name|replaceAll
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"replaceAll"
argument_list|,
literal|"Replace string"
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Replace string"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|editPreamble
specifier|private
specifier|final
name|AbstractAction
name|editPreamble
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"editPreamble"
argument_list|,
literal|"Edit preamble"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Edit preamble"
argument_list|)
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Edit preamble"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|editStrings
specifier|private
specifier|final
name|AbstractAction
name|editStrings
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"editStrings"
argument_list|,
literal|"Edit strings"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Edit strings"
argument_list|)
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Edit strings"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|toggleToolbar
specifier|private
specifier|final
name|AbstractAction
name|toggleToolbar
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"toggleToolbar"
argument_list|,
literal|"Hide/show toolbar"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Hide/show toolbar"
argument_list|)
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Hide/show toolbar"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|toggleGroups
specifier|private
specifier|final
name|AbstractAction
name|toggleGroups
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"toggleGroups"
argument_list|,
literal|"Toggle groups interface"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Toggle groups interface"
argument_list|)
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Toggle groups interface"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|togglePreview
specifier|private
specifier|final
name|AbstractAction
name|togglePreview
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"togglePreview"
argument_list|,
literal|"Toggle entry preview"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Toggle entry preview"
argument_list|)
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Toggle entry preview"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|toggleHighlightAny
specifier|private
specifier|final
name|AbstractAction
name|toggleHighlightAny
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"toggleHighlightGroupsMatchingAny"
argument_list|,
literal|"Highlight groups matching any selected entry"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Highlight groups matching any selected entry"
argument_list|)
argument_list|,
name|GUIGlobals
operator|.
name|getIconUrl
argument_list|(
literal|"groupsHighlightAny"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|toggleHighlightAll
specifier|private
specifier|final
name|AbstractAction
name|toggleHighlightAll
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"toggleHighlightGroupsMatchingAll"
argument_list|,
literal|"Highlight groups matching all selected entries"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Highlight groups matching all selected entries"
argument_list|)
argument_list|,
name|GUIGlobals
operator|.
name|getIconUrl
argument_list|(
literal|"groupsHighlightAll"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|switchPreview
specifier|final
name|AbstractAction
name|switchPreview
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"switchPreview"
argument_list|,
literal|"Switch preview layout"
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Switch preview layout"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|makeKeyAction
specifier|private
specifier|final
name|AbstractAction
name|makeKeyAction
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"makeKey"
argument_list|,
literal|"Autogenerate BibTeX keys"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Autogenerate BibTeX keys"
argument_list|)
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Autogenerate BibTeX keys"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|writeXmpAction
specifier|private
specifier|final
name|AbstractAction
name|writeXmpAction
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"writeXMP"
argument_list|,
literal|"Write XMP-metadata to PDFs"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Will write XMP-metadata to the PDFs linked from selected entries."
argument_list|)
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Write XMP"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|openFolder
specifier|private
specifier|final
name|AbstractAction
name|openFolder
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"openFolder"
argument_list|,
literal|"Open folder"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Open folder"
argument_list|)
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Open folder"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|openFile
specifier|private
specifier|final
name|AbstractAction
name|openFile
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"openExternalFile"
argument_list|,
literal|"Open file"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Open file"
argument_list|)
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Open file"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|openPdf
specifier|private
specifier|final
name|AbstractAction
name|openPdf
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"openFile"
argument_list|,
literal|"Open PDF or PS"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Open PDF or PS"
argument_list|)
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Open PDF or PS"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|openUrl
specifier|private
specifier|final
name|AbstractAction
name|openUrl
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"openUrl"
argument_list|,
literal|"Open URL or DOI"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Open URL or DOI"
argument_list|)
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Open URL or DOI"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|openSpires
specifier|private
specifier|final
name|AbstractAction
name|openSpires
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"openSpires"
argument_list|,
literal|"Open SPIRES entry"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Open SPIRES entry"
argument_list|)
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Open SPIRES entry"
argument_list|)
argument_list|)
decl_stmt|;
specifier|private
specifier|final
name|AbstractAction
comment|/*              * It looks like this wasn't being implemented for spires anyway so we              * comment it out for now.              *             openInspire = new GeneralAction("openInspire", "Open INSPIRE entry",                                                 Globals.lang("Open INSPIRE entry"),                                                 prefs.getKey("Open INSPIRE entry")),             */
DECL|field|dupliCheck
name|dupliCheck
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"dupliCheck"
argument_list|,
literal|"Find duplicates"
argument_list|)
decl_stmt|;
specifier|private
specifier|final
name|AbstractAction
comment|//strictDupliCheck = new GeneralAction("strictDupliCheck", "Find and remove exact duplicates"),
DECL|field|plainTextImport
name|plainTextImport
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"plainTextImport"
argument_list|,
literal|"New entry from plain text"
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"New from plain text"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|customExpAction
specifier|private
specifier|final
name|AbstractAction
name|customExpAction
init|=
operator|new
name|CustomizeExportsAction
argument_list|()
decl_stmt|;
DECL|field|customImpAction
specifier|private
specifier|final
name|AbstractAction
name|customImpAction
init|=
operator|new
name|CustomizeImportsAction
argument_list|()
decl_stmt|;
DECL|field|customFileTypesAction
specifier|private
specifier|final
name|AbstractAction
name|customFileTypesAction
init|=
name|ExternalFileTypeEditor
operator|.
name|getAction
argument_list|(
name|this
argument_list|)
decl_stmt|;
DECL|field|exportToClipboard
name|AbstractAction
name|exportToClipboard
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"exportToClipboard"
argument_list|,
literal|"Export selected entries to clipboard"
argument_list|)
decl_stmt|;
specifier|private
specifier|final
name|AbstractAction
comment|//expandEndnoteZip = new ExpandEndnoteFilters(this),
DECL|field|autoSetPdf
name|autoSetPdf
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"autoSetPdf"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Synchronize %0 links"
argument_list|,
literal|"PDF"
argument_list|)
argument_list|,
name|Globals
operator|.
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Synchronize PDF"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|autoSetPs
specifier|private
specifier|final
name|AbstractAction
name|autoSetPs
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"autoSetPs"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Synchronize %0 links"
argument_list|,
literal|"PS"
argument_list|)
argument_list|,
name|Globals
operator|.
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Synchronize PS"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|autoSetFile
specifier|private
specifier|final
name|AbstractAction
name|autoSetFile
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"autoSetFile"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Synchronize file links"
argument_list|)
argument_list|,
name|Globals
operator|.
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Synchronize files"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|abbreviateMedline
specifier|private
specifier|final
name|AbstractAction
name|abbreviateMedline
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"abbreviateMedline"
argument_list|,
literal|"Abbreviate journal names (MEDLINE)"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Abbreviate journal names of the selected entries (MEDLINE abbreviation)"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|abbreviateIso
specifier|private
specifier|final
name|AbstractAction
name|abbreviateIso
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"abbreviateIso"
argument_list|,
literal|"Abbreviate journal names (ISO)"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Abbreviate journal names of the selected entries (ISO abbreviation)"
argument_list|)
argument_list|,
name|Globals
operator|.
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Abbreviate"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|unabbreviate
specifier|private
specifier|final
name|AbstractAction
name|unabbreviate
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"unabbreviate"
argument_list|,
literal|"Unabbreviate journal names"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Unabbreviate journal names of the selected entries"
argument_list|)
argument_list|,
name|Globals
operator|.
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Unabbreviate"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|manageJournals
specifier|private
specifier|final
name|AbstractAction
name|manageJournals
init|=
operator|new
name|ManageJournalsAction
argument_list|(
name|this
argument_list|)
decl_stmt|;
DECL|field|databaseProperties
specifier|private
specifier|final
name|AbstractAction
name|databaseProperties
init|=
operator|new
name|DatabasePropertiesAction
argument_list|()
decl_stmt|;
DECL|field|bibtexKeyPattern
specifier|private
specifier|final
name|AbstractAction
name|bibtexKeyPattern
init|=
operator|new
name|BibtexKeyPatternAction
argument_list|()
decl_stmt|;
DECL|field|errorConsole
specifier|private
specifier|final
name|AbstractAction
name|errorConsole
init|=
operator|new
name|ErrorConsoleAction
argument_list|(
name|this
argument_list|,
name|Globals
operator|.
name|streamEavesdropper
argument_list|,
name|Globals
operator|.
name|handler
argument_list|)
decl_stmt|;
DECL|field|test
name|AbstractAction
name|test
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"test"
argument_list|,
literal|"Test"
argument_list|)
decl_stmt|;
DECL|field|dbConnect
specifier|private
specifier|final
name|AbstractAction
name|dbConnect
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"dbConnect"
argument_list|,
literal|"Connect to external SQL database"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Connect to external SQL database"
argument_list|)
argument_list|,
name|GUIGlobals
operator|.
name|getIconUrl
argument_list|(
literal|"dbConnect"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|dbExport
specifier|private
specifier|final
name|AbstractAction
name|dbExport
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"dbExport"
argument_list|,
literal|"Export to external SQL database"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Export to external SQL database"
argument_list|)
argument_list|,
name|GUIGlobals
operator|.
name|getIconUrl
argument_list|(
literal|"dbExport"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|Cleanup
specifier|private
specifier|final
name|AbstractAction
name|Cleanup
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"Cleanup"
argument_list|,
literal|"Cleanup entries"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Cleanup entries"
argument_list|)
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Cleanup"
argument_list|)
argument_list|,
literal|"cleanupentries"
argument_list|)
decl_stmt|;
DECL|field|mergeEntries
specifier|private
specifier|final
name|AbstractAction
name|mergeEntries
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"mergeEntries"
argument_list|,
literal|"Merge entries"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Merge entries"
argument_list|)
argument_list|,
name|GUIGlobals
operator|.
name|getIconUrl
argument_list|(
literal|"mergeentries"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|dbImport
specifier|private
specifier|final
name|AbstractAction
name|dbImport
init|=
operator|new
name|DbImportAction
argument_list|(
name|this
argument_list|)
operator|.
name|getAction
argument_list|()
decl_stmt|;
specifier|private
specifier|final
name|AbstractAction
comment|//downloadFullText = new GeneralAction("downloadFullText", "Look up full text document",
comment|//        Globals.lang("Follow DOI or URL link and try to locate PDF full text document")),
DECL|field|increaseFontSize
name|increaseFontSize
init|=
operator|new
name|IncreaseTableFontSizeAction
argument_list|()
decl_stmt|;
DECL|field|decreseFontSize
specifier|private
specifier|final
name|AbstractAction
name|decreseFontSize
init|=
operator|new
name|DecreaseTableFontSizeAction
argument_list|()
decl_stmt|;
DECL|field|resolveDuplicateKeys
specifier|private
specifier|final
name|AbstractAction
name|resolveDuplicateKeys
init|=
operator|new
name|GeneralAction
argument_list|(
literal|"resolveDuplicateKeys"
argument_list|,
literal|"Resolve duplicate BibTeX keys"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Find and remove duplicate BibTeX keys"
argument_list|)
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Resolve duplicate BibTeX keys"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|massSetField
specifier|final
name|MassSetFieldAction
name|massSetField
init|=
operator|new
name|MassSetFieldAction
argument_list|(
name|this
argument_list|)
decl_stmt|;
DECL|field|manageKeywords
specifier|final
name|ManageKeywordsAction
name|manageKeywords
init|=
operator|new
name|ManageKeywordsAction
argument_list|(
name|this
argument_list|)
decl_stmt|;
DECL|field|findUnlinkedFiles
specifier|private
specifier|final
name|GeneralAction
name|findUnlinkedFiles
init|=
operator|new
name|GeneralAction
argument_list|(
name|FindUnlinkedFilesDialog
operator|.
name|ACTION_COMMAND
argument_list|,
name|FindUnlinkedFilesDialog
operator|.
name|ACTION_TITLE
argument_list|,
name|FindUnlinkedFilesDialog
operator|.
name|ACTION_SHORT_DESCRIPTION
argument_list|,
name|FindUnlinkedFilesDialog
operator|.
name|ACTION_ICON
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
name|FindUnlinkedFilesDialog
operator|.
name|ACTION_KEYBINDING_ACTION
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|autoLinkFile
specifier|private
specifier|final
name|AutoLinkFilesAction
name|autoLinkFile
init|=
operator|new
name|AutoLinkFilesAction
argument_list|()
decl_stmt|;
DECL|field|pushExternalButton
specifier|private
name|PushToApplicationButton
name|pushExternalButton
decl_stmt|;
DECL|field|fetcherActions
specifier|private
specifier|final
name|List
argument_list|<
name|Action
argument_list|>
name|fetcherActions
init|=
operator|new
name|LinkedList
argument_list|<
name|Action
argument_list|>
argument_list|()
decl_stmt|;
DECL|field|searchManager
specifier|private
name|SearchManager2
name|searchManager
decl_stmt|;
DECL|field|groupSelector
specifier|public
name|GroupSelector
name|groupSelector
decl_stmt|;
comment|// The menus for importing/appending other formats
DECL|field|importMenu
specifier|private
specifier|final
name|JMenu
name|importMenu
init|=
name|JabRefFrame
operator|.
name|subMenu
argument_list|(
literal|"Import into current database"
argument_list|)
decl_stmt|;
DECL|field|importNewMenu
specifier|private
specifier|final
name|JMenu
name|importNewMenu
init|=
name|JabRefFrame
operator|.
name|subMenu
argument_list|(
literal|"Import into new database"
argument_list|)
decl_stmt|;
DECL|field|exportMenu
specifier|private
specifier|final
name|JMenu
name|exportMenu
init|=
name|JabRefFrame
operator|.
name|subMenu
argument_list|(
literal|"Export"
argument_list|)
decl_stmt|;
DECL|field|customExportMenu
name|JMenu
name|customExportMenu
init|=
name|JabRefFrame
operator|.
name|subMenu
argument_list|(
literal|"Custom export"
argument_list|)
decl_stmt|;
DECL|field|newDatabaseMenu
specifier|private
specifier|final
name|JMenu
name|newDatabaseMenu
init|=
name|JabRefFrame
operator|.
name|subMenu
argument_list|(
literal|"New database"
argument_list|)
decl_stmt|;
comment|// Other submenus
DECL|field|checkAndFix
specifier|private
specifier|final
name|JMenu
name|checkAndFix
init|=
name|JabRefFrame
operator|.
name|subMenu
argument_list|(
literal|"Legacy tools..."
argument_list|)
decl_stmt|;
comment|// The action for adding a new entry of unspecified type.
DECL|field|newEntryAction
specifier|private
specifier|final
name|NewEntryAction
name|newEntryAction
init|=
operator|new
name|NewEntryAction
argument_list|(
name|prefs
operator|.
name|getKey
argument_list|(
literal|"New entry"
argument_list|)
argument_list|)
decl_stmt|;
DECL|field|newSpecificEntryAction
specifier|private
specifier|final
name|NewEntryAction
index|[]
name|newSpecificEntryAction
init|=
operator|new
name|NewEntryAction
index|[]
block|{
operator|new
name|NewEntryAction
argument_list|(
literal|"article"
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"New article"
argument_list|)
argument_list|)
block|,
operator|new
name|NewEntryAction
argument_list|(
literal|"book"
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"New book"
argument_list|)
argument_list|)
block|,
operator|new
name|NewEntryAction
argument_list|(
literal|"phdthesis"
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"New phdthesis"
argument_list|)
argument_list|)
block|,
operator|new
name|NewEntryAction
argument_list|(
literal|"inbook"
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"New inbook"
argument_list|)
argument_list|)
block|,
operator|new
name|NewEntryAction
argument_list|(
literal|"mastersthesis"
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"New mastersthesis"
argument_list|)
argument_list|)
block|,
operator|new
name|NewEntryAction
argument_list|(
literal|"proceedings"
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"New proceedings"
argument_list|)
argument_list|)
block|,
operator|new
name|NewEntryAction
argument_list|(
literal|"inproceedings"
argument_list|)
block|,
operator|new
name|NewEntryAction
argument_list|(
literal|"conference"
argument_list|)
block|,
operator|new
name|NewEntryAction
argument_list|(
literal|"incollection"
argument_list|)
block|,
operator|new
name|NewEntryAction
argument_list|(
literal|"booklet"
argument_list|)
block|,
operator|new
name|NewEntryAction
argument_list|(
literal|"manual"
argument_list|)
block|,
operator|new
name|NewEntryAction
argument_list|(
literal|"techreport"
argument_list|)
block|,
operator|new
name|NewEntryAction
argument_list|(
literal|"unpublished"
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"New unpublished"
argument_list|)
argument_list|)
block|,
operator|new
name|NewEntryAction
argument_list|(
literal|"misc"
argument_list|)
block|,
operator|new
name|NewEntryAction
argument_list|(
literal|"other"
argument_list|)
block|}
decl_stmt|;
DECL|method|JabRefFrame (JabRef jabRef)
specifier|public
name|JabRefFrame
parameter_list|(
name|JabRef
name|jabRef
parameter_list|)
block|{
name|this
operator|.
name|jabRef
operator|=
name|jabRef
expr_stmt|;
name|init
argument_list|()
expr_stmt|;
name|updateEnabledState
argument_list|()
expr_stmt|;
block|}
DECL|method|init ()
specifier|private
name|void
name|init
parameter_list|()
block|{
name|tabbedPane
operator|=
operator|new
name|DragDropPopupPane
argument_list|(
name|manageSelectors
argument_list|,
name|databaseProperties
argument_list|,
name|bibtexKeyPattern
argument_list|)
expr_stmt|;
name|UIManager
operator|.
name|put
argument_list|(
literal|"FileChooser.readOnly"
argument_list|,
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|FILECHOOSER_DISABLE_RENAME
argument_list|)
argument_list|)
expr_stmt|;
name|MyGlassPane
name|glassPane
init|=
operator|new
name|MyGlassPane
argument_list|()
decl_stmt|;
name|setGlassPane
argument_list|(
name|glassPane
argument_list|)
expr_stmt|;
comment|// glassPane.setVisible(true);
name|setTitle
argument_list|(
name|GUIGlobals
operator|.
name|frameTitle
argument_list|)
expr_stmt|;
name|setIconImage
argument_list|(
name|GUIGlobals
operator|.
name|getImage
argument_list|(
literal|"jabrefIcon48"
argument_list|)
operator|.
name|getImage
argument_list|()
argument_list|)
expr_stmt|;
name|setDefaultCloseOperation
argument_list|(
name|WindowConstants
operator|.
name|DO_NOTHING_ON_CLOSE
argument_list|)
expr_stmt|;
name|addWindowListener
argument_list|(
operator|new
name|WindowAdapter
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|windowClosing
parameter_list|(
name|WindowEvent
name|e
parameter_list|)
block|{
if|if
condition|(
name|OS
operator|.
name|OS_X
condition|)
block|{
name|setState
argument_list|(
name|Frame
operator|.
name|ICONIFIED
argument_list|)
expr_stmt|;
block|}
else|else
block|{
operator|new
name|CloseAction
argument_list|()
operator|.
name|actionPerformed
argument_list|(
literal|null
argument_list|)
expr_stmt|;
block|}
block|}
block|}
argument_list|)
expr_stmt|;
name|initSidePane
argument_list|()
expr_stmt|;
name|initLayout
argument_list|()
expr_stmt|;
name|initActions
argument_list|()
expr_stmt|;
comment|// Show the toolbar if it was visible at last shutdown:
name|tlb
operator|.
name|setVisible
argument_list|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|TOOLBAR_VISIBLE
argument_list|)
argument_list|)
expr_stmt|;
name|setBounds
argument_list|(
name|GraphicsEnvironment
operator|.
name|getLocalGraphicsEnvironment
argument_list|()
operator|.
name|getMaximumWindowBounds
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|WINDOW_MAXIMISED
argument_list|)
condition|)
block|{
name|int
name|sizeX
init|=
name|prefs
operator|.
name|getInt
argument_list|(
name|JabRefPreferences
operator|.
name|SIZE_X
argument_list|)
decl_stmt|;
name|int
name|sizeY
init|=
name|prefs
operator|.
name|getInt
argument_list|(
name|JabRefPreferences
operator|.
name|SIZE_Y
argument_list|)
decl_stmt|;
name|int
name|posX
init|=
name|prefs
operator|.
name|getInt
argument_list|(
name|JabRefPreferences
operator|.
name|POS_X
argument_list|)
decl_stmt|;
name|int
name|posY
init|=
name|prefs
operator|.
name|getInt
argument_list|(
name|JabRefPreferences
operator|.
name|POS_Y
argument_list|)
decl_stmt|;
comment|/*             GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();             GraphicsDevice[] gs = ge.getScreenDevices();               // Get size of each screen             for (int i=0; i<gs.length; i++) {                 DisplayMode dm = gs[i].getDisplayMode();                 int screenWidth = dm.getWidth();                 int screenHeight = dm.getHeight();                 System.out.println(gs[i].getDefaultConfiguration().getBounds());             }*/
comment|//
comment|// Fix for [ 1738920 ] Windows Position in Multi-Monitor environment
comment|//
comment|// Do not put a window outside the screen if the preference values are wrong.
comment|//
comment|// Useful reference: http://www.exampledepot.com/egs/java.awt/screen_ScreenSize.html?l=rel
comment|// googled on forums.java.sun.com graphicsenvironment second screen java
comment|//
if|if
condition|(
name|GraphicsEnvironment
operator|.
name|getLocalGraphicsEnvironment
argument_list|()
operator|.
name|getScreenDevices
argument_list|()
operator|.
name|length
operator|==
literal|1
condition|)
block|{
name|Rectangle
name|bounds
init|=
name|GraphicsEnvironment
operator|.
name|getLocalGraphicsEnvironment
argument_list|()
operator|.
name|getScreenDevices
argument_list|()
index|[
literal|0
index|]
operator|.
name|getDefaultConfiguration
argument_list|()
operator|.
name|getBounds
argument_list|()
decl_stmt|;
name|Dimension
name|dim
init|=
name|Toolkit
operator|.
name|getDefaultToolkit
argument_list|()
operator|.
name|getScreenSize
argument_list|()
decl_stmt|;
comment|// Make sure we are not above or to the left of the screen bounds:
if|if
condition|(
name|posX
operator|<
name|bounds
operator|.
name|x
condition|)
block|{
name|posX
operator|=
name|bounds
operator|.
name|x
expr_stmt|;
block|}
if|if
condition|(
name|posY
operator|<
name|bounds
operator|.
name|y
condition|)
block|{
name|posY
operator|=
name|bounds
operator|.
name|y
expr_stmt|;
block|}
name|int
name|height
init|=
operator|(
name|int
operator|)
name|dim
operator|.
name|getHeight
argument_list|()
decl_stmt|;
name|int
name|width
init|=
operator|(
name|int
operator|)
name|dim
operator|.
name|getWidth
argument_list|()
decl_stmt|;
comment|//if (posX< )
if|if
condition|(
name|posX
operator|+
name|sizeX
operator|>
name|width
condition|)
block|{
if|if
condition|(
name|sizeX
operator|<=
name|width
condition|)
block|{
name|posX
operator|=
name|width
operator|-
name|sizeX
expr_stmt|;
block|}
else|else
block|{
name|posX
operator|=
name|prefs
operator|.
name|getIntDefault
argument_list|(
name|JabRefPreferences
operator|.
name|POS_X
argument_list|)
expr_stmt|;
name|sizeX
operator|=
name|prefs
operator|.
name|getIntDefault
argument_list|(
name|JabRefPreferences
operator|.
name|SIZE_X
argument_list|)
expr_stmt|;
block|}
block|}
if|if
condition|(
name|posY
operator|+
name|sizeY
operator|>
name|height
condition|)
block|{
if|if
condition|(
name|sizeY
operator|<=
name|height
condition|)
block|{
name|posY
operator|=
name|height
operator|-
name|sizeY
expr_stmt|;
block|}
else|else
block|{
name|posY
operator|=
name|prefs
operator|.
name|getIntDefault
argument_list|(
name|JabRefPreferences
operator|.
name|POS_Y
argument_list|)
expr_stmt|;
name|sizeY
operator|=
name|prefs
operator|.
name|getIntDefault
argument_list|(
name|JabRefPreferences
operator|.
name|SIZE_Y
argument_list|)
expr_stmt|;
block|}
block|}
block|}
name|setBounds
argument_list|(
name|posX
argument_list|,
name|posY
argument_list|,
name|sizeX
argument_list|,
name|sizeY
argument_list|)
expr_stmt|;
block|}
name|tabbedPane
operator|.
name|setBorder
argument_list|(
literal|null
argument_list|)
expr_stmt|;
name|tabbedPane
operator|.
name|setForeground
argument_list|(
name|GUIGlobals
operator|.
name|inActiveTabbed
argument_list|)
expr_stmt|;
comment|/*          * The following state listener makes sure focus is registered with the          * correct database when the user switches tabs. Without this,          * cut/paste/copy operations would some times occur in the wrong tab.          */
name|tabbedPane
operator|.
name|addChangeListener
argument_list|(
operator|new
name|ChangeListener
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|stateChanged
parameter_list|(
name|ChangeEvent
name|e
parameter_list|)
block|{
name|markActiveBasePanel
argument_list|()
expr_stmt|;
name|BasePanel
name|bp
init|=
name|basePanel
argument_list|()
decl_stmt|;
if|if
condition|(
name|bp
operator|!=
literal|null
condition|)
block|{
name|groupToggle
operator|.
name|setSelected
argument_list|(
name|sidePaneManager
operator|.
name|isComponentVisible
argument_list|(
literal|"groups"
argument_list|)
argument_list|)
expr_stmt|;
name|searchToggle
operator|.
name|setSelected
argument_list|(
name|sidePaneManager
operator|.
name|isComponentVisible
argument_list|(
literal|"search"
argument_list|)
argument_list|)
expr_stmt|;
name|previewToggle
operator|.
name|setSelected
argument_list|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|PREVIEW_ENABLED
argument_list|)
argument_list|)
expr_stmt|;
name|highlightAny
operator|.
name|setSelected
argument_list|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|HIGHLIGHT_GROUPS_MATCHING_ANY
argument_list|)
argument_list|)
expr_stmt|;
name|highlightAll
operator|.
name|setSelected
argument_list|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|HIGHLIGHT_GROUPS_MATCHING_ALL
argument_list|)
argument_list|)
expr_stmt|;
name|Globals
operator|.
name|focusListener
operator|.
name|setFocused
argument_list|(
name|bp
operator|.
name|mainTable
argument_list|)
expr_stmt|;
name|setWindowTitle
argument_list|()
expr_stmt|;
comment|// Update search autocompleter with information for the correct database:
name|bp
operator|.
name|updateSearchManager
argument_list|()
expr_stmt|;
comment|// Set correct enabled state for Back and Forward actions:
name|bp
operator|.
name|setBackAndForwardEnabledState
argument_list|()
expr_stmt|;
operator|new
name|FocusRequester
argument_list|(
name|bp
operator|.
name|mainTable
argument_list|)
expr_stmt|;
block|}
block|}
block|}
argument_list|)
expr_stmt|;
comment|//Note: The registration of Apple event is at the end of initialization, because
comment|//if the events happen too early (ie when the window is not initialized yet), the
comment|//opened (double-clicked) documents are not displayed.
if|if
condition|(
name|OS
operator|.
name|OS_X
condition|)
block|{
try|try
block|{
operator|new
name|MacAdapter
argument_list|()
operator|.
name|registerMacEvents
argument_list|(
name|this
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|Exception
name|e
parameter_list|)
block|{
name|LOGGER
operator|.
name|fatal
argument_list|(
literal|"could not interface with Mac OS X methods"
argument_list|,
name|e
argument_list|)
expr_stmt|;
block|}
block|}
block|}
DECL|method|setWindowTitle ()
specifier|public
name|void
name|setWindowTitle
parameter_list|()
block|{
comment|// Set window title:
name|BasePanel
name|bp
init|=
name|basePanel
argument_list|()
decl_stmt|;
if|if
condition|(
name|bp
operator|==
literal|null
condition|)
block|{
name|setTitle
argument_list|(
name|GUIGlobals
operator|.
name|frameTitle
argument_list|)
expr_stmt|;
return|return;
block|}
name|String
name|star
init|=
name|bp
operator|.
name|isBaseChanged
argument_list|()
condition|?
literal|"*"
else|:
literal|""
decl_stmt|;
if|if
condition|(
name|bp
operator|.
name|getFile
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|setTitle
argument_list|(
name|GUIGlobals
operator|.
name|frameTitle
operator|+
literal|" - "
operator|+
name|bp
operator|.
name|getFile
argument_list|()
operator|.
name|getPath
argument_list|()
operator|+
name|star
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|setTitle
argument_list|(
name|GUIGlobals
operator|.
name|frameTitle
operator|+
literal|" - "
operator|+
name|Localization
operator|.
name|lang
argument_list|(
literal|"untitled"
argument_list|)
operator|+
name|star
argument_list|)
expr_stmt|;
block|}
block|}
DECL|method|initSidePane ()
specifier|private
name|void
name|initSidePane
parameter_list|()
block|{
name|sidePaneManager
operator|=
operator|new
name|SidePaneManager
argument_list|(
name|this
argument_list|)
expr_stmt|;
name|Globals
operator|.
name|sidePaneManager
operator|=
name|this
operator|.
name|sidePaneManager
expr_stmt|;
name|Globals
operator|.
name|helpDiag
operator|=
name|this
operator|.
name|helpDiag
expr_stmt|;
name|groupSelector
operator|=
operator|new
name|GroupSelector
argument_list|(
name|this
argument_list|,
name|sidePaneManager
argument_list|)
expr_stmt|;
name|searchManager
operator|=
operator|new
name|SearchManager2
argument_list|(
name|this
argument_list|,
name|sidePaneManager
argument_list|)
expr_stmt|;
name|sidePaneManager
operator|.
name|register
argument_list|(
literal|"groups"
argument_list|,
name|groupSelector
argument_list|)
expr_stmt|;
name|sidePaneManager
operator|.
name|register
argument_list|(
literal|"search"
argument_list|,
name|searchManager
argument_list|)
expr_stmt|;
comment|// Show the search panel if it was visible at last shutdown:
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|SEARCH_PANEL_VISIBLE
argument_list|)
condition|)
block|{
name|sidePaneManager
operator|.
name|show
argument_list|(
literal|"search"
argument_list|)
expr_stmt|;
block|}
block|}
comment|// The MacAdapter calls this method when a ".bib" file has been double-clicked from the Finder.
DECL|method|openAction (String filePath)
specifier|public
name|void
name|openAction
parameter_list|(
name|String
name|filePath
parameter_list|)
block|{
name|File
name|file
init|=
operator|new
name|File
argument_list|(
name|filePath
argument_list|)
decl_stmt|;
comment|// Check if the file is already open.
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|this
operator|.
name|getTabbedPane
argument_list|()
operator|.
name|getTabCount
argument_list|()
condition|;
name|i
operator|++
control|)
block|{
name|BasePanel
name|bp
init|=
name|this
operator|.
name|baseAt
argument_list|(
name|i
argument_list|)
decl_stmt|;
if|if
condition|(
name|bp
operator|.
name|getFile
argument_list|()
operator|!=
literal|null
operator|&&
name|bp
operator|.
name|getFile
argument_list|()
operator|.
name|equals
argument_list|(
name|file
argument_list|)
condition|)
block|{
comment|//The file is already opened, so just raising its tab.
name|this
operator|.
name|getTabbedPane
argument_list|()
operator|.
name|setSelectedComponent
argument_list|(
name|bp
argument_list|)
expr_stmt|;
return|return;
block|}
block|}
if|if
condition|(
name|file
operator|.
name|exists
argument_list|()
condition|)
block|{
comment|// Run the actual open in a thread to prevent the program
comment|// locking until the file is loaded.
specifier|final
name|File
name|theFile
init|=
operator|new
name|File
argument_list|(
name|filePath
argument_list|)
decl_stmt|;
name|JabRefExecutorService
operator|.
name|INSTANCE
operator|.
name|execute
argument_list|(
operator|new
name|Runnable
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|run
parameter_list|()
block|{
name|open
operator|.
name|openIt
argument_list|(
name|theFile
argument_list|,
literal|true
argument_list|)
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
block|}
block|}
comment|// General info dialog.  The MacAdapter calls this method when "About"
comment|// is selected from the application menu.
DECL|method|about ()
specifier|public
name|void
name|about
parameter_list|()
block|{
name|JDialog
name|about
init|=
operator|new
name|JDialog
argument_list|(
name|JabRefFrame
operator|.
name|this
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"About JabRef"
argument_list|)
argument_list|,
literal|true
argument_list|)
decl_stmt|;
name|JEditorPane
name|jp
init|=
operator|new
name|JEditorPane
argument_list|()
decl_stmt|;
name|JScrollPane
name|sp
init|=
operator|new
name|JScrollPane
argument_list|(
name|jp
argument_list|,
name|ScrollPaneConstants
operator|.
name|VERTICAL_SCROLLBAR_AS_NEEDED
argument_list|,
name|ScrollPaneConstants
operator|.
name|HORIZONTAL_SCROLLBAR_NEVER
argument_list|)
decl_stmt|;
name|jp
operator|.
name|setEditable
argument_list|(
literal|false
argument_list|)
expr_stmt|;
try|try
block|{
name|jp
operator|.
name|setPage
argument_list|(
name|GUIGlobals
operator|.
name|class
operator|.
name|getResource
argument_list|(
literal|"/help/About.html"
argument_list|)
argument_list|)
expr_stmt|;
comment|//GUIGlobals.aboutPage);
comment|// We need a hyperlink listener to be able to switch to the license
comment|// terms and back.
name|jp
operator|.
name|addHyperlinkListener
argument_list|(
operator|new
name|javax
operator|.
name|swing
operator|.
name|event
operator|.
name|HyperlinkListener
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|hyperlinkUpdate
parameter_list|(
name|javax
operator|.
name|swing
operator|.
name|event
operator|.
name|HyperlinkEvent
name|e
parameter_list|)
block|{
if|if
condition|(
name|e
operator|.
name|getEventType
argument_list|()
operator|==
name|javax
operator|.
name|swing
operator|.
name|event
operator|.
name|HyperlinkEvent
operator|.
name|EventType
operator|.
name|ACTIVATED
condition|)
block|{
try|try
block|{
operator|(
operator|(
name|JEditorPane
operator|)
name|e
operator|.
name|getSource
argument_list|()
operator|)
operator|.
name|setPage
argument_list|(
name|e
operator|.
name|getURL
argument_list|()
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|IOException
name|ignored
parameter_list|)
block|{                         }
block|}
block|}
block|}
argument_list|)
expr_stmt|;
name|about
operator|.
name|getContentPane
argument_list|()
operator|.
name|add
argument_list|(
name|sp
argument_list|)
expr_stmt|;
name|about
operator|.
name|setSize
argument_list|(
name|GUIGlobals
operator|.
name|aboutSize
argument_list|)
expr_stmt|;
name|Util
operator|.
name|placeDialog
argument_list|(
name|about
argument_list|,
name|JabRefFrame
operator|.
name|this
argument_list|)
expr_stmt|;
name|about
operator|.
name|setVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|IOException
name|ex
parameter_list|)
block|{
name|ex
operator|.
name|printStackTrace
argument_list|()
expr_stmt|;
name|JOptionPane
operator|.
name|showMessageDialog
argument_list|(
name|JabRefFrame
operator|.
name|this
argument_list|,
literal|"Could not load file 'About.html'"
argument_list|,
literal|"Error"
argument_list|,
name|JOptionPane
operator|.
name|ERROR_MESSAGE
argument_list|)
expr_stmt|;
block|}
block|}
comment|// General preferences dialog.  The MacAdapter calls this method when "Preferences..."
comment|// is selected from the application menu.
DECL|method|preferences ()
specifier|public
name|void
name|preferences
parameter_list|()
block|{
comment|//PrefsDialog.showPrefsDialog(JabRefFrame.this, prefs);
name|AbstractWorker
name|worker
init|=
operator|new
name|AbstractWorker
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|run
parameter_list|()
block|{
name|output
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Opening preferences..."
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|prefsDialog
operator|==
literal|null
condition|)
block|{
name|prefsDialog
operator|=
operator|new
name|PreferencesDialog
argument_list|(
name|JabRefFrame
operator|.
name|this
argument_list|,
name|jabRef
argument_list|)
expr_stmt|;
name|Util
operator|.
name|placeDialog
argument_list|(
name|prefsDialog
argument_list|,
name|JabRefFrame
operator|.
name|this
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|prefsDialog
operator|.
name|setValues
argument_list|()
expr_stmt|;
block|}
block|}
annotation|@
name|Override
specifier|public
name|void
name|update
parameter_list|()
block|{
name|prefsDialog
operator|.
name|setVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|output
argument_list|(
literal|""
argument_list|)
expr_stmt|;
block|}
block|}
decl_stmt|;
name|worker
operator|.
name|getWorker
argument_list|()
operator|.
name|run
argument_list|()
expr_stmt|;
name|worker
operator|.
name|getCallBack
argument_list|()
operator|.
name|update
argument_list|()
expr_stmt|;
block|}
DECL|method|prefs ()
specifier|public
name|JabRefPreferences
name|prefs
parameter_list|()
block|{
return|return
name|prefs
return|;
block|}
comment|/**      * Tears down all things started by JabRef      *       * FIXME: Currently some threads remain and therefore hinder JabRef to be closed properly      *       * @param filenames the file names of all currently opened files - used for storing them if prefs openLastEdited is set to true      */
DECL|method|tearDownJabRef (Vector<String> filenames)
specifier|private
name|void
name|tearDownJabRef
parameter_list|(
name|Vector
argument_list|<
name|String
argument_list|>
name|filenames
parameter_list|)
block|{
name|JabRefExecutorService
operator|.
name|INSTANCE
operator|.
name|shutdownEverything
argument_list|()
expr_stmt|;
name|dispose
argument_list|()
expr_stmt|;
if|if
condition|(
name|basePanel
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|basePanel
argument_list|()
operator|.
name|saveDividerLocation
argument_list|()
expr_stmt|;
block|}
name|prefs
operator|.
name|putInt
argument_list|(
name|JabRefPreferences
operator|.
name|POS_X
argument_list|,
name|JabRefFrame
operator|.
name|this
operator|.
name|getLocation
argument_list|()
operator|.
name|x
argument_list|)
expr_stmt|;
name|prefs
operator|.
name|putInt
argument_list|(
name|JabRefPreferences
operator|.
name|POS_Y
argument_list|,
name|JabRefFrame
operator|.
name|this
operator|.
name|getLocation
argument_list|()
operator|.
name|y
argument_list|)
expr_stmt|;
name|prefs
operator|.
name|putInt
argument_list|(
name|JabRefPreferences
operator|.
name|SIZE_X
argument_list|,
name|JabRefFrame
operator|.
name|this
operator|.
name|getSize
argument_list|()
operator|.
name|width
argument_list|)
expr_stmt|;
name|prefs
operator|.
name|putInt
argument_list|(
name|JabRefPreferences
operator|.
name|SIZE_Y
argument_list|,
name|JabRefFrame
operator|.
name|this
operator|.
name|getSize
argument_list|()
operator|.
name|height
argument_list|)
expr_stmt|;
comment|//prefs.putBoolean(JabRefPreferences.WINDOW_MAXIMISED, (getExtendedState()&MAXIMIZED_BOTH)>0);
name|prefs
operator|.
name|putBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|WINDOW_MAXIMISED
argument_list|,
name|getExtendedState
argument_list|()
operator|==
name|Frame
operator|.
name|MAXIMIZED_BOTH
argument_list|)
expr_stmt|;
name|prefs
operator|.
name|putBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|TOOLBAR_VISIBLE
argument_list|,
name|tlb
operator|.
name|isVisible
argument_list|()
argument_list|)
expr_stmt|;
name|prefs
operator|.
name|putBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|SEARCH_PANEL_VISIBLE
argument_list|,
name|sidePaneManager
operator|.
name|isComponentVisible
argument_list|(
literal|"search"
argument_list|)
argument_list|)
expr_stmt|;
comment|// Store divider location for side pane:
name|int
name|width
init|=
name|contentPane
operator|.
name|getDividerLocation
argument_list|()
decl_stmt|;
if|if
condition|(
name|width
operator|>
literal|0
condition|)
block|{
name|prefs
operator|.
name|putInt
argument_list|(
name|JabRefPreferences
operator|.
name|SIDE_PANE_WIDTH
argument_list|,
name|width
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|OPEN_LAST_EDITED
argument_list|)
condition|)
block|{
comment|// Here we store the names of all current files. If
comment|// there is no current file, we remove any
comment|// previously stored file name.
if|if
condition|(
name|filenames
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|prefs
operator|.
name|remove
argument_list|(
name|JabRefPreferences
operator|.
name|LAST_EDITED
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|String
index|[]
name|names
init|=
operator|new
name|String
index|[
name|filenames
operator|.
name|size
argument_list|()
index|]
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|filenames
operator|.
name|size
argument_list|()
condition|;
name|i
operator|++
control|)
block|{
name|names
index|[
name|i
index|]
operator|=
name|filenames
operator|.
name|elementAt
argument_list|(
name|i
argument_list|)
expr_stmt|;
block|}
name|prefs
operator|.
name|putStringArray
argument_list|(
name|JabRefPreferences
operator|.
name|LAST_EDITED
argument_list|,
name|names
argument_list|)
expr_stmt|;
block|}
block|}
name|fileHistory
operator|.
name|storeHistory
argument_list|()
expr_stmt|;
name|prefs
operator|.
name|customExports
operator|.
name|store
argument_list|()
expr_stmt|;
name|prefs
operator|.
name|customImports
operator|.
name|store
argument_list|()
expr_stmt|;
name|BibtexEntryType
operator|.
name|saveCustomEntryTypes
argument_list|(
name|prefs
argument_list|)
expr_stmt|;
comment|// Clear autosave files:
if|if
condition|(
name|Globals
operator|.
name|autoSaveManager
operator|!=
literal|null
condition|)
block|{
name|Globals
operator|.
name|autoSaveManager
operator|.
name|clearAutoSaves
argument_list|()
expr_stmt|;
block|}
comment|// Let the search interface store changes to prefs.
comment|// But which one? Let's use the one that is visible.
if|if
condition|(
name|basePanel
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|searchManager
operator|.
name|updatePrefs
argument_list|()
expr_stmt|;
block|}
name|prefs
operator|.
name|flush
argument_list|()
expr_stmt|;
comment|// hide systray because the JVM can only shut down when no systray icon is shown
if|if
condition|(
name|sysTray
operator|!=
literal|null
condition|)
block|{
name|sysTray
operator|.
name|hide
argument_list|()
expr_stmt|;
block|}
comment|// dispose all windows, even if they are not displayed anymore
for|for
control|(
name|Window
name|window
range|:
name|Window
operator|.
name|getWindows
argument_list|()
control|)
block|{
name|window
operator|.
name|dispose
argument_list|()
expr_stmt|;
block|}
comment|// shutdown any timers that are may be active
if|if
condition|(
name|Globals
operator|.
name|autoSaveManager
operator|!=
literal|null
condition|)
block|{
name|Globals
operator|.
name|stopAutoSaveManager
argument_list|()
expr_stmt|;
block|}
block|}
comment|/**      * General info dialog.  The MacAdapter calls this method when "Quit"      * is selected from the application menu, Cmd-Q is pressed, or "Quit" is selected from the Dock.      * The function returns a boolean indicating if quitting is ok or not.      *       * Non-OSX JabRef calls this when choosing "Quit" from the menu      *       * SIDE EFFECT: tears down JabRef      *       * @return true if the user chose to quit; false otherwise      */
DECL|method|quit ()
specifier|public
name|boolean
name|quit
parameter_list|()
block|{
comment|// Ask here if the user really wants to close, if the base
comment|// has not been saved since last save.
name|boolean
name|close
init|=
literal|true
decl_stmt|;
name|Vector
argument_list|<
name|String
argument_list|>
name|filenames
init|=
operator|new
name|Vector
argument_list|<
name|String
argument_list|>
argument_list|()
decl_stmt|;
if|if
condition|(
name|tabbedPane
operator|.
name|getTabCount
argument_list|()
operator|>
literal|0
condition|)
block|{
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|tabbedPane
operator|.
name|getTabCount
argument_list|()
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|baseAt
argument_list|(
name|i
argument_list|)
operator|.
name|isBaseChanged
argument_list|()
condition|)
block|{
name|tabbedPane
operator|.
name|setSelectedIndex
argument_list|(
name|i
argument_list|)
expr_stmt|;
name|int
name|answer
init|=
name|JOptionPane
operator|.
name|showConfirmDialog
argument_list|(
name|JabRefFrame
operator|.
name|this
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Database has changed. Do you "
operator|+
literal|"want to save before closing?"
argument_list|)
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Save before closing"
argument_list|)
argument_list|,
name|JOptionPane
operator|.
name|YES_NO_CANCEL_OPTION
argument_list|)
decl_stmt|;
if|if
condition|(
name|answer
operator|==
name|JOptionPane
operator|.
name|CANCEL_OPTION
operator|||
name|answer
operator|==
name|JOptionPane
operator|.
name|CLOSED_OPTION
condition|)
block|{
return|return
literal|false
return|;
block|}
if|if
condition|(
name|answer
operator|==
name|JOptionPane
operator|.
name|YES_OPTION
condition|)
block|{
comment|// The user wants to save.
try|try
block|{
comment|//basePanel().runCommand("save");
name|SaveDatabaseAction
name|saveAction
init|=
operator|new
name|SaveDatabaseAction
argument_list|(
name|basePanel
argument_list|()
argument_list|)
decl_stmt|;
name|saveAction
operator|.
name|runCommand
argument_list|()
expr_stmt|;
if|if
condition|(
name|saveAction
operator|.
name|isCancelled
argument_list|()
operator|||
operator|!
name|saveAction
operator|.
name|isSuccess
argument_list|()
condition|)
block|{
comment|// The action was either cancelled or unsuccessful.
comment|// Break!
name|output
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Unable to save database"
argument_list|)
argument_list|)
expr_stmt|;
name|close
operator|=
literal|false
expr_stmt|;
block|}
block|}
catch|catch
parameter_list|(
name|Throwable
name|ex
parameter_list|)
block|{
comment|// Something prevented the file
comment|// from being saved. Break!!!
name|close
operator|=
literal|false
expr_stmt|;
break|break;
block|}
block|}
block|}
if|if
condition|(
name|baseAt
argument_list|(
name|i
argument_list|)
operator|.
name|getFile
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|filenames
operator|.
name|add
argument_list|(
name|baseAt
argument_list|(
name|i
argument_list|)
operator|.
name|getFile
argument_list|()
operator|.
name|getAbsolutePath
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
block|}
if|if
condition|(
name|close
condition|)
block|{
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|tabbedPane
operator|.
name|getTabCount
argument_list|()
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|baseAt
argument_list|(
name|i
argument_list|)
operator|.
name|isSaving
argument_list|()
condition|)
block|{
comment|// There is a database still being saved, so we need to wait.
name|WaitForSaveOperation
name|w
init|=
operator|new
name|WaitForSaveOperation
argument_list|(
name|this
argument_list|)
decl_stmt|;
name|w
operator|.
name|show
argument_list|()
expr_stmt|;
comment|// This method won't return until cancelled or the save operation is done.
if|if
condition|(
name|w
operator|.
name|cancelled
argument_list|()
condition|)
block|{
return|return
literal|false
return|;
comment|// The user clicked cancel.
block|}
block|}
block|}
name|tearDownJabRef
argument_list|(
name|filenames
argument_list|)
expr_stmt|;
return|return
literal|true
return|;
block|}
return|return
literal|false
return|;
block|}
DECL|method|initLayout ()
specifier|private
name|void
name|initLayout
parameter_list|()
block|{
name|tabbedPane
operator|.
name|putClientProperty
argument_list|(
name|Options
operator|.
name|NO_CONTENT_BORDER_KEY
argument_list|,
name|Boolean
operator|.
name|TRUE
argument_list|)
expr_stmt|;
name|setProgressBarVisible
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|pushExternalButton
operator|=
operator|new
name|PushToApplicationButton
argument_list|(
name|this
argument_list|,
name|PushToApplicationButton
operator|.
name|applications
argument_list|)
expr_stmt|;
name|fillMenu
argument_list|()
expr_stmt|;
name|createToolBar
argument_list|()
expr_stmt|;
name|getContentPane
argument_list|()
operator|.
name|setLayout
argument_list|(
name|gbl
argument_list|)
expr_stmt|;
name|contentPane
operator|.
name|setDividerSize
argument_list|(
literal|2
argument_list|)
expr_stmt|;
name|contentPane
operator|.
name|setBorder
argument_list|(
literal|null
argument_list|)
expr_stmt|;
comment|//getContentPane().setBackground(GUIGlobals.lightGray);
name|con
operator|.
name|fill
operator|=
name|GridBagConstraints
operator|.
name|HORIZONTAL
expr_stmt|;
name|con
operator|.
name|anchor
operator|=
name|GridBagConstraints
operator|.
name|WEST
expr_stmt|;
name|con
operator|.
name|weightx
operator|=
literal|1
expr_stmt|;
name|con
operator|.
name|weighty
operator|=
literal|0
expr_stmt|;
name|con
operator|.
name|gridwidth
operator|=
name|GridBagConstraints
operator|.
name|REMAINDER
expr_stmt|;
comment|//gbl.setConstraints(mb, con);
comment|//getContentPane().add(mb);
name|setJMenuBar
argument_list|(
name|mb
argument_list|)
expr_stmt|;
name|con
operator|.
name|anchor
operator|=
name|GridBagConstraints
operator|.
name|NORTH
expr_stmt|;
comment|//con.gridwidth = 1;//GridBagConstraints.REMAINDER;;
name|gbl
operator|.
name|setConstraints
argument_list|(
name|tlb
argument_list|,
name|con
argument_list|)
expr_stmt|;
name|getContentPane
argument_list|()
operator|.
name|add
argument_list|(
name|tlb
argument_list|)
expr_stmt|;
name|Component
name|lim
init|=
name|Box
operator|.
name|createGlue
argument_list|()
decl_stmt|;
name|gbl
operator|.
name|setConstraints
argument_list|(
name|lim
argument_list|,
name|con
argument_list|)
expr_stmt|;
comment|//getContentPane().add(lim);
comment|/*           JPanel empt = new JPanel();           empt.setBackground(GUIGlobals.lightGray);           gbl.setConstraints(empt, con);                getContentPane().add(empt);            con.insets = new Insets(1,0,1,1);           con.anchor = GridBagConstraints.EAST;           con.weightx = 0;           gbl.setConstraints(searchManager, con);           getContentPane().add(searchManager);*/
name|con
operator|.
name|gridwidth
operator|=
name|GridBagConstraints
operator|.
name|REMAINDER
expr_stmt|;
name|con
operator|.
name|weightx
operator|=
literal|1
expr_stmt|;
name|con
operator|.
name|weighty
operator|=
literal|0
expr_stmt|;
name|con
operator|.
name|fill
operator|=
name|GridBagConstraints
operator|.
name|BOTH
expr_stmt|;
name|con
operator|.
name|anchor
operator|=
name|GridBagConstraints
operator|.
name|WEST
expr_stmt|;
name|con
operator|.
name|insets
operator|=
operator|new
name|Insets
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|lim
operator|=
name|Box
operator|.
name|createGlue
argument_list|()
expr_stmt|;
name|gbl
operator|.
name|setConstraints
argument_list|(
name|lim
argument_list|,
name|con
argument_list|)
expr_stmt|;
name|getContentPane
argument_list|()
operator|.
name|add
argument_list|(
name|lim
argument_list|)
expr_stmt|;
comment|//tabbedPane.setVisible(false);
comment|//tabbedPane.setForeground(GUIGlobals.lightGray);
name|con
operator|.
name|weighty
operator|=
literal|1
expr_stmt|;
name|gbl
operator|.
name|setConstraints
argument_list|(
name|contentPane
argument_list|,
name|con
argument_list|)
expr_stmt|;
name|getContentPane
argument_list|()
operator|.
name|add
argument_list|(
name|contentPane
argument_list|)
expr_stmt|;
name|contentPane
operator|.
name|setRightComponent
argument_list|(
name|tabbedPane
argument_list|)
expr_stmt|;
name|contentPane
operator|.
name|setLeftComponent
argument_list|(
name|sidePaneManager
operator|.
name|getPanel
argument_list|()
argument_list|)
expr_stmt|;
name|sidePaneManager
operator|.
name|updateView
argument_list|()
expr_stmt|;
name|JPanel
name|status
init|=
operator|new
name|JPanel
argument_list|()
decl_stmt|;
name|status
operator|.
name|setLayout
argument_list|(
name|gbl
argument_list|)
expr_stmt|;
name|con
operator|.
name|weighty
operator|=
literal|0
expr_stmt|;
name|con
operator|.
name|weightx
operator|=
literal|0
expr_stmt|;
name|con
operator|.
name|gridwidth
operator|=
literal|1
expr_stmt|;
name|con
operator|.
name|insets
operator|=
operator|new
name|Insets
argument_list|(
literal|0
argument_list|,
literal|2
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gbl
operator|.
name|setConstraints
argument_list|(
name|statusLabel
argument_list|,
name|con
argument_list|)
expr_stmt|;
name|status
operator|.
name|add
argument_list|(
name|statusLabel
argument_list|)
expr_stmt|;
name|con
operator|.
name|weightx
operator|=
literal|1
expr_stmt|;
name|con
operator|.
name|insets
operator|=
operator|new
name|Insets
argument_list|(
literal|0
argument_list|,
literal|4
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|con
operator|.
name|gridwidth
operator|=
literal|1
expr_stmt|;
name|gbl
operator|.
name|setConstraints
argument_list|(
name|statusLine
argument_list|,
name|con
argument_list|)
expr_stmt|;
name|status
operator|.
name|add
argument_list|(
name|statusLine
argument_list|)
expr_stmt|;
name|con
operator|.
name|weightx
operator|=
literal|0
expr_stmt|;
name|con
operator|.
name|gridwidth
operator|=
name|GridBagConstraints
operator|.
name|REMAINDER
expr_stmt|;
name|con
operator|.
name|insets
operator|=
operator|new
name|Insets
argument_list|(
literal|2
argument_list|,
literal|4
argument_list|,
literal|2
argument_list|,
literal|2
argument_list|)
expr_stmt|;
name|gbl
operator|.
name|setConstraints
argument_list|(
name|progressBar
argument_list|,
name|con
argument_list|)
expr_stmt|;
name|status
operator|.
name|add
argument_list|(
name|progressBar
argument_list|)
expr_stmt|;
name|con
operator|.
name|weightx
operator|=
literal|1
expr_stmt|;
name|con
operator|.
name|gridwidth
operator|=
name|GridBagConstraints
operator|.
name|REMAINDER
expr_stmt|;
name|statusLabel
operator|.
name|setForeground
argument_list|(
name|GUIGlobals
operator|.
name|entryEditorLabelColor
operator|.
name|darker
argument_list|()
argument_list|)
expr_stmt|;
name|con
operator|.
name|insets
operator|=
operator|new
name|Insets
argument_list|(
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|,
literal|0
argument_list|)
expr_stmt|;
name|gbl
operator|.
name|setConstraints
argument_list|(
name|status
argument_list|,
name|con
argument_list|)
expr_stmt|;
name|getContentPane
argument_list|()
operator|.
name|add
argument_list|(
name|status
argument_list|)
expr_stmt|;
comment|// Drag and drop for tabbedPane:
name|TransferHandler
name|xfer
init|=
operator|new
name|EntryTableTransferHandler
argument_list|(
literal|null
argument_list|,
name|this
argument_list|,
literal|null
argument_list|)
decl_stmt|;
name|tabbedPane
operator|.
name|setTransferHandler
argument_list|(
name|xfer
argument_list|)
expr_stmt|;
name|tlb
operator|.
name|setTransferHandler
argument_list|(
name|xfer
argument_list|)
expr_stmt|;
name|mb
operator|.
name|setTransferHandler
argument_list|(
name|xfer
argument_list|)
expr_stmt|;
name|sidePaneManager
operator|.
name|getPanel
argument_list|()
operator|.
name|setTransferHandler
argument_list|(
name|xfer
argument_list|)
expr_stmt|;
block|}
comment|/**      * Returns the indexed BasePanel.      * @param i Index of base      */
DECL|method|baseAt (int i)
specifier|public
name|BasePanel
name|baseAt
parameter_list|(
name|int
name|i
parameter_list|)
block|{
return|return
operator|(
name|BasePanel
operator|)
name|tabbedPane
operator|.
name|getComponentAt
argument_list|(
name|i
argument_list|)
return|;
block|}
DECL|method|showBaseAt (int i)
specifier|public
name|void
name|showBaseAt
parameter_list|(
name|int
name|i
parameter_list|)
block|{
name|tabbedPane
operator|.
name|setSelectedIndex
argument_list|(
name|i
argument_list|)
expr_stmt|;
block|}
DECL|method|showBasePanel (BasePanel bp)
specifier|public
name|void
name|showBasePanel
parameter_list|(
name|BasePanel
name|bp
parameter_list|)
block|{
name|tabbedPane
operator|.
name|setSelectedComponent
argument_list|(
name|bp
argument_list|)
expr_stmt|;
block|}
comment|/**      * Returns the currently viewed BasePanel.      */
DECL|method|basePanel ()
specifier|public
name|BasePanel
name|basePanel
parameter_list|()
block|{
return|return
operator|(
name|BasePanel
operator|)
name|tabbedPane
operator|.
name|getSelectedComponent
argument_list|()
return|;
block|}
comment|/**      * @return the BasePanel count.      */
DECL|method|baseCount ()
specifier|public
name|int
name|baseCount
parameter_list|()
block|{
return|return
name|tabbedPane
operator|.
name|getComponentCount
argument_list|()
return|;
block|}
comment|/**      * handle the color of active and inactive JTabbedPane tabs      */
DECL|method|markActiveBasePanel ()
specifier|private
name|void
name|markActiveBasePanel
parameter_list|()
block|{
name|int
name|now
init|=
name|tabbedPane
operator|.
name|getSelectedIndex
argument_list|()
decl_stmt|;
name|int
name|len
init|=
name|tabbedPane
operator|.
name|getTabCount
argument_list|()
decl_stmt|;
if|if
condition|(
name|lastTabbedPanelSelectionIndex
operator|>
operator|-
literal|1
operator|&&
name|lastTabbedPanelSelectionIndex
operator|<
name|len
condition|)
block|{
name|tabbedPane
operator|.
name|setForegroundAt
argument_list|(
name|lastTabbedPanelSelectionIndex
argument_list|,
name|GUIGlobals
operator|.
name|inActiveTabbed
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|now
operator|>
operator|-
literal|1
operator|&&
name|now
operator|<
name|len
condition|)
block|{
name|tabbedPane
operator|.
name|setForegroundAt
argument_list|(
name|now
argument_list|,
name|GUIGlobals
operator|.
name|activeTabbed
argument_list|)
expr_stmt|;
block|}
name|lastTabbedPanelSelectionIndex
operator|=
name|now
expr_stmt|;
block|}
DECL|method|getTabIndex (JComponent comp)
specifier|private
name|int
name|getTabIndex
parameter_list|(
name|JComponent
name|comp
parameter_list|)
block|{
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|tabbedPane
operator|.
name|getTabCount
argument_list|()
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|tabbedPane
operator|.
name|getComponentAt
argument_list|(
name|i
argument_list|)
operator|==
name|comp
condition|)
block|{
return|return
name|i
return|;
block|}
block|}
return|return
operator|-
literal|1
return|;
block|}
DECL|method|getTabbedPane ()
specifier|public
name|JTabbedPane
name|getTabbedPane
parameter_list|()
block|{
return|return
name|tabbedPane
return|;
block|}
DECL|method|getTabTitle (JComponent comp)
specifier|public
name|String
name|getTabTitle
parameter_list|(
name|JComponent
name|comp
parameter_list|)
block|{
return|return
name|tabbedPane
operator|.
name|getTitleAt
argument_list|(
name|getTabIndex
argument_list|(
name|comp
argument_list|)
argument_list|)
return|;
block|}
DECL|method|getTabTooltip (JComponent comp)
specifier|public
name|String
name|getTabTooltip
parameter_list|(
name|JComponent
name|comp
parameter_list|)
block|{
return|return
name|tabbedPane
operator|.
name|getToolTipTextAt
argument_list|(
name|getTabIndex
argument_list|(
name|comp
argument_list|)
argument_list|)
return|;
block|}
DECL|method|setTabTitle (JComponent comp, String title, String toolTip)
specifier|public
name|void
name|setTabTitle
parameter_list|(
name|JComponent
name|comp
parameter_list|,
name|String
name|title
parameter_list|,
name|String
name|toolTip
parameter_list|)
block|{
name|int
name|index
init|=
name|getTabIndex
argument_list|(
name|comp
argument_list|)
decl_stmt|;
name|tabbedPane
operator|.
name|setTitleAt
argument_list|(
name|index
argument_list|,
name|title
argument_list|)
expr_stmt|;
name|tabbedPane
operator|.
name|setToolTipTextAt
argument_list|(
name|index
argument_list|,
name|toolTip
argument_list|)
expr_stmt|;
block|}
DECL|class|GeneralAction
class|class
name|GeneralAction
extends|extends
name|MnemonicAwareAction
block|{
DECL|field|command
specifier|private
specifier|final
name|String
name|command
decl_stmt|;
DECL|method|GeneralAction (String command, String text, String description, URL icon)
specifier|public
name|GeneralAction
parameter_list|(
name|String
name|command
parameter_list|,
name|String
name|text
parameter_list|,
name|String
name|description
parameter_list|,
name|URL
name|icon
parameter_list|)
block|{
name|super
argument_list|(
operator|new
name|ImageIcon
argument_list|(
name|icon
argument_list|)
argument_list|)
expr_stmt|;
name|this
operator|.
name|command
operator|=
name|command
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|NAME
argument_list|,
name|text
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|SHORT_DESCRIPTION
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
name|description
argument_list|)
argument_list|)
expr_stmt|;
block|}
DECL|method|GeneralAction (String command, String text, String description, String imageName, KeyStroke key)
specifier|public
name|GeneralAction
parameter_list|(
name|String
name|command
parameter_list|,
name|String
name|text
parameter_list|,
name|String
name|description
parameter_list|,
name|String
name|imageName
parameter_list|,
name|KeyStroke
name|key
parameter_list|)
block|{
name|super
argument_list|(
name|GUIGlobals
operator|.
name|getImage
argument_list|(
name|imageName
argument_list|)
argument_list|)
expr_stmt|;
name|this
operator|.
name|command
operator|=
name|command
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|NAME
argument_list|,
name|text
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|ACCELERATOR_KEY
argument_list|,
name|key
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|SHORT_DESCRIPTION
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
name|description
argument_list|)
argument_list|)
expr_stmt|;
block|}
DECL|method|GeneralAction (String command, String text)
specifier|public
name|GeneralAction
parameter_list|(
name|String
name|command
parameter_list|,
name|String
name|text
parameter_list|)
block|{
name|putValue
argument_list|(
name|Action
operator|.
name|NAME
argument_list|,
name|text
argument_list|)
expr_stmt|;
name|this
operator|.
name|command
operator|=
name|command
expr_stmt|;
block|}
DECL|method|GeneralAction (String command, String text, KeyStroke key)
specifier|public
name|GeneralAction
parameter_list|(
name|String
name|command
parameter_list|,
name|String
name|text
parameter_list|,
name|KeyStroke
name|key
parameter_list|)
block|{
name|this
operator|.
name|command
operator|=
name|command
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|NAME
argument_list|,
name|text
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|ACCELERATOR_KEY
argument_list|,
name|key
argument_list|)
expr_stmt|;
block|}
DECL|method|GeneralAction (String command, String text, String description)
specifier|public
name|GeneralAction
parameter_list|(
name|String
name|command
parameter_list|,
name|String
name|text
parameter_list|,
name|String
name|description
parameter_list|)
block|{
name|this
operator|.
name|command
operator|=
name|command
expr_stmt|;
name|ImageIcon
name|icon
init|=
name|GUIGlobals
operator|.
name|getImage
argument_list|(
name|command
argument_list|)
decl_stmt|;
if|if
condition|(
name|icon
operator|!=
literal|null
condition|)
block|{
name|putValue
argument_list|(
name|Action
operator|.
name|SMALL_ICON
argument_list|,
name|icon
argument_list|)
expr_stmt|;
block|}
name|putValue
argument_list|(
name|Action
operator|.
name|NAME
argument_list|,
name|text
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|SHORT_DESCRIPTION
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
name|description
argument_list|)
argument_list|)
expr_stmt|;
block|}
DECL|method|GeneralAction (String command, String text, String description, KeyStroke key)
specifier|public
name|GeneralAction
parameter_list|(
name|String
name|command
parameter_list|,
name|String
name|text
parameter_list|,
name|String
name|description
parameter_list|,
name|KeyStroke
name|key
parameter_list|)
block|{
name|this
operator|.
name|command
operator|=
name|command
expr_stmt|;
name|ImageIcon
name|icon
init|=
name|GUIGlobals
operator|.
name|getImage
argument_list|(
name|command
argument_list|)
decl_stmt|;
if|if
condition|(
name|icon
operator|!=
literal|null
condition|)
block|{
name|putValue
argument_list|(
name|Action
operator|.
name|SMALL_ICON
argument_list|,
name|icon
argument_list|)
expr_stmt|;
block|}
name|putValue
argument_list|(
name|Action
operator|.
name|NAME
argument_list|,
name|text
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|SHORT_DESCRIPTION
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
name|description
argument_list|)
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|ACCELERATOR_KEY
argument_list|,
name|key
argument_list|)
expr_stmt|;
block|}
DECL|method|GeneralAction (String command, String text, String description, KeyStroke key, String imageUrl)
specifier|public
name|GeneralAction
parameter_list|(
name|String
name|command
parameter_list|,
name|String
name|text
parameter_list|,
name|String
name|description
parameter_list|,
name|KeyStroke
name|key
parameter_list|,
name|String
name|imageUrl
parameter_list|)
block|{
name|this
operator|.
name|command
operator|=
name|command
expr_stmt|;
name|ImageIcon
name|icon
init|=
name|GUIGlobals
operator|.
name|getImage
argument_list|(
name|imageUrl
argument_list|)
decl_stmt|;
if|if
condition|(
name|icon
operator|!=
literal|null
condition|)
block|{
name|putValue
argument_list|(
name|Action
operator|.
name|SMALL_ICON
argument_list|,
name|icon
argument_list|)
expr_stmt|;
block|}
name|putValue
argument_list|(
name|Action
operator|.
name|NAME
argument_list|,
name|text
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|SHORT_DESCRIPTION
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
name|description
argument_list|)
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|ACCELERATOR_KEY
argument_list|,
name|key
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
DECL|method|actionPerformed (ActionEvent e)
specifier|public
name|void
name|actionPerformed
parameter_list|(
name|ActionEvent
name|e
parameter_list|)
block|{
if|if
condition|(
name|tabbedPane
operator|.
name|getTabCount
argument_list|()
operator|>
literal|0
condition|)
block|{
try|try
block|{
operator|(
operator|(
name|BasePanel
operator|)
name|tabbedPane
operator|.
name|getSelectedComponent
argument_list|()
operator|)
operator|.
name|runCommand
argument_list|(
name|command
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|Throwable
name|ex
parameter_list|)
block|{
name|ex
operator|.
name|printStackTrace
argument_list|()
expr_stmt|;
block|}
block|}
else|else
block|{
comment|// QUICK HACK to solve bug #1277
if|if
condition|(
name|e
operator|.
name|getActionCommand
argument_list|()
operator|.
name|equals
argument_list|(
literal|"Hide/show toolbar"
argument_list|)
condition|)
block|{
comment|// code copied from BasePanel.java, action "toggleToolbar"
name|tlb
operator|.
name|setVisible
argument_list|(
operator|!
name|tlb
operator|.
name|isVisible
argument_list|()
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|LOGGER
operator|.
name|info
argument_list|(
literal|"Action '"
operator|+
name|command
operator|+
literal|"' must be disabled when no database is open."
argument_list|)
expr_stmt|;
block|}
block|}
block|}
block|}
comment|/** This got removed when we introduced SearchManager2.          class IncrementalSearchAction extends AbstractAction {       public IncrementalSearchAction() {      super("Incremental search", new ImageIcon(GUIGlobals.searchIconFile));      putValue(SHORT_DESCRIPTION, Globals.lang("Start incremental search"));      putValue(ACCELERATOR_KEY, prefs.getKey("Incremental search"));       }       public void actionPerformed(ActionEvent e) {      if (tabbedPane.getTabCount()> 0)        searchManager.startIncrementalSearch();       }          }           class SearchAction extends AbstractAction {       public SearchAction() {      super("Search", new ImageIcon(GUIGlobals.searchIconFile));      putValue(SHORT_DESCRIPTION, Globals.lang("Start search"));      putValue(ACCELERATOR_KEY, prefs.getKey("Search"));       }       public void actionPerformed(ActionEvent e) {      if (tabbedPane.getTabCount()> 0)        searchManager.startSearch();       }          }      */
DECL|class|NewEntryAction
class|class
name|NewEntryAction
extends|extends
name|MnemonicAwareAction
block|{
DECL|field|type
name|String
name|type
decl_stmt|;
comment|// The type of item to create.
DECL|field|keyStroke
name|KeyStroke
name|keyStroke
decl_stmt|;
comment|// Used for the specific instances.
DECL|method|NewEntryAction (KeyStroke key)
specifier|public
name|NewEntryAction
parameter_list|(
name|KeyStroke
name|key
parameter_list|)
block|{
comment|// This action leads to a dialog asking for entry type.
name|super
argument_list|(
name|GUIGlobals
operator|.
name|getImage
argument_list|(
literal|"add"
argument_list|)
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|NAME
argument_list|,
literal|"New entry"
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|ACCELERATOR_KEY
argument_list|,
name|key
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|SHORT_DESCRIPTION
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"New BibTeX entry"
argument_list|)
argument_list|)
expr_stmt|;
block|}
DECL|method|NewEntryAction (String type_)
specifier|public
name|NewEntryAction
parameter_list|(
name|String
name|type_
parameter_list|)
block|{
comment|// This action leads to the creation of a specific entry.
name|putValue
argument_list|(
name|Action
operator|.
name|NAME
argument_list|,
name|StringUtil
operator|.
name|capitalizeFirst
argument_list|(
name|type_
argument_list|)
argument_list|)
expr_stmt|;
name|type
operator|=
name|type_
expr_stmt|;
block|}
DECL|method|NewEntryAction (String type_, KeyStroke key)
specifier|public
name|NewEntryAction
parameter_list|(
name|String
name|type_
parameter_list|,
name|KeyStroke
name|key
parameter_list|)
block|{
comment|// This action leads to the creation of a specific entry.
name|putValue
argument_list|(
name|Action
operator|.
name|NAME
argument_list|,
name|StringUtil
operator|.
name|capitalizeFirst
argument_list|(
name|type_
argument_list|)
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|ACCELERATOR_KEY
argument_list|,
name|key
argument_list|)
expr_stmt|;
name|type
operator|=
name|type_
expr_stmt|;
block|}
annotation|@
name|Override
DECL|method|actionPerformed (ActionEvent e)
specifier|public
name|void
name|actionPerformed
parameter_list|(
name|ActionEvent
name|e
parameter_list|)
block|{
name|String
name|thisType
init|=
name|type
decl_stmt|;
if|if
condition|(
name|thisType
operator|==
literal|null
condition|)
block|{
name|EntryTypeDialog
name|etd
init|=
operator|new
name|EntryTypeDialog
argument_list|(
name|JabRefFrame
operator|.
name|this
argument_list|)
decl_stmt|;
name|Util
operator|.
name|placeDialog
argument_list|(
name|etd
argument_list|,
name|JabRefFrame
operator|.
name|this
argument_list|)
expr_stmt|;
name|etd
operator|.
name|setVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|BibtexEntryType
name|tp
init|=
name|etd
operator|.
name|getChoice
argument_list|()
decl_stmt|;
if|if
condition|(
name|tp
operator|==
literal|null
condition|)
block|{
return|return;
block|}
name|thisType
operator|=
name|tp
operator|.
name|getName
argument_list|()
expr_stmt|;
block|}
if|if
condition|(
name|tabbedPane
operator|.
name|getTabCount
argument_list|()
operator|>
literal|0
condition|)
block|{
operator|(
operator|(
name|BasePanel
operator|)
name|tabbedPane
operator|.
name|getSelectedComponent
argument_list|()
operator|)
operator|.
name|newEntry
argument_list|(
name|BibtexEntryType
operator|.
name|getType
argument_list|(
name|thisType
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|LOGGER
operator|.
name|info
argument_list|(
literal|"Action 'New entry' must be disabled when no "
operator|+
literal|"database is open."
argument_list|)
expr_stmt|;
block|}
block|}
block|}
comment|/*          private void setupDatabaseLayout() {       // This method is called whenever this frame has been provided       // with a database, and completes the layout.         if (file != null)      setTitle(GUIGlobals.baseTitle+file.getName());       else       setTitle(GUIGlobals.untitledTitle);        //DragNDropManager dndm = new DragNDropManager(this);        //setNonEmptyState();       Util.pr("JabRefFrame: Must set non-empty state.");       }*/
comment|/**      * Refresh import menus.      */
DECL|method|setUpImportMenus ()
specifier|public
name|void
name|setUpImportMenus
parameter_list|()
block|{
name|setUpImportMenu
argument_list|(
name|importMenu
argument_list|,
literal|false
argument_list|)
expr_stmt|;
name|setUpImportMenu
argument_list|(
name|importNewMenu
argument_list|,
literal|true
argument_list|)
expr_stmt|;
block|}
DECL|method|fillMenu ()
specifier|private
name|void
name|fillMenu
parameter_list|()
block|{
comment|//mb.putClientProperty(Options.HEADER_STYLE_KEY, HeaderStyle.BOTH);
name|mb
operator|.
name|setBorder
argument_list|(
literal|null
argument_list|)
expr_stmt|;
name|JMenu
name|file
init|=
name|JabRefFrame
operator|.
name|subMenu
argument_list|(
literal|"File"
argument_list|)
decl_stmt|;
name|JMenu
name|sessions
init|=
name|JabRefFrame
operator|.
name|subMenu
argument_list|(
literal|"Sessions"
argument_list|)
decl_stmt|;
name|JMenu
name|edit
init|=
name|JabRefFrame
operator|.
name|subMenu
argument_list|(
literal|"Edit"
argument_list|)
decl_stmt|;
name|JMenu
name|search
init|=
name|JabRefFrame
operator|.
name|subMenu
argument_list|(
literal|"Search"
argument_list|)
decl_stmt|;
name|JMenu
name|bibtex
init|=
name|JabRefFrame
operator|.
name|subMenu
argument_list|(
literal|"BibTeX"
argument_list|)
decl_stmt|;
name|JMenu
name|view
init|=
name|JabRefFrame
operator|.
name|subMenu
argument_list|(
literal|"View"
argument_list|)
decl_stmt|;
name|JMenu
name|tools
init|=
name|JabRefFrame
operator|.
name|subMenu
argument_list|(
literal|"Tools"
argument_list|)
decl_stmt|;
name|JMenu
name|options
init|=
name|JabRefFrame
operator|.
name|subMenu
argument_list|(
literal|"Options"
argument_list|)
decl_stmt|;
name|JMenu
name|newSpec
init|=
name|JabRefFrame
operator|.
name|subMenu
argument_list|(
literal|"New entry..."
argument_list|)
decl_stmt|;
name|JMenu
name|helpMenu
init|=
name|JabRefFrame
operator|.
name|subMenu
argument_list|(
literal|"Help"
argument_list|)
decl_stmt|;
name|setUpImportMenus
argument_list|()
expr_stmt|;
name|newDatabaseMenu
operator|.
name|add
argument_list|(
name|newDatabaseAction
argument_list|)
expr_stmt|;
name|newDatabaseMenu
operator|.
name|add
argument_list|(
name|newSubDatabaseAction
argument_list|)
expr_stmt|;
name|file
operator|.
name|add
argument_list|(
name|newDatabaseAction
argument_list|)
expr_stmt|;
name|file
operator|.
name|add
argument_list|(
name|open
argument_list|)
expr_stmt|;
comment|//opendatabaseaction
name|file
operator|.
name|add
argument_list|(
name|mergeDatabaseAction
argument_list|)
expr_stmt|;
name|file
operator|.
name|add
argument_list|(
name|save
argument_list|)
expr_stmt|;
name|file
operator|.
name|add
argument_list|(
name|saveAs
argument_list|)
expr_stmt|;
name|file
operator|.
name|add
argument_list|(
name|saveAll
argument_list|)
expr_stmt|;
name|file
operator|.
name|add
argument_list|(
name|saveSelectedAs
argument_list|)
expr_stmt|;
name|file
operator|.
name|add
argument_list|(
name|saveSelectedAsPlain
argument_list|)
expr_stmt|;
name|file
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
comment|//file.add(importMenu);
comment|//file.add(importNewMenu);
name|file
operator|.
name|add
argument_list|(
name|importNew
argument_list|)
expr_stmt|;
name|file
operator|.
name|add
argument_list|(
name|importCurrent
argument_list|)
expr_stmt|;
name|file
operator|.
name|add
argument_list|(
name|exportAll
argument_list|)
expr_stmt|;
name|file
operator|.
name|add
argument_list|(
name|exportSelected
argument_list|)
expr_stmt|;
name|file
operator|.
name|add
argument_list|(
name|dbConnect
argument_list|)
expr_stmt|;
name|file
operator|.
name|add
argument_list|(
name|dbImport
argument_list|)
expr_stmt|;
name|file
operator|.
name|add
argument_list|(
name|dbExport
argument_list|)
expr_stmt|;
name|file
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
name|file
operator|.
name|add
argument_list|(
name|databaseProperties
argument_list|)
expr_stmt|;
name|file
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
name|sessions
operator|.
name|add
argument_list|(
name|loadSessionAction
argument_list|)
expr_stmt|;
name|sessions
operator|.
name|add
argument_list|(
name|saveSessionAction
argument_list|)
expr_stmt|;
name|file
operator|.
name|add
argument_list|(
name|sessions
argument_list|)
expr_stmt|;
name|file
operator|.
name|add
argument_list|(
name|fileHistory
argument_list|)
expr_stmt|;
comment|//file.addSeparator();
name|file
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
name|file
operator|.
name|add
argument_list|(
name|close
argument_list|)
expr_stmt|;
name|file
operator|.
name|add
argument_list|(
operator|new
name|MinimizeToSysTrayAction
argument_list|()
argument_list|)
expr_stmt|;
name|file
operator|.
name|add
argument_list|(
name|quit
argument_list|)
expr_stmt|;
name|mb
operator|.
name|add
argument_list|(
name|file
argument_list|)
expr_stmt|;
comment|//edit.add(test);
name|edit
operator|.
name|add
argument_list|(
name|undo
argument_list|)
expr_stmt|;
name|edit
operator|.
name|add
argument_list|(
name|redo
argument_list|)
expr_stmt|;
name|edit
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
name|edit
operator|.
name|add
argument_list|(
name|cut
argument_list|)
expr_stmt|;
name|edit
operator|.
name|add
argument_list|(
name|copy
argument_list|)
expr_stmt|;
name|edit
operator|.
name|add
argument_list|(
name|paste
argument_list|)
expr_stmt|;
comment|//edit.add(remove);
name|edit
operator|.
name|add
argument_list|(
name|delete
argument_list|)
expr_stmt|;
name|edit
operator|.
name|add
argument_list|(
name|copyKey
argument_list|)
expr_stmt|;
name|edit
operator|.
name|add
argument_list|(
name|copyCiteKey
argument_list|)
expr_stmt|;
name|edit
operator|.
name|add
argument_list|(
name|copyKeyAndTitle
argument_list|)
expr_stmt|;
comment|//edit.add(exportToClipboard);
name|edit
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
name|edit
operator|.
name|add
argument_list|(
name|mark
argument_list|)
expr_stmt|;
name|JMenu
name|markSpecific
init|=
name|JabRefFrame
operator|.
name|subMenu
argument_list|(
literal|"Mark specific color"
argument_list|)
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|EntryMarker
operator|.
name|MAX_MARKING_LEVEL
condition|;
name|i
operator|++
control|)
block|{
name|markSpecific
operator|.
name|add
argument_list|(
operator|new
name|MarkEntriesAction
argument_list|(
name|this
argument_list|,
name|i
argument_list|)
operator|.
name|getMenuItem
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|edit
operator|.
name|add
argument_list|(
name|markSpecific
argument_list|)
expr_stmt|;
name|edit
operator|.
name|add
argument_list|(
name|unmark
argument_list|)
expr_stmt|;
name|edit
operator|.
name|add
argument_list|(
name|unmarkAll
argument_list|)
expr_stmt|;
name|edit
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|SpecialFieldsUtils
operator|.
name|PREF_SPECIALFIELDSENABLED
argument_list|)
condition|)
block|{
name|JMenu
name|m
decl_stmt|;
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|SpecialFieldsUtils
operator|.
name|PREF_SHOWCOLUMN_RANKING
argument_list|)
condition|)
block|{
name|m
operator|=
operator|new
name|JMenu
argument_list|()
expr_stmt|;
name|RightClickMenu
operator|.
name|populateSpecialFieldMenu
argument_list|(
name|m
argument_list|,
name|Rank
operator|.
name|getInstance
argument_list|()
argument_list|,
name|this
argument_list|)
expr_stmt|;
name|edit
operator|.
name|add
argument_list|(
name|m
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|SpecialFieldsUtils
operator|.
name|PREF_SHOWCOLUMN_RELEVANCE
argument_list|)
condition|)
block|{
name|edit
operator|.
name|add
argument_list|(
name|toggleRelevance
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|SpecialFieldsUtils
operator|.
name|PREF_SHOWCOLUMN_QUALITY
argument_list|)
condition|)
block|{
name|edit
operator|.
name|add
argument_list|(
name|toggleQualityAssured
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|SpecialFieldsUtils
operator|.
name|PREF_SHOWCOLUMN_PRIORITY
argument_list|)
condition|)
block|{
name|m
operator|=
operator|new
name|JMenu
argument_list|()
expr_stmt|;
name|RightClickMenu
operator|.
name|populateSpecialFieldMenu
argument_list|(
name|m
argument_list|,
name|Priority
operator|.
name|getInstance
argument_list|()
argument_list|,
name|this
argument_list|)
expr_stmt|;
name|edit
operator|.
name|add
argument_list|(
name|m
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|SpecialFieldsUtils
operator|.
name|PREF_SHOWCOLUMN_PRINTED
argument_list|)
condition|)
block|{
name|edit
operator|.
name|add
argument_list|(
name|togglePrinted
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|SpecialFieldsUtils
operator|.
name|PREF_SHOWCOLUMN_READ
argument_list|)
condition|)
block|{
name|m
operator|=
operator|new
name|JMenu
argument_list|()
expr_stmt|;
name|RightClickMenu
operator|.
name|populateSpecialFieldMenu
argument_list|(
name|m
argument_list|,
name|ReadStatus
operator|.
name|getInstance
argument_list|()
argument_list|,
name|this
argument_list|)
expr_stmt|;
name|edit
operator|.
name|add
argument_list|(
name|m
argument_list|)
expr_stmt|;
block|}
block|}
name|edit
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
name|edit
operator|.
name|add
argument_list|(
name|manageKeywords
argument_list|)
expr_stmt|;
name|edit
operator|.
name|add
argument_list|(
name|selectAll
argument_list|)
expr_stmt|;
name|mb
operator|.
name|add
argument_list|(
name|edit
argument_list|)
expr_stmt|;
name|search
operator|.
name|add
argument_list|(
name|normalSearch
argument_list|)
expr_stmt|;
name|search
operator|.
name|add
argument_list|(
name|incrementalSearch
argument_list|)
expr_stmt|;
name|search
operator|.
name|add
argument_list|(
name|replaceAll
argument_list|)
expr_stmt|;
name|search
operator|.
name|add
argument_list|(
name|massSetField
argument_list|)
expr_stmt|;
name|search
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
name|search
operator|.
name|add
argument_list|(
name|dupliCheck
argument_list|)
expr_stmt|;
name|search
operator|.
name|add
argument_list|(
name|resolveDuplicateKeys
argument_list|)
expr_stmt|;
comment|//search.add(strictDupliCheck);
name|search
operator|.
name|add
argument_list|(
name|autoSetFile
argument_list|)
expr_stmt|;
name|search
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
name|GeneralFetcher
name|generalFetcher
init|=
operator|new
name|GeneralFetcher
argument_list|(
name|sidePaneManager
argument_list|,
name|this
argument_list|)
decl_stmt|;
name|search
operator|.
name|add
argument_list|(
name|generalFetcher
operator|.
name|getAction
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|WEB_SEARCH_VISIBLE
argument_list|)
condition|)
block|{
name|sidePaneManager
operator|.
name|register
argument_list|(
name|generalFetcher
operator|.
name|getTitle
argument_list|()
argument_list|,
name|generalFetcher
argument_list|)
expr_stmt|;
name|sidePaneManager
operator|.
name|show
argument_list|(
name|generalFetcher
operator|.
name|getTitle
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|mb
operator|.
name|add
argument_list|(
name|search
argument_list|)
expr_stmt|;
name|view
operator|.
name|add
argument_list|(
name|back
argument_list|)
expr_stmt|;
name|view
operator|.
name|add
argument_list|(
name|forward
argument_list|)
expr_stmt|;
name|view
operator|.
name|add
argument_list|(
name|focusTable
argument_list|)
expr_stmt|;
name|view
operator|.
name|add
argument_list|(
name|nextTab
argument_list|)
expr_stmt|;
name|view
operator|.
name|add
argument_list|(
name|prevTab
argument_list|)
expr_stmt|;
name|view
operator|.
name|add
argument_list|(
name|sortTabs
argument_list|)
expr_stmt|;
name|view
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
name|view
operator|.
name|add
argument_list|(
name|increaseFontSize
argument_list|)
expr_stmt|;
name|view
operator|.
name|add
argument_list|(
name|decreseFontSize
argument_list|)
expr_stmt|;
name|view
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
name|view
operator|.
name|add
argument_list|(
name|toggleToolbar
argument_list|)
expr_stmt|;
name|view
operator|.
name|add
argument_list|(
name|toggleGroups
argument_list|)
expr_stmt|;
name|view
operator|.
name|add
argument_list|(
name|togglePreview
argument_list|)
expr_stmt|;
name|view
operator|.
name|add
argument_list|(
name|switchPreview
argument_list|)
expr_stmt|;
name|view
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
name|view
operator|.
name|add
argument_list|(
name|toggleHighlightAny
argument_list|)
expr_stmt|;
name|view
operator|.
name|add
argument_list|(
name|toggleHighlightAll
argument_list|)
expr_stmt|;
name|mb
operator|.
name|add
argument_list|(
name|view
argument_list|)
expr_stmt|;
name|bibtex
operator|.
name|add
argument_list|(
name|newEntryAction
argument_list|)
expr_stmt|;
for|for
control|(
name|NewEntryAction
name|aNewSpecificEntryAction
range|:
name|newSpecificEntryAction
control|)
block|{
name|newSpec
operator|.
name|add
argument_list|(
name|aNewSpecificEntryAction
argument_list|)
expr_stmt|;
block|}
name|bibtex
operator|.
name|add
argument_list|(
name|newSpec
argument_list|)
expr_stmt|;
name|bibtex
operator|.
name|add
argument_list|(
name|plainTextImport
argument_list|)
expr_stmt|;
name|bibtex
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
name|bibtex
operator|.
name|add
argument_list|(
name|editEntry
argument_list|)
expr_stmt|;
name|bibtex
operator|.
name|add
argument_list|(
name|editPreamble
argument_list|)
expr_stmt|;
name|bibtex
operator|.
name|add
argument_list|(
name|editStrings
argument_list|)
expr_stmt|;
name|mb
operator|.
name|add
argument_list|(
name|bibtex
argument_list|)
expr_stmt|;
name|tools
operator|.
name|add
argument_list|(
name|makeKeyAction
argument_list|)
expr_stmt|;
name|tools
operator|.
name|add
argument_list|(
name|Cleanup
argument_list|)
expr_stmt|;
name|tools
operator|.
name|add
argument_list|(
name|mergeEntries
argument_list|)
expr_stmt|;
comment|//tools.add(downloadFullText);
name|tools
operator|.
name|add
argument_list|(
name|newSubDatabaseAction
argument_list|)
expr_stmt|;
name|tools
operator|.
name|add
argument_list|(
name|writeXmpAction
argument_list|)
expr_stmt|;
name|OpenOfficePanel
name|otp
init|=
name|OpenOfficePanel
operator|.
name|getInstance
argument_list|()
decl_stmt|;
name|otp
operator|.
name|init
argument_list|(
name|this
argument_list|,
name|sidePaneManager
argument_list|)
expr_stmt|;
name|tools
operator|.
name|add
argument_list|(
name|otp
operator|.
name|getMenuItem
argument_list|()
argument_list|)
expr_stmt|;
name|tools
operator|.
name|add
argument_list|(
name|pushExternalButton
operator|.
name|getMenuAction
argument_list|()
argument_list|)
expr_stmt|;
name|tools
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
name|tools
operator|.
name|add
argument_list|(
name|manageSelectors
argument_list|)
expr_stmt|;
name|tools
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
name|tools
operator|.
name|add
argument_list|(
name|openFolder
argument_list|)
expr_stmt|;
name|tools
operator|.
name|add
argument_list|(
name|openFile
argument_list|)
expr_stmt|;
name|tools
operator|.
name|add
argument_list|(
name|openPdf
argument_list|)
expr_stmt|;
name|tools
operator|.
name|add
argument_list|(
name|openUrl
argument_list|)
expr_stmt|;
comment|//tools.add(openSpires);
name|tools
operator|.
name|add
argument_list|(
name|findUnlinkedFiles
argument_list|)
expr_stmt|;
name|tools
operator|.
name|add
argument_list|(
name|autoLinkFile
argument_list|)
expr_stmt|;
name|tools
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
name|tools
operator|.
name|add
argument_list|(
name|abbreviateIso
argument_list|)
expr_stmt|;
name|tools
operator|.
name|add
argument_list|(
name|abbreviateMedline
argument_list|)
expr_stmt|;
name|tools
operator|.
name|add
argument_list|(
name|unabbreviate
argument_list|)
expr_stmt|;
name|tools
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
name|checkAndFix
operator|.
name|add
argument_list|(
name|autoSetPdf
argument_list|)
expr_stmt|;
name|checkAndFix
operator|.
name|add
argument_list|(
name|autoSetPs
argument_list|)
expr_stmt|;
name|checkAndFix
operator|.
name|add
argument_list|(
name|integrityCheckAction
argument_list|)
expr_stmt|;
name|tools
operator|.
name|add
argument_list|(
name|checkAndFix
argument_list|)
expr_stmt|;
name|mb
operator|.
name|add
argument_list|(
name|tools
argument_list|)
expr_stmt|;
name|options
operator|.
name|add
argument_list|(
name|showPrefs
argument_list|)
expr_stmt|;
name|AbstractAction
name|customizeAction
init|=
operator|new
name|CustomizeEntryTypeAction
argument_list|()
decl_stmt|;
name|AbstractAction
name|genFieldsCustomization
init|=
operator|new
name|GenFieldsCustomizationAction
argument_list|()
decl_stmt|;
name|options
operator|.
name|add
argument_list|(
name|customizeAction
argument_list|)
expr_stmt|;
name|options
operator|.
name|add
argument_list|(
name|genFieldsCustomization
argument_list|)
expr_stmt|;
name|options
operator|.
name|add
argument_list|(
name|customExpAction
argument_list|)
expr_stmt|;
name|options
operator|.
name|add
argument_list|(
name|customImpAction
argument_list|)
expr_stmt|;
name|options
operator|.
name|add
argument_list|(
name|customFileTypesAction
argument_list|)
expr_stmt|;
name|options
operator|.
name|add
argument_list|(
name|manageJournals
argument_list|)
expr_stmt|;
comment|/*options.add(new AbstractAction("Font") {         public void actionPerformed(ActionEvent e) {             Font f=new FontSelectorDialog           (JabRefFrame.this, GUIGlobals.CURRENTFONT).getSelectedFont();          if(f==null)           return;          else           GUIGlobals.CURRENTFONT=f;          // updatefont          prefs.put(JabRefPreferences.FONT_FAMILY, GUIGlobals.CURRENTFONT.getFamily());          prefs.putInt("fontStyle", GUIGlobals.CURRENTFONT.getStyle());          prefs.putInt("fontSize", GUIGlobals.CURRENTFONT.getSize());          if (tabbedPane.getTabCount()> 0) {           for (int i=0; i<tabbedPane.getTabCount(); i++) {            baseAt(i).entryTable.updateFont();            baseAt(i).refreshTable();           }          }         }         });*/
name|options
operator|.
name|add
argument_list|(
name|selectKeys
argument_list|)
expr_stmt|;
name|mb
operator|.
name|add
argument_list|(
name|options
argument_list|)
expr_stmt|;
name|helpMenu
operator|.
name|add
argument_list|(
name|help
argument_list|)
expr_stmt|;
name|helpMenu
operator|.
name|add
argument_list|(
name|contents
argument_list|)
expr_stmt|;
name|helpMenu
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
name|helpMenu
operator|.
name|add
argument_list|(
name|errorConsole
argument_list|)
expr_stmt|;
name|helpMenu
operator|.
name|add
argument_list|(
name|forkMeOnGitHubAction
argument_list|)
expr_stmt|;
name|helpMenu
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
name|helpMenu
operator|.
name|add
argument_list|(
name|about
argument_list|)
expr_stmt|;
name|mb
operator|.
name|add
argument_list|(
name|helpMenu
argument_list|)
expr_stmt|;
block|}
DECL|method|subMenu (String name)
specifier|public
specifier|static
name|JMenu
name|subMenu
parameter_list|(
name|String
name|name
parameter_list|)
block|{
name|name
operator|=
name|Localization
operator|.
name|menuTitle
argument_list|(
name|name
argument_list|)
expr_stmt|;
name|int
name|i
init|=
name|name
operator|.
name|indexOf
argument_list|(
literal|'&'
argument_list|)
decl_stmt|;
name|JMenu
name|res
decl_stmt|;
if|if
condition|(
name|i
operator|>=
literal|0
condition|)
block|{
name|res
operator|=
operator|new
name|JMenu
argument_list|(
name|name
operator|.
name|substring
argument_list|(
literal|0
argument_list|,
name|i
argument_list|)
operator|+
name|name
operator|.
name|substring
argument_list|(
name|i
operator|+
literal|1
argument_list|)
argument_list|)
expr_stmt|;
name|char
name|mnemonic
init|=
name|Character
operator|.
name|toUpperCase
argument_list|(
name|name
operator|.
name|charAt
argument_list|(
name|i
operator|+
literal|1
argument_list|)
argument_list|)
decl_stmt|;
name|res
operator|.
name|setMnemonic
argument_list|(
operator|(
name|int
operator|)
name|mnemonic
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|res
operator|=
operator|new
name|JMenu
argument_list|(
name|name
argument_list|)
expr_stmt|;
block|}
return|return
name|res
return|;
block|}
DECL|method|addParserResult (ParserResult pr, boolean raisePanel)
specifier|public
name|void
name|addParserResult
parameter_list|(
name|ParserResult
name|pr
parameter_list|,
name|boolean
name|raisePanel
parameter_list|)
block|{
if|if
condition|(
name|pr
operator|.
name|toOpenTab
argument_list|()
condition|)
block|{
comment|// Add the entries to the open tab.
name|BasePanel
name|panel
init|=
name|basePanel
argument_list|()
decl_stmt|;
if|if
condition|(
name|panel
operator|==
literal|null
condition|)
block|{
comment|// There is no open tab to add to, so we create a new tab:
name|addTab
argument_list|(
name|pr
operator|.
name|getDatabase
argument_list|()
argument_list|,
name|pr
operator|.
name|getFile
argument_list|()
argument_list|,
name|pr
operator|.
name|getMetaData
argument_list|()
argument_list|,
name|pr
operator|.
name|getEncoding
argument_list|()
argument_list|,
name|raisePanel
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|List
argument_list|<
name|BibtexEntry
argument_list|>
name|entries
init|=
operator|new
name|ArrayList
argument_list|<
name|BibtexEntry
argument_list|>
argument_list|(
name|pr
operator|.
name|getDatabase
argument_list|()
operator|.
name|getEntries
argument_list|()
argument_list|)
decl_stmt|;
name|addImportedEntries
argument_list|(
name|panel
argument_list|,
name|entries
argument_list|,
literal|""
argument_list|,
literal|false
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
name|addTab
argument_list|(
name|pr
operator|.
name|getDatabase
argument_list|()
argument_list|,
name|pr
operator|.
name|getFile
argument_list|()
argument_list|,
name|pr
operator|.
name|getMetaData
argument_list|()
argument_list|,
name|pr
operator|.
name|getEncoding
argument_list|()
argument_list|,
name|raisePanel
argument_list|)
expr_stmt|;
block|}
block|}
DECL|method|createToolBar ()
specifier|private
name|void
name|createToolBar
parameter_list|()
block|{
name|tlb
operator|.
name|putClientProperty
argument_list|(
name|Options
operator|.
name|HEADER_STYLE_KEY
argument_list|,
name|HeaderStyle
operator|.
name|BOTH
argument_list|)
expr_stmt|;
name|tlb
operator|.
name|setBorder
argument_list|(
literal|null
argument_list|)
expr_stmt|;
name|tlb
operator|.
name|setRollover
argument_list|(
literal|true
argument_list|)
expr_stmt|;
comment|//tlb.setBorderPainted(true);
comment|//tlb.setBackground(GUIGlobals.lightGray);
comment|//tlb.setForeground(GUIGlobals.lightGray);
name|tlb
operator|.
name|setFloatable
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|tlb
operator|.
name|addAction
argument_list|(
name|newDatabaseAction
argument_list|)
expr_stmt|;
name|tlb
operator|.
name|addAction
argument_list|(
name|open
argument_list|)
expr_stmt|;
name|tlb
operator|.
name|addAction
argument_list|(
name|save
argument_list|)
expr_stmt|;
name|tlb
operator|.
name|addAction
argument_list|(
name|saveAll
argument_list|)
expr_stmt|;
comment|//tlb.addAction(dbConnect);
comment|//tlb.addAction(dbExport);
name|tlb
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
name|tlb
operator|.
name|addAction
argument_list|(
name|cut
argument_list|)
expr_stmt|;
name|tlb
operator|.
name|addAction
argument_list|(
name|copy
argument_list|)
expr_stmt|;
name|tlb
operator|.
name|addAction
argument_list|(
name|paste
argument_list|)
expr_stmt|;
name|tlb
operator|.
name|addAction
argument_list|(
name|undo
argument_list|)
expr_stmt|;
name|tlb
operator|.
name|addAction
argument_list|(
name|redo
argument_list|)
expr_stmt|;
name|tlb
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
name|tlb
operator|.
name|addAction
argument_list|(
name|back
argument_list|)
expr_stmt|;
name|tlb
operator|.
name|addAction
argument_list|(
name|forward
argument_list|)
expr_stmt|;
name|tlb
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
name|tlb
operator|.
name|addAction
argument_list|(
name|newEntryAction
argument_list|)
expr_stmt|;
name|tlb
operator|.
name|addAction
argument_list|(
name|editEntry
argument_list|)
expr_stmt|;
name|tlb
operator|.
name|addAction
argument_list|(
name|editPreamble
argument_list|)
expr_stmt|;
name|tlb
operator|.
name|addAction
argument_list|(
name|editStrings
argument_list|)
expr_stmt|;
name|tlb
operator|.
name|addAction
argument_list|(
name|makeKeyAction
argument_list|)
expr_stmt|;
name|tlb
operator|.
name|addAction
argument_list|(
name|Cleanup
argument_list|)
expr_stmt|;
name|tlb
operator|.
name|addAction
argument_list|(
name|mergeEntries
argument_list|)
expr_stmt|;
name|tlb
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
name|tlb
operator|.
name|addAction
argument_list|(
name|mark
argument_list|)
expr_stmt|;
name|tlb
operator|.
name|addAction
argument_list|(
name|unmark
argument_list|)
expr_stmt|;
name|tlb
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|SpecialFieldsUtils
operator|.
name|PREF_SPECIALFIELDSENABLED
argument_list|)
condition|)
block|{
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|SpecialFieldsUtils
operator|.
name|PREF_SHOWCOLUMN_RANKING
argument_list|)
condition|)
block|{
name|tlb
operator|.
name|add
argument_list|(
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|specialfields
operator|.
name|SpecialFieldDropDown
operator|.
name|generateSpecialFieldButtonWithDropDown
argument_list|(
name|Rank
operator|.
name|getInstance
argument_list|()
argument_list|,
name|this
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|SpecialFieldsUtils
operator|.
name|PREF_SHOWCOLUMN_RELEVANCE
argument_list|)
condition|)
block|{
name|tlb
operator|.
name|addAction
argument_list|(
name|toggleRelevance
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|SpecialFieldsUtils
operator|.
name|PREF_SHOWCOLUMN_QUALITY
argument_list|)
condition|)
block|{
name|tlb
operator|.
name|addAction
argument_list|(
name|toggleQualityAssured
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|SpecialFieldsUtils
operator|.
name|PREF_SHOWCOLUMN_PRIORITY
argument_list|)
condition|)
block|{
name|tlb
operator|.
name|add
argument_list|(
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|specialfields
operator|.
name|SpecialFieldDropDown
operator|.
name|generateSpecialFieldButtonWithDropDown
argument_list|(
name|Priority
operator|.
name|getInstance
argument_list|()
argument_list|,
name|this
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|SpecialFieldsUtils
operator|.
name|PREF_SHOWCOLUMN_PRINTED
argument_list|)
condition|)
block|{
name|tlb
operator|.
name|addAction
argument_list|(
name|togglePrinted
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|SpecialFieldsUtils
operator|.
name|PREF_SHOWCOLUMN_READ
argument_list|)
condition|)
block|{
name|tlb
operator|.
name|add
argument_list|(
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|specialfields
operator|.
name|SpecialFieldDropDown
operator|.
name|generateSpecialFieldButtonWithDropDown
argument_list|(
name|ReadStatus
operator|.
name|getInstance
argument_list|()
argument_list|,
name|this
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
name|tlb
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
name|searchToggle
operator|=
operator|new
name|JToggleButton
argument_list|(
name|toggleSearch
argument_list|)
expr_stmt|;
name|searchToggle
operator|.
name|setText
argument_list|(
literal|null
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|OS
operator|.
name|OS_X
condition|)
block|{
name|searchToggle
operator|.
name|setMargin
argument_list|(
name|marg
argument_list|)
expr_stmt|;
block|}
name|tlb
operator|.
name|add
argument_list|(
name|searchToggle
argument_list|)
expr_stmt|;
name|previewToggle
operator|=
operator|new
name|JToggleButton
argument_list|(
name|togglePreview
argument_list|)
expr_stmt|;
name|previewToggle
operator|.
name|setText
argument_list|(
literal|null
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|OS
operator|.
name|OS_X
condition|)
block|{
name|previewToggle
operator|.
name|setMargin
argument_list|(
name|marg
argument_list|)
expr_stmt|;
block|}
name|tlb
operator|.
name|add
argument_list|(
name|previewToggle
argument_list|)
expr_stmt|;
name|tlb
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
name|groupToggle
operator|=
operator|new
name|JToggleButton
argument_list|(
name|toggleGroups
argument_list|)
expr_stmt|;
name|groupToggle
operator|.
name|setText
argument_list|(
literal|null
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|OS
operator|.
name|OS_X
condition|)
block|{
name|groupToggle
operator|.
name|setMargin
argument_list|(
name|marg
argument_list|)
expr_stmt|;
block|}
name|tlb
operator|.
name|add
argument_list|(
name|groupToggle
argument_list|)
expr_stmt|;
name|highlightAny
operator|=
operator|new
name|JToggleButton
argument_list|(
name|toggleHighlightAny
argument_list|)
expr_stmt|;
name|highlightAny
operator|.
name|setText
argument_list|(
literal|null
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|OS
operator|.
name|OS_X
condition|)
block|{
name|highlightAny
operator|.
name|setMargin
argument_list|(
name|marg
argument_list|)
expr_stmt|;
block|}
name|tlb
operator|.
name|add
argument_list|(
name|highlightAny
argument_list|)
expr_stmt|;
name|highlightAll
operator|=
operator|new
name|JToggleButton
argument_list|(
name|toggleHighlightAll
argument_list|)
expr_stmt|;
name|highlightAll
operator|.
name|setText
argument_list|(
literal|null
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|OS
operator|.
name|OS_X
condition|)
block|{
name|highlightAll
operator|.
name|setMargin
argument_list|(
name|marg
argument_list|)
expr_stmt|;
block|}
name|tlb
operator|.
name|add
argument_list|(
name|highlightAll
argument_list|)
expr_stmt|;
name|tlb
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
comment|// Removing the separate push-to buttons, replacing them by the
comment|// multipurpose button:
comment|//tlb.addAction(emacsPushAction);
comment|//tlb.addAction(lyxPushAction);
comment|//tlb.addAction(winEdtPushAction);
name|tlb
operator|.
name|add
argument_list|(
name|pushExternalButton
operator|.
name|getComponent
argument_list|()
argument_list|)
expr_stmt|;
name|tlb
operator|.
name|addAction
argument_list|(
name|openFolder
argument_list|)
expr_stmt|;
name|tlb
operator|.
name|addAction
argument_list|(
name|openFile
argument_list|)
expr_stmt|;
comment|//tlb.addAction(openPdf);
comment|//tlb.addAction(openUrl);
comment|//tlb.addSeparator();
comment|//tlb.addAction(showPrefs);
name|tlb
operator|.
name|add
argument_list|(
name|Box
operator|.
name|createHorizontalGlue
argument_list|()
argument_list|)
expr_stmt|;
comment|//tlb.add(new JabRefLabel(GUIGlobals.frameTitle+" "+GUIGlobals.version));
name|tlb
operator|.
name|addAction
argument_list|(
name|closeDatabaseAction
argument_list|)
expr_stmt|;
comment|//Insets margin = new Insets(0, 0, 0, 0);
comment|//for (int i=0; i<tlb.getComponentCount(); i++)
comment|//  ((JButton)tlb.getComponentAtIndex(i)).setMargin(margin);
block|}
DECL|method|output (final String s)
specifier|public
name|void
name|output
parameter_list|(
specifier|final
name|String
name|s
parameter_list|)
block|{
name|SwingUtilities
operator|.
name|invokeLater
argument_list|(
operator|new
name|Runnable
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|run
parameter_list|()
block|{
name|statusLine
operator|.
name|setText
argument_list|(
name|s
argument_list|)
expr_stmt|;
name|statusLine
operator|.
name|repaint
argument_list|()
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
block|}
DECL|method|stopShowingSearchResults ()
specifier|public
name|void
name|stopShowingSearchResults
parameter_list|()
block|{
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|tabbedPane
operator|.
name|getTabCount
argument_list|()
condition|;
name|i
operator|++
control|)
block|{
name|baseAt
argument_list|(
name|i
argument_list|)
operator|.
name|stopShowingSearchResults
argument_list|()
expr_stmt|;
block|}
block|}
DECL|field|openDatabaseOnlyActions
specifier|private
name|List
argument_list|<
name|Object
argument_list|>
name|openDatabaseOnlyActions
init|=
operator|new
name|LinkedList
argument_list|<
name|Object
argument_list|>
argument_list|()
decl_stmt|;
DECL|field|severalDatabasesOnlyActions
specifier|private
name|List
argument_list|<
name|Object
argument_list|>
name|severalDatabasesOnlyActions
init|=
operator|new
name|LinkedList
argument_list|<
name|Object
argument_list|>
argument_list|()
decl_stmt|;
DECL|method|initActions ()
specifier|private
name|void
name|initActions
parameter_list|()
block|{
name|openDatabaseOnlyActions
operator|=
operator|new
name|LinkedList
argument_list|<
name|Object
argument_list|>
argument_list|()
expr_stmt|;
name|openDatabaseOnlyActions
operator|.
name|addAll
argument_list|(
name|Arrays
operator|.
name|asList
argument_list|(
name|manageSelectors
argument_list|,
name|mergeDatabaseAction
argument_list|,
name|newSubDatabaseAction
argument_list|,
name|close
argument_list|,
name|save
argument_list|,
name|saveAs
argument_list|,
name|saveSelectedAs
argument_list|,
name|saveSelectedAsPlain
argument_list|,
name|undo
argument_list|,
name|redo
argument_list|,
name|cut
argument_list|,
name|delete
argument_list|,
name|copy
argument_list|,
name|paste
argument_list|,
name|mark
argument_list|,
name|unmark
argument_list|,
name|unmarkAll
argument_list|,
name|editEntry
argument_list|,
name|selectAll
argument_list|,
name|copyKey
argument_list|,
name|copyCiteKey
argument_list|,
name|copyKeyAndTitle
argument_list|,
name|editPreamble
argument_list|,
name|editStrings
argument_list|,
name|toggleGroups
argument_list|,
name|toggleSearch
argument_list|,
name|makeKeyAction
argument_list|,
name|normalSearch
argument_list|,
name|incrementalSearch
argument_list|,
name|replaceAll
argument_list|,
name|importMenu
argument_list|,
name|exportMenu
argument_list|,
comment|/* openSpires wasn't being supported so no point in supporting                  * openInspire */
name|openPdf
argument_list|,
name|openUrl
argument_list|,
name|openFolder
argument_list|,
name|openFile
argument_list|,
name|openSpires
argument_list|,
comment|/*openInspire,*/
name|togglePreview
argument_list|,
name|dupliCheck
argument_list|,
comment|/*strictDupliCheck,*/
name|highlightAll
argument_list|,
name|highlightAny
argument_list|,
name|newEntryAction
argument_list|,
name|plainTextImport
argument_list|,
name|massSetField
argument_list|,
name|manageKeywords
argument_list|,
name|closeDatabaseAction
argument_list|,
name|switchPreview
argument_list|,
name|integrityCheckAction
argument_list|,
name|autoSetPdf
argument_list|,
name|autoSetPs
argument_list|,
name|toggleHighlightAny
argument_list|,
name|toggleHighlightAll
argument_list|,
name|databaseProperties
argument_list|,
name|abbreviateIso
argument_list|,
name|abbreviateMedline
argument_list|,
name|unabbreviate
argument_list|,
name|exportAll
argument_list|,
name|exportSelected
argument_list|,
name|importCurrent
argument_list|,
name|saveAll
argument_list|,
name|dbConnect
argument_list|,
name|dbExport
argument_list|,
name|focusTable
argument_list|)
argument_list|)
expr_stmt|;
name|openDatabaseOnlyActions
operator|.
name|addAll
argument_list|(
name|fetcherActions
argument_list|)
expr_stmt|;
name|openDatabaseOnlyActions
operator|.
name|addAll
argument_list|(
name|Arrays
operator|.
name|asList
argument_list|(
name|newSpecificEntryAction
argument_list|)
argument_list|)
expr_stmt|;
name|severalDatabasesOnlyActions
operator|=
operator|new
name|LinkedList
argument_list|<
name|Object
argument_list|>
argument_list|()
expr_stmt|;
name|severalDatabasesOnlyActions
operator|.
name|addAll
argument_list|(
name|Arrays
operator|.
name|asList
argument_list|(
name|nextTab
argument_list|,
name|prevTab
argument_list|,
name|sortTabs
argument_list|)
argument_list|)
expr_stmt|;
name|tabbedPane
operator|.
name|addChangeListener
argument_list|(
operator|new
name|ChangeListener
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|stateChanged
parameter_list|(
name|ChangeEvent
name|event
parameter_list|)
block|{
name|updateEnabledState
argument_list|()
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
block|}
comment|/**      * Takes a list of Object and calls the method setEnabled on them, depending on whether it is an Action or a Component.      * @param list List that should contain Actions and Components.      * @param enabled       */
DECL|method|setEnabled (List<Object> list, boolean enabled)
specifier|private
specifier|static
name|void
name|setEnabled
parameter_list|(
name|List
argument_list|<
name|Object
argument_list|>
name|list
parameter_list|,
name|boolean
name|enabled
parameter_list|)
block|{
for|for
control|(
name|Object
name|o
range|:
name|list
control|)
block|{
if|if
condition|(
name|o
operator|instanceof
name|Action
condition|)
block|{
operator|(
operator|(
name|Action
operator|)
name|o
operator|)
operator|.
name|setEnabled
argument_list|(
name|enabled
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|o
operator|instanceof
name|Component
condition|)
block|{
operator|(
operator|(
name|Component
operator|)
name|o
operator|)
operator|.
name|setEnabled
argument_list|(
name|enabled
argument_list|)
expr_stmt|;
block|}
block|}
block|}
DECL|field|previousTabCount
specifier|private
name|int
name|previousTabCount
init|=
operator|-
literal|1
decl_stmt|;
comment|/**      * Enable or Disable all actions based on the number of open tabs.      *       * The action that are affected are set in initActions.      */
DECL|method|updateEnabledState ()
specifier|private
name|void
name|updateEnabledState
parameter_list|()
block|{
name|int
name|tabCount
init|=
name|tabbedPane
operator|.
name|getTabCount
argument_list|()
decl_stmt|;
if|if
condition|(
name|tabCount
operator|!=
name|previousTabCount
condition|)
block|{
name|previousTabCount
operator|=
name|tabCount
expr_stmt|;
name|JabRefFrame
operator|.
name|setEnabled
argument_list|(
name|openDatabaseOnlyActions
argument_list|,
name|tabCount
operator|>
literal|0
argument_list|)
expr_stmt|;
name|JabRefFrame
operator|.
name|setEnabled
argument_list|(
name|severalDatabasesOnlyActions
argument_list|,
name|tabCount
operator|>
literal|1
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|tabCount
operator|==
literal|0
condition|)
block|{
name|back
operator|.
name|setEnabled
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|forward
operator|.
name|setEnabled
argument_list|(
literal|false
argument_list|)
expr_stmt|;
block|}
block|}
comment|/**      * This method causes all open BasePanels to set up their tables      * anew. When called from PrefsDialog3, this updates to the new      * settings.      */
DECL|method|setupAllTables ()
specifier|public
name|void
name|setupAllTables
parameter_list|()
block|{
comment|// This action can be invoked without an open database, so
comment|// we have to check if we have one before trying to invoke
comment|// methods to execute changes in the preferences.
comment|// We want to notify all tabs about the changes to
comment|// avoid problems when changing the column set.
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|tabbedPane
operator|.
name|getTabCount
argument_list|()
condition|;
name|i
operator|++
control|)
block|{
name|BasePanel
name|bf
init|=
name|baseAt
argument_list|(
name|i
argument_list|)
decl_stmt|;
comment|// Update tables:
if|if
condition|(
name|bf
operator|.
name|database
operator|!=
literal|null
condition|)
block|{
name|bf
operator|.
name|setupMainPanel
argument_list|()
expr_stmt|;
block|}
block|}
block|}
DECL|method|addTab (BibtexDatabase db, File file, MetaData metaData, String encoding, boolean raisePanel)
specifier|public
name|BasePanel
name|addTab
parameter_list|(
name|BibtexDatabase
name|db
parameter_list|,
name|File
name|file
parameter_list|,
name|MetaData
name|metaData
parameter_list|,
name|String
name|encoding
parameter_list|,
name|boolean
name|raisePanel
parameter_list|)
block|{
comment|// ensure that non-null parameters are really non-null
if|if
condition|(
name|metaData
operator|==
literal|null
condition|)
block|{
name|metaData
operator|=
operator|new
name|MetaData
argument_list|()
expr_stmt|;
block|}
if|if
condition|(
name|encoding
operator|==
literal|null
condition|)
block|{
name|encoding
operator|=
name|Globals
operator|.
name|prefs
operator|.
name|get
argument_list|(
name|JabRefPreferences
operator|.
name|DEFAULT_ENCODING
argument_list|)
expr_stmt|;
block|}
name|BasePanel
name|bp
init|=
operator|new
name|BasePanel
argument_list|(
name|JabRefFrame
operator|.
name|this
argument_list|,
name|db
argument_list|,
name|file
argument_list|,
name|metaData
argument_list|,
name|encoding
argument_list|)
decl_stmt|;
name|addTab
argument_list|(
name|bp
argument_list|,
name|file
argument_list|,
name|raisePanel
argument_list|)
expr_stmt|;
return|return
name|bp
return|;
block|}
DECL|method|addTab (BasePanel bp, File file, boolean raisePanel)
specifier|public
name|void
name|addTab
parameter_list|(
name|BasePanel
name|bp
parameter_list|,
name|File
name|file
parameter_list|,
name|boolean
name|raisePanel
parameter_list|)
block|{
name|String
name|title
decl_stmt|;
if|if
condition|(
name|file
operator|==
literal|null
condition|)
block|{
name|title
operator|=
name|Localization
operator|.
name|lang
argument_list|(
name|GUIGlobals
operator|.
name|untitledTitle
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|bp
operator|.
name|database
argument_list|()
operator|.
name|getEntries
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
comment|// if the database is not empty and no file is assigned,
comment|// the database came from an import and has to be treated somehow
comment|// -> mark as changed
comment|// This also happens internally at basepanel to ensure consistency
name|title
operator|=
name|title
operator|+
literal|'*'
expr_stmt|;
block|}
block|}
else|else
block|{
name|title
operator|=
name|file
operator|.
name|getName
argument_list|()
expr_stmt|;
block|}
comment|// idea: "<html><div style='padding:2px 5px;'>" + title + "</div></html>" instead of "title" to get some space around.
comment|// However, this causes https://sourceforge.net/p/jabref/bugs/1293/
comment|// Therefore, plain "title" is used
name|tabbedPane
operator|.
name|add
argument_list|(
name|title
argument_list|,
name|bp
argument_list|)
expr_stmt|;
name|tabbedPane
operator|.
name|setToolTipTextAt
argument_list|(
name|tabbedPane
operator|.
name|getTabCount
argument_list|()
operator|-
literal|1
argument_list|,
name|file
operator|!=
literal|null
condition|?
name|file
operator|.
name|getAbsolutePath
argument_list|()
else|:
literal|null
argument_list|)
expr_stmt|;
if|if
condition|(
name|raisePanel
condition|)
block|{
name|tabbedPane
operator|.
name|setSelectedComponent
argument_list|(
name|bp
argument_list|)
expr_stmt|;
block|}
block|}
comment|/**      * Signal closing of the current tab. Standard warnings will be given if the      * database has been changed.      */
DECL|method|closeCurrentTab ()
specifier|public
name|void
name|closeCurrentTab
parameter_list|()
block|{
name|closeDatabaseAction
operator|.
name|actionPerformed
argument_list|(
literal|null
argument_list|)
expr_stmt|;
block|}
comment|/**      * Close the current tab without giving any warning if the database has been changed.      */
DECL|method|closeCurrentTabNoWarning ()
specifier|public
name|void
name|closeCurrentTabNoWarning
parameter_list|()
block|{
name|closeDatabaseAction
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
DECL|class|SelectKeysAction
class|class
name|SelectKeysAction
extends|extends
name|AbstractAction
block|{
DECL|method|SelectKeysAction ()
specifier|public
name|SelectKeysAction
parameter_list|()
block|{
name|super
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Customize key bindings"
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
DECL|method|actionPerformed (ActionEvent e)
specifier|public
name|void
name|actionPerformed
parameter_list|(
name|ActionEvent
name|e
parameter_list|)
block|{
name|KeyBindingsDialog
name|d
init|=
operator|new
name|KeyBindingsDialog
argument_list|(
operator|new
name|HashMap
argument_list|<
name|String
argument_list|,
name|String
argument_list|>
argument_list|(
name|prefs
operator|.
name|getKeyBindings
argument_list|()
argument_list|)
argument_list|,
name|prefs
operator|.
name|getDefaultKeys
argument_list|()
argument_list|)
decl_stmt|;
name|d
operator|.
name|setDefaultCloseOperation
argument_list|(
name|WindowConstants
operator|.
name|DISPOSE_ON_CLOSE
argument_list|)
expr_stmt|;
name|d
operator|.
name|pack
argument_list|()
expr_stmt|;
comment|//setSize(300,500);
name|Util
operator|.
name|placeDialog
argument_list|(
name|d
argument_list|,
name|JabRefFrame
operator|.
name|this
argument_list|)
expr_stmt|;
name|d
operator|.
name|setVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
if|if
condition|(
name|d
operator|.
name|getAction
argument_list|()
condition|)
block|{
name|prefs
operator|.
name|setNewKeyBindings
argument_list|(
name|d
operator|.
name|getNewKeyBindings
argument_list|()
argument_list|)
expr_stmt|;
name|JOptionPane
operator|.
name|showMessageDialog
argument_list|(
name|JabRefFrame
operator|.
name|this
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Your new key bindings have been stored."
argument_list|)
operator|+
literal|'\n'
operator|+
name|Localization
operator|.
name|lang
argument_list|(
literal|"You must restart JabRef for the new key "
operator|+
literal|"bindings to work properly."
argument_list|)
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Key bindings changed"
argument_list|)
argument_list|,
name|JOptionPane
operator|.
name|INFORMATION_MESSAGE
argument_list|)
expr_stmt|;
block|}
block|}
block|}
comment|/**      * The action concerned with closing the window.      */
DECL|class|CloseAction
class|class
name|CloseAction
extends|extends
name|MnemonicAwareAction
block|{
DECL|method|CloseAction ()
specifier|public
name|CloseAction
parameter_list|()
block|{
name|putValue
argument_list|(
name|Action
operator|.
name|NAME
argument_list|,
literal|"Quit"
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|SHORT_DESCRIPTION
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Quit JabRef"
argument_list|)
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|ACCELERATOR_KEY
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Quit JabRef"
argument_list|)
argument_list|)
expr_stmt|;
comment|//putValue(ACCELERATOR_KEY, KeyStroke.getKeyStroke(KeyEvent.VK_Q,
comment|//    Toolkit.getDefaultToolkit().getMenuShortcutKeyMask()));
block|}
annotation|@
name|Override
DECL|method|actionPerformed (ActionEvent e)
specifier|public
name|void
name|actionPerformed
parameter_list|(
name|ActionEvent
name|e
parameter_list|)
block|{
name|quit
argument_list|()
expr_stmt|;
block|}
block|}
comment|// The action for closing the current database and leaving the window open.
DECL|field|closeDatabaseAction
specifier|private
specifier|final
name|CloseDatabaseAction
name|closeDatabaseAction
init|=
operator|new
name|CloseDatabaseAction
argument_list|()
decl_stmt|;
DECL|class|CloseDatabaseAction
class|class
name|CloseDatabaseAction
extends|extends
name|MnemonicAwareAction
block|{
DECL|method|CloseDatabaseAction ()
specifier|public
name|CloseDatabaseAction
parameter_list|()
block|{
name|super
argument_list|(
name|GUIGlobals
operator|.
name|getImage
argument_list|(
literal|"close"
argument_list|)
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|NAME
argument_list|,
literal|"Close database"
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|SHORT_DESCRIPTION
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Close the current database"
argument_list|)
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|ACCELERATOR_KEY
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Close database"
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
DECL|method|actionPerformed (ActionEvent e)
specifier|public
name|void
name|actionPerformed
parameter_list|(
name|ActionEvent
name|e
parameter_list|)
block|{
comment|// Ask here if the user really wants to close, if the base
comment|// has not been saved since last save.
name|boolean
name|close
init|=
literal|true
decl_stmt|;
if|if
condition|(
name|basePanel
argument_list|()
operator|==
literal|null
condition|)
block|{
comment|// when it is initially empty
return|return;
comment|// nbatada nov 7
block|}
if|if
condition|(
name|basePanel
argument_list|()
operator|.
name|isBaseChanged
argument_list|()
condition|)
block|{
name|int
name|answer
init|=
name|JOptionPane
operator|.
name|showConfirmDialog
argument_list|(
name|JabRefFrame
operator|.
name|this
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Database has changed. Do you want to save before closing?"
argument_list|)
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Save before closing"
argument_list|)
argument_list|,
name|JOptionPane
operator|.
name|YES_NO_CANCEL_OPTION
argument_list|)
decl_stmt|;
if|if
condition|(
name|answer
operator|==
name|JOptionPane
operator|.
name|CANCEL_OPTION
operator|||
name|answer
operator|==
name|JOptionPane
operator|.
name|CLOSED_OPTION
condition|)
block|{
name|close
operator|=
literal|false
expr_stmt|;
comment|// The user has cancelled.
block|}
if|if
condition|(
name|answer
operator|==
name|JOptionPane
operator|.
name|YES_OPTION
condition|)
block|{
comment|// The user wants to save.
try|try
block|{
name|SaveDatabaseAction
name|saveAction
init|=
operator|new
name|SaveDatabaseAction
argument_list|(
name|basePanel
argument_list|()
argument_list|)
decl_stmt|;
name|saveAction
operator|.
name|runCommand
argument_list|()
expr_stmt|;
if|if
condition|(
name|saveAction
operator|.
name|isCancelled
argument_list|()
operator|||
operator|!
name|saveAction
operator|.
name|isSuccess
argument_list|()
condition|)
block|{
comment|// The action either not cancelled or unsuccessful.
comment|// Break!
name|close
operator|=
literal|false
expr_stmt|;
block|}
block|}
catch|catch
parameter_list|(
name|Throwable
name|ex
parameter_list|)
block|{
comment|// Something prevented the file
comment|// from being saved. Break!!!
name|close
operator|=
literal|false
expr_stmt|;
block|}
block|}
block|}
if|if
condition|(
name|close
condition|)
block|{
name|close
argument_list|()
expr_stmt|;
block|}
block|}
DECL|method|close ()
specifier|public
name|void
name|close
parameter_list|()
block|{
name|BasePanel
name|pan
init|=
name|basePanel
argument_list|()
decl_stmt|;
name|pan
operator|.
name|cleanUp
argument_list|()
expr_stmt|;
name|AutoSaveManager
operator|.
name|deleteAutoSaveFile
argument_list|(
name|pan
argument_list|)
expr_stmt|;
comment|// Delete autosave
name|tabbedPane
operator|.
name|remove
argument_list|(
name|pan
argument_list|)
expr_stmt|;
if|if
condition|(
name|tabbedPane
operator|.
name|getTabCount
argument_list|()
operator|>
literal|0
condition|)
block|{
name|markActiveBasePanel
argument_list|()
expr_stmt|;
block|}
name|setWindowTitle
argument_list|()
expr_stmt|;
name|updateEnabledState
argument_list|()
expr_stmt|;
comment|// Man, this is what I call a bug that this is not called.
name|output
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Closed database"
argument_list|)
operator|+
literal|'.'
argument_list|)
expr_stmt|;
name|System
operator|.
name|gc
argument_list|()
expr_stmt|;
comment|// Test
block|}
block|}
comment|// The action concerned with opening a new database.
DECL|class|NewDatabaseAction
class|class
name|NewDatabaseAction
extends|extends
name|MnemonicAwareAction
block|{
DECL|method|NewDatabaseAction ()
specifier|public
name|NewDatabaseAction
parameter_list|()
block|{
name|super
argument_list|(
name|GUIGlobals
operator|.
name|getImage
argument_list|(
literal|"new"
argument_list|)
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|NAME
argument_list|,
literal|"New database"
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|SHORT_DESCRIPTION
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"New BibTeX database"
argument_list|)
argument_list|)
expr_stmt|;
comment|//putValue(MNEMONIC_KEY, GUIGlobals.newKeyCode);
block|}
annotation|@
name|Override
DECL|method|actionPerformed (ActionEvent e)
specifier|public
name|void
name|actionPerformed
parameter_list|(
name|ActionEvent
name|e
parameter_list|)
block|{
comment|// Create a new, empty, database.
name|BibtexDatabase
name|database
init|=
operator|new
name|BibtexDatabase
argument_list|()
decl_stmt|;
name|addTab
argument_list|(
name|database
argument_list|,
literal|null
argument_list|,
operator|new
name|MetaData
argument_list|()
argument_list|,
name|Globals
operator|.
name|prefs
operator|.
name|get
argument_list|(
name|JabRefPreferences
operator|.
name|DEFAULT_ENCODING
argument_list|)
argument_list|,
literal|true
argument_list|)
expr_stmt|;
name|output
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"New database created."
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
comment|// The action concerned with generate a new (sub-)database from latex aux file.
DECL|class|NewSubDatabaseAction
class|class
name|NewSubDatabaseAction
extends|extends
name|MnemonicAwareAction
block|{
DECL|method|NewSubDatabaseAction ()
specifier|public
name|NewSubDatabaseAction
parameter_list|()
block|{
name|super
argument_list|(
name|GUIGlobals
operator|.
name|getImage
argument_list|(
literal|"new"
argument_list|)
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|NAME
argument_list|,
literal|"New subdatabase based on AUX file"
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|SHORT_DESCRIPTION
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"New BibTeX subdatabase"
argument_list|)
argument_list|)
expr_stmt|;
comment|//putValue(MNEMONIC_KEY, GUIGlobals.newKeyCode);
block|}
annotation|@
name|Override
DECL|method|actionPerformed (ActionEvent e)
specifier|public
name|void
name|actionPerformed
parameter_list|(
name|ActionEvent
name|e
parameter_list|)
block|{
comment|// Create a new, empty, database.
name|FromAuxDialog
name|dialog
init|=
operator|new
name|FromAuxDialog
argument_list|(
name|JabRefFrame
operator|.
name|this
argument_list|,
literal|""
argument_list|,
literal|true
argument_list|,
name|JabRefFrame
operator|.
name|this
operator|.
name|tabbedPane
argument_list|)
decl_stmt|;
name|Util
operator|.
name|placeDialog
argument_list|(
name|dialog
argument_list|,
name|JabRefFrame
operator|.
name|this
argument_list|)
expr_stmt|;
name|dialog
operator|.
name|setVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
if|if
condition|(
name|dialog
operator|.
name|generatePressed
argument_list|()
condition|)
block|{
name|BasePanel
name|bp
init|=
operator|new
name|BasePanel
argument_list|(
name|JabRefFrame
operator|.
name|this
argument_list|,
name|dialog
operator|.
name|getGenerateDB
argument_list|()
argument_list|,
comment|// database
literal|null
argument_list|,
comment|// file
operator|new
name|MetaData
argument_list|()
argument_list|,
name|Globals
operator|.
name|prefs
operator|.
name|get
argument_list|(
name|JabRefPreferences
operator|.
name|DEFAULT_ENCODING
argument_list|)
argument_list|)
decl_stmt|;
comment|// meta data
name|tabbedPane
operator|.
name|add
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
name|GUIGlobals
operator|.
name|untitledTitle
argument_list|)
argument_list|,
name|bp
argument_list|)
expr_stmt|;
name|tabbedPane
operator|.
name|setSelectedComponent
argument_list|(
name|bp
argument_list|)
expr_stmt|;
name|output
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"New database created."
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
block|}
comment|// The action should test the database and report errors/warnings
DECL|class|IntegrityCheckAction
class|class
name|IntegrityCheckAction
extends|extends
name|AbstractAction
block|{
DECL|method|IntegrityCheckAction ()
specifier|public
name|IntegrityCheckAction
parameter_list|()
block|{
name|super
argument_list|(
name|Localization
operator|.
name|menuTitle
argument_list|(
literal|"Integrity check"
argument_list|)
argument_list|,
name|GUIGlobals
operator|.
name|getImage
argument_list|(
literal|"integrityCheck"
argument_list|)
argument_list|)
expr_stmt|;
comment|//putValue( SHORT_DESCRIPTION, "integrity" ) ;  //Globals.lang( "integrity" ) ) ;
comment|//putValue(MNEMONIC_KEY, GUIGlobals.newKeyCode);
block|}
annotation|@
name|Override
DECL|method|actionPerformed (ActionEvent e)
specifier|public
name|void
name|actionPerformed
parameter_list|(
name|ActionEvent
name|e
parameter_list|)
block|{
name|Object
name|selComp
init|=
name|tabbedPane
operator|.
name|getSelectedComponent
argument_list|()
decl_stmt|;
if|if
condition|(
name|selComp
operator|!=
literal|null
condition|)
block|{
name|BasePanel
name|bp
init|=
operator|(
name|BasePanel
operator|)
name|selComp
decl_stmt|;
name|BibtexDatabase
name|refBase
init|=
name|bp
operator|.
name|getDatabase
argument_list|()
decl_stmt|;
if|if
condition|(
name|refBase
operator|!=
literal|null
condition|)
block|{
name|IntegrityWizard
name|wizard
init|=
operator|new
name|IntegrityWizard
argument_list|(
name|JabRefFrame
operator|.
name|this
argument_list|,
name|basePanel
argument_list|()
argument_list|)
decl_stmt|;
name|Util
operator|.
name|placeDialog
argument_list|(
name|wizard
argument_list|,
name|JabRefFrame
operator|.
name|this
argument_list|)
expr_stmt|;
name|wizard
operator|.
name|setVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
block|}
block|}
block|}
block|}
comment|// The action for opening the preferences dialog.
DECL|field|showPrefs
specifier|private
specifier|final
name|AbstractAction
name|showPrefs
init|=
operator|new
name|ShowPrefsAction
argument_list|()
decl_stmt|;
DECL|class|ShowPrefsAction
class|class
name|ShowPrefsAction
extends|extends
name|MnemonicAwareAction
block|{
DECL|method|ShowPrefsAction ()
specifier|public
name|ShowPrefsAction
parameter_list|()
block|{
name|super
argument_list|(
name|GUIGlobals
operator|.
name|getImage
argument_list|(
literal|"preferences"
argument_list|)
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|NAME
argument_list|,
literal|"Preferences"
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|SHORT_DESCRIPTION
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Preferences"
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
DECL|method|actionPerformed (ActionEvent e)
specifier|public
name|void
name|actionPerformed
parameter_list|(
name|ActionEvent
name|e
parameter_list|)
block|{
name|preferences
argument_list|()
expr_stmt|;
block|}
block|}
comment|/**      * This method does the job of adding imported entries into the active      * database, or into a new one. It shows the ImportInspectionDialog if      * preferences indicate it should be used. Otherwise it imports directly.      *       * @param panel      *            The BasePanel to add to.      * @param entries      *            The entries to add.      * @param filename      *            Name of the file where the import came from.      * @param openInNew      *            Should the entries be imported into a new database?      */
DECL|method|addImportedEntries (final BasePanel panel, final List<BibtexEntry> entries, String filename, final boolean openInNew)
specifier|private
name|void
name|addImportedEntries
parameter_list|(
specifier|final
name|BasePanel
name|panel
parameter_list|,
specifier|final
name|List
argument_list|<
name|BibtexEntry
argument_list|>
name|entries
parameter_list|,
name|String
name|filename
parameter_list|,
specifier|final
name|boolean
name|openInNew
parameter_list|)
block|{
comment|/*          * Use the import inspection dialog if it is enabled in preferences, and          * (there are more than one entry or the inspection dialog is also          * enabled for single entries):          */
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|USE_IMPORT_INSPECTION_DIALOG
argument_list|)
operator|&&
operator|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|USE_IMPORT_INSPECTION_DIALOG_FOR_SINGLE
argument_list|)
operator|||
name|entries
operator|.
name|size
argument_list|()
operator|>
literal|1
operator|)
condition|)
block|{
name|SwingUtilities
operator|.
name|invokeLater
argument_list|(
operator|new
name|Runnable
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|run
parameter_list|()
block|{
name|ImportInspectionDialog
name|diag
init|=
operator|new
name|ImportInspectionDialog
argument_list|(
name|JabRefFrame
operator|.
name|this
argument_list|,
name|panel
argument_list|,
name|BibtexFields
operator|.
name|DEFAULT_INSPECTION_FIELDS
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Import"
argument_list|)
argument_list|,
name|openInNew
argument_list|)
decl_stmt|;
name|diag
operator|.
name|addEntries
argument_list|(
name|entries
argument_list|)
expr_stmt|;
name|diag
operator|.
name|entryListComplete
argument_list|()
expr_stmt|;
comment|// On the one hand, the following statement could help at issues when JabRef is minimized to the systray
comment|// On the other hand, users might dislake modality and this is not required to let the GUI work.
comment|// Therefore, it is disabled.
comment|// diag.setModal(true);
name|Util
operator|.
name|placeDialog
argument_list|(
name|diag
argument_list|,
name|JabRefFrame
operator|.
name|this
argument_list|)
expr_stmt|;
name|diag
operator|.
name|setVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|diag
operator|.
name|toFront
argument_list|()
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|JabRefFrame
operator|.
name|this
operator|.
name|addBibEntries
argument_list|(
name|entries
argument_list|,
name|filename
argument_list|,
name|openInNew
argument_list|)
expr_stmt|;
if|if
condition|(
name|panel
operator|!=
literal|null
operator|&&
name|entries
operator|.
name|size
argument_list|()
operator|==
literal|1
condition|)
block|{
name|SwingUtilities
operator|.
name|invokeLater
argument_list|(
operator|new
name|Runnable
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|run
parameter_list|()
block|{
name|panel
operator|.
name|highlightEntry
argument_list|(
name|entries
operator|.
name|get
argument_list|(
literal|0
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
block|}
block|}
block|}
comment|/**      * Adds the entries to the database, possibly checking for duplicates first.      * @param filename If non-null, a message is printed to the status line describing      * how many entries were imported, and from which file. If null, the message will not      * be printed.      * @param intoNew Determines if the entries will be put in a new database or in the current      * one.      */
DECL|method|addBibEntries (List<BibtexEntry> bibentries, String filename, boolean intoNew)
specifier|private
name|int
name|addBibEntries
parameter_list|(
name|List
argument_list|<
name|BibtexEntry
argument_list|>
name|bibentries
parameter_list|,
name|String
name|filename
parameter_list|,
name|boolean
name|intoNew
parameter_list|)
block|{
if|if
condition|(
name|bibentries
operator|==
literal|null
operator|||
name|bibentries
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
comment|// No entries found. We need a message for this.
name|JOptionPane
operator|.
name|showMessageDialog
argument_list|(
name|JabRefFrame
operator|.
name|this
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"No entries found. Please make sure you are "
operator|+
literal|"using the correct import filter."
argument_list|)
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Import failed"
argument_list|)
argument_list|,
name|JOptionPane
operator|.
name|ERROR_MESSAGE
argument_list|)
expr_stmt|;
return|return
literal|0
return|;
block|}
name|int
name|addedEntries
init|=
literal|0
decl_stmt|;
comment|// Set owner and timestamp fields:
name|Util
operator|.
name|setAutomaticFields
argument_list|(
name|bibentries
argument_list|,
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|OVERWRITE_OWNER
argument_list|)
argument_list|,
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|OVERWRITE_TIME_STAMP
argument_list|)
argument_list|,
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|MARK_IMPORTED_ENTRIES
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|intoNew
operator|||
name|tabbedPane
operator|.
name|getTabCount
argument_list|()
operator|==
literal|0
condition|)
block|{
comment|// Import into new database.
name|BibtexDatabase
name|database
init|=
operator|new
name|BibtexDatabase
argument_list|()
decl_stmt|;
for|for
control|(
name|BibtexEntry
name|entry
range|:
name|bibentries
control|)
block|{
try|try
block|{
name|entry
operator|.
name|setId
argument_list|(
name|IdGenerator
operator|.
name|next
argument_list|()
argument_list|)
expr_stmt|;
name|database
operator|.
name|insertEntry
argument_list|(
name|entry
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|KeyCollisionException
name|ex
parameter_list|)
block|{
comment|//ignore
name|System
operator|.
name|err
operator|.
name|println
argument_list|(
literal|"KeyCollisionException [ addBibEntries(...) ]"
argument_list|)
expr_stmt|;
block|}
block|}
comment|// Metadata are only put in bibtex files, so we will not find it
comment|// in imported files. We therefore pass in an empty MetaData:
name|BasePanel
name|bp
init|=
operator|new
name|BasePanel
argument_list|(
name|JabRefFrame
operator|.
name|this
argument_list|,
name|database
argument_list|,
literal|null
argument_list|,
operator|new
name|MetaData
argument_list|()
argument_list|,
name|Globals
operator|.
name|prefs
operator|.
name|get
argument_list|(
name|JabRefPreferences
operator|.
name|DEFAULT_ENCODING
argument_list|)
argument_list|)
decl_stmt|;
comment|/*                   if (prefs.getBoolean("autoComplete")) {                   db.setCompleters(autoCompleters);                   }              */
name|addedEntries
operator|=
name|database
operator|.
name|getEntryCount
argument_list|()
expr_stmt|;
name|tabbedPane
operator|.
name|add
argument_list|(
name|GUIGlobals
operator|.
name|untitledTitle
argument_list|,
name|bp
argument_list|)
expr_stmt|;
name|bp
operator|.
name|markBaseChanged
argument_list|()
expr_stmt|;
name|tabbedPane
operator|.
name|setSelectedComponent
argument_list|(
name|bp
argument_list|)
expr_stmt|;
if|if
condition|(
name|filename
operator|!=
literal|null
condition|)
block|{
name|output
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Imported database"
argument_list|)
operator|+
literal|" '"
operator|+
name|filename
operator|+
literal|"' "
operator|+
name|Localization
operator|.
name|lang
argument_list|(
literal|"with"
argument_list|)
operator|+
literal|' '
operator|+
name|database
operator|.
name|getEntryCount
argument_list|()
operator|+
literal|' '
operator|+
name|Localization
operator|.
name|lang
argument_list|(
literal|"entries into new database"
argument_list|)
operator|+
literal|'.'
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
comment|// Import into current database.
name|BasePanel
name|basePanel
init|=
name|basePanel
argument_list|()
decl_stmt|;
name|BibtexDatabase
name|database
init|=
name|basePanel
operator|.
name|database
decl_stmt|;
name|int
name|oldCount
init|=
name|database
operator|.
name|getEntryCount
argument_list|()
decl_stmt|;
name|NamedCompound
name|ce
init|=
operator|new
name|NamedCompound
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Import entries"
argument_list|)
argument_list|)
decl_stmt|;
name|mainLoop
label|:
for|for
control|(
name|BibtexEntry
name|entry
range|:
name|bibentries
control|)
block|{
name|boolean
name|dupli
init|=
literal|false
decl_stmt|;
comment|// Check for duplicates among the current entries:
for|for
control|(
name|String
name|s
range|:
name|database
operator|.
name|getKeySet
argument_list|()
control|)
block|{
name|BibtexEntry
name|existingEntry
init|=
name|database
operator|.
name|getEntryById
argument_list|(
name|s
argument_list|)
decl_stmt|;
if|if
condition|(
name|DuplicateCheck
operator|.
name|isDuplicate
argument_list|(
name|entry
argument_list|,
name|existingEntry
argument_list|)
condition|)
block|{
name|DuplicateResolverDialog
name|drd
init|=
operator|new
name|DuplicateResolverDialog
argument_list|(
name|JabRefFrame
operator|.
name|this
argument_list|,
name|existingEntry
argument_list|,
name|entry
argument_list|,
name|DuplicateResolverDialog
operator|.
name|IMPORT_CHECK
argument_list|)
decl_stmt|;
name|drd
operator|.
name|setVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|int
name|res
init|=
name|drd
operator|.
name|getSelected
argument_list|()
decl_stmt|;
if|if
condition|(
name|res
operator|==
name|DuplicateResolverDialog
operator|.
name|KEEP_LOWER
condition|)
block|{
name|dupli
operator|=
literal|true
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|res
operator|==
name|DuplicateResolverDialog
operator|.
name|KEEP_UPPER
condition|)
block|{
name|database
operator|.
name|removeEntry
argument_list|(
name|existingEntry
operator|.
name|getId
argument_list|()
argument_list|)
expr_stmt|;
name|ce
operator|.
name|addEdit
argument_list|(
operator|new
name|UndoableRemoveEntry
argument_list|(
name|database
argument_list|,
name|existingEntry
argument_list|,
name|basePanel
argument_list|)
argument_list|)
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|res
operator|==
name|DuplicateResolverDialog
operator|.
name|BREAK
condition|)
block|{
break|break
name|mainLoop
break|;
block|}
break|break;
block|}
block|}
if|if
condition|(
operator|!
name|dupli
condition|)
block|{
try|try
block|{
name|entry
operator|.
name|setId
argument_list|(
name|IdGenerator
operator|.
name|next
argument_list|()
argument_list|)
expr_stmt|;
name|database
operator|.
name|insertEntry
argument_list|(
name|entry
argument_list|)
expr_stmt|;
name|ce
operator|.
name|addEdit
argument_list|(
operator|new
name|UndoableInsertEntry
argument_list|(
name|database
argument_list|,
name|entry
argument_list|,
name|basePanel
argument_list|)
argument_list|)
expr_stmt|;
name|addedEntries
operator|++
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|KeyCollisionException
name|ex
parameter_list|)
block|{
comment|//ignore
name|System
operator|.
name|err
operator|.
name|println
argument_list|(
literal|"KeyCollisionException [ addBibEntries(...) ]"
argument_list|)
expr_stmt|;
block|}
block|}
block|}
if|if
condition|(
name|addedEntries
operator|>
literal|0
condition|)
block|{
name|ce
operator|.
name|end
argument_list|()
expr_stmt|;
name|basePanel
operator|.
name|undoManager
operator|.
name|addEdit
argument_list|(
name|ce
argument_list|)
expr_stmt|;
name|basePanel
operator|.
name|markBaseChanged
argument_list|()
expr_stmt|;
if|if
condition|(
name|filename
operator|!=
literal|null
condition|)
block|{
name|output
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Imported database"
argument_list|)
operator|+
literal|" '"
operator|+
name|filename
operator|+
literal|"' "
operator|+
name|Localization
operator|.
name|lang
argument_list|(
literal|"with"
argument_list|)
operator|+
literal|' '
operator|+
operator|(
name|database
operator|.
name|getEntryCount
argument_list|()
operator|-
name|oldCount
operator|)
operator|+
literal|' '
operator|+
name|Localization
operator|.
name|lang
argument_list|(
literal|"entries into new database"
argument_list|)
operator|+
literal|'.'
argument_list|)
expr_stmt|;
block|}
block|}
block|}
return|return
name|addedEntries
return|;
block|}
DECL|method|setUpImportMenu (JMenu importMenu, boolean intoNew_)
specifier|private
name|void
name|setUpImportMenu
parameter_list|(
name|JMenu
name|importMenu
parameter_list|,
name|boolean
name|intoNew_
parameter_list|)
block|{
name|importMenu
operator|.
name|removeAll
argument_list|()
expr_stmt|;
comment|// Add a menu item for autodetecting import format:
name|importMenu
operator|.
name|add
argument_list|(
operator|new
name|ImportMenuItem
argument_list|(
name|JabRefFrame
operator|.
name|this
argument_list|,
name|intoNew_
argument_list|)
argument_list|)
expr_stmt|;
comment|// Add custom importers
name|importMenu
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
name|SortedSet
argument_list|<
name|ImportFormat
argument_list|>
name|customImporters
init|=
name|Globals
operator|.
name|importFormatReader
operator|.
name|getCustomImportFormats
argument_list|()
decl_stmt|;
name|JMenu
name|submenu
init|=
operator|new
name|JMenu
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Custom importers"
argument_list|)
argument_list|)
decl_stmt|;
name|submenu
operator|.
name|setMnemonic
argument_list|(
name|KeyEvent
operator|.
name|VK_S
argument_list|)
expr_stmt|;
comment|// Put in all formatters registered in ImportFormatReader:
for|for
control|(
name|ImportFormat
name|imFo
range|:
name|customImporters
control|)
block|{
name|submenu
operator|.
name|add
argument_list|(
operator|new
name|ImportMenuItem
argument_list|(
name|JabRefFrame
operator|.
name|this
argument_list|,
name|intoNew_
argument_list|,
name|imFo
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|!
name|customImporters
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|submenu
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
block|}
name|submenu
operator|.
name|add
argument_list|(
name|customImpAction
argument_list|)
expr_stmt|;
name|importMenu
operator|.
name|add
argument_list|(
name|submenu
argument_list|)
expr_stmt|;
name|importMenu
operator|.
name|addSeparator
argument_list|()
expr_stmt|;
comment|// Put in all formatters registered in ImportFormatReader:
for|for
control|(
name|ImportFormat
name|imFo
range|:
name|Globals
operator|.
name|importFormatReader
operator|.
name|getBuiltInInputFormats
argument_list|()
control|)
block|{
name|importMenu
operator|.
name|add
argument_list|(
operator|new
name|ImportMenuItem
argument_list|(
name|JabRefFrame
operator|.
name|this
argument_list|,
name|intoNew_
argument_list|,
name|imFo
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
DECL|method|getFileHistory ()
specifier|public
name|FileHistory
name|getFileHistory
parameter_list|()
block|{
return|return
name|fileHistory
return|;
block|}
comment|/**      * Set the preview active state for all BasePanel instances.      * @param enabled      */
DECL|method|setPreviewActive (boolean enabled)
specifier|public
name|void
name|setPreviewActive
parameter_list|(
name|boolean
name|enabled
parameter_list|)
block|{
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|tabbedPane
operator|.
name|getTabCount
argument_list|()
condition|;
name|i
operator|++
control|)
block|{
name|baseAt
argument_list|(
name|i
argument_list|)
operator|.
name|setPreviewActive
argument_list|(
name|enabled
argument_list|)
expr_stmt|;
block|}
block|}
DECL|method|removeCachedEntryEditors ()
specifier|public
name|void
name|removeCachedEntryEditors
parameter_list|()
block|{
for|for
control|(
name|int
name|j
init|=
literal|0
init|;
name|j
operator|<
name|tabbedPane
operator|.
name|getTabCount
argument_list|()
condition|;
name|j
operator|++
control|)
block|{
name|BasePanel
name|bp
init|=
operator|(
name|BasePanel
operator|)
name|tabbedPane
operator|.
name|getComponentAt
argument_list|(
name|j
argument_list|)
decl_stmt|;
name|bp
operator|.
name|entryEditors
operator|.
name|clear
argument_list|()
expr_stmt|;
block|}
block|}
comment|/**      * This method shows a wait cursor and blocks all input to the JFrame's contents.      */
DECL|method|block ()
specifier|public
name|void
name|block
parameter_list|()
block|{
name|getGlassPane
argument_list|()
operator|.
name|setVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
block|}
comment|/**      * This method reverts the cursor to normal, and stops blocking input to the JFrame's contents.      * There are no adverse effects of calling this method redundantly.      */
DECL|method|unblock ()
specifier|public
name|void
name|unblock
parameter_list|()
block|{
name|getGlassPane
argument_list|()
operator|.
name|setVisible
argument_list|(
literal|false
argument_list|)
expr_stmt|;
block|}
comment|/** Set the visibility of the progress bar in the right end of the      * status line at the bottom of the frame.      *      * If not called on the event dispatch thread, this method uses      * SwingUtilities.invokeLater() to do the actual operation on the EDT.      */
DECL|method|setProgressBarVisible (final boolean visible)
specifier|public
name|void
name|setProgressBarVisible
parameter_list|(
specifier|final
name|boolean
name|visible
parameter_list|)
block|{
if|if
condition|(
name|SwingUtilities
operator|.
name|isEventDispatchThread
argument_list|()
condition|)
block|{
name|progressBar
operator|.
name|setVisible
argument_list|(
name|visible
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|SwingUtilities
operator|.
name|invokeLater
argument_list|(
operator|new
name|Runnable
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|run
parameter_list|()
block|{
name|progressBar
operator|.
name|setVisible
argument_list|(
name|visible
argument_list|)
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
block|}
block|}
comment|/**      * Sets the current value of the progress bar.      *      * If not called on the event dispatch thread, this method uses      * SwingUtilities.invokeLater() to do the actual operation on the EDT.      */
DECL|method|setProgressBarValue (final int value)
specifier|public
name|void
name|setProgressBarValue
parameter_list|(
specifier|final
name|int
name|value
parameter_list|)
block|{
if|if
condition|(
name|SwingUtilities
operator|.
name|isEventDispatchThread
argument_list|()
condition|)
block|{
name|progressBar
operator|.
name|setValue
argument_list|(
name|value
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|SwingUtilities
operator|.
name|invokeLater
argument_list|(
operator|new
name|Runnable
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|run
parameter_list|()
block|{
name|progressBar
operator|.
name|setValue
argument_list|(
name|value
argument_list|)
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
block|}
block|}
comment|/**      * Sets the indeterminate status of the progress bar.      *      * If not called on the event dispatch thread, this method uses      * SwingUtilities.invokeLater() to do the actual operation on the EDT.      */
DECL|method|setProgressBarIndeterminate (final boolean value)
specifier|public
name|void
name|setProgressBarIndeterminate
parameter_list|(
specifier|final
name|boolean
name|value
parameter_list|)
block|{
if|if
condition|(
name|SwingUtilities
operator|.
name|isEventDispatchThread
argument_list|()
condition|)
block|{
name|progressBar
operator|.
name|setIndeterminate
argument_list|(
name|value
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|SwingUtilities
operator|.
name|invokeLater
argument_list|(
operator|new
name|Runnable
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|run
parameter_list|()
block|{
name|progressBar
operator|.
name|setIndeterminate
argument_list|(
name|value
argument_list|)
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
block|}
block|}
comment|/**      * Sets the maximum value of the progress bar. Always call this method      * before using the progress bar, to set a maximum value appropriate to      * the task at hand.      *      * If not called on the event dispatch thread, this method uses      * SwingUtilities.invokeLater() to do the actual operation on the EDT.      */
DECL|method|setProgressBarMaximum (final int value)
specifier|public
name|void
name|setProgressBarMaximum
parameter_list|(
specifier|final
name|int
name|value
parameter_list|)
block|{
if|if
condition|(
name|SwingUtilities
operator|.
name|isEventDispatchThread
argument_list|()
condition|)
block|{
name|progressBar
operator|.
name|setMaximum
argument_list|(
name|value
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|SwingUtilities
operator|.
name|invokeLater
argument_list|(
operator|new
name|Runnable
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|run
parameter_list|()
block|{
name|progressBar
operator|.
name|setMaximum
argument_list|(
name|value
argument_list|)
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
block|}
block|}
DECL|class|SaveSessionAction
class|class
name|SaveSessionAction
extends|extends
name|MnemonicAwareAction
block|{
DECL|method|SaveSessionAction ()
specifier|public
name|SaveSessionAction
parameter_list|()
block|{
name|super
argument_list|(
name|GUIGlobals
operator|.
name|getImage
argument_list|(
literal|"save"
argument_list|)
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|NAME
argument_list|,
literal|"Save session"
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|ACCELERATOR_KEY
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Save session"
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
DECL|method|actionPerformed (ActionEvent e)
specifier|public
name|void
name|actionPerformed
parameter_list|(
name|ActionEvent
name|e
parameter_list|)
block|{
comment|// Here we store the names of all current files. If
comment|// there is no current file, we remove any
comment|// previously stored file name.
name|Vector
argument_list|<
name|String
argument_list|>
name|filenames
init|=
operator|new
name|Vector
argument_list|<
name|String
argument_list|>
argument_list|()
decl_stmt|;
if|if
condition|(
name|tabbedPane
operator|.
name|getTabCount
argument_list|()
operator|>
literal|0
condition|)
block|{
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|tabbedPane
operator|.
name|getTabCount
argument_list|()
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|tabbedPane
operator|.
name|getTitleAt
argument_list|(
name|i
argument_list|)
operator|.
name|equals
argument_list|(
name|GUIGlobals
operator|.
name|untitledTitle
argument_list|)
condition|)
block|{
name|tabbedPane
operator|.
name|setSelectedIndex
argument_list|(
name|i
argument_list|)
expr_stmt|;
name|int
name|answer
init|=
name|JOptionPane
operator|.
name|showConfirmDialog
argument_list|(
name|JabRefFrame
operator|.
name|this
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"This untitled database must be saved first to be "
operator|+
literal|"included in the saved session. Save now?"
argument_list|)
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Save database"
argument_list|)
argument_list|,
name|JOptionPane
operator|.
name|YES_NO_OPTION
argument_list|)
decl_stmt|;
if|if
condition|(
name|answer
operator|==
name|JOptionPane
operator|.
name|YES_OPTION
condition|)
block|{
comment|// The user wants to save.
try|try
block|{
name|basePanel
argument_list|()
operator|.
name|runCommand
argument_list|(
literal|"save"
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|Throwable
name|ignored
parameter_list|)
block|{                             }
block|}
block|}
if|if
condition|(
name|baseAt
argument_list|(
name|i
argument_list|)
operator|.
name|getFile
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|filenames
operator|.
name|add
argument_list|(
name|baseAt
argument_list|(
name|i
argument_list|)
operator|.
name|getFile
argument_list|()
operator|.
name|getPath
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
block|}
if|if
condition|(
name|filenames
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|output
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Not saved (empty session)"
argument_list|)
operator|+
literal|'.'
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|String
index|[]
name|names
init|=
operator|new
name|String
index|[
name|filenames
operator|.
name|size
argument_list|()
index|]
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|filenames
operator|.
name|size
argument_list|()
condition|;
name|i
operator|++
control|)
block|{
name|names
index|[
name|i
index|]
operator|=
name|filenames
operator|.
name|elementAt
argument_list|(
name|i
argument_list|)
expr_stmt|;
block|}
name|prefs
operator|.
name|putStringArray
argument_list|(
literal|"savedSession"
argument_list|,
name|names
argument_list|)
expr_stmt|;
name|output
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Saved session"
argument_list|)
operator|+
literal|'.'
argument_list|)
expr_stmt|;
block|}
block|}
block|}
DECL|class|LoadSessionAction
specifier|public
class|class
name|LoadSessionAction
extends|extends
name|MnemonicAwareAction
block|{
DECL|field|running
specifier|volatile
name|boolean
name|running
decl_stmt|;
DECL|method|LoadSessionAction ()
specifier|public
name|LoadSessionAction
parameter_list|()
block|{
name|super
argument_list|(
name|GUIGlobals
operator|.
name|getImage
argument_list|(
literal|"loadSession"
argument_list|)
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|NAME
argument_list|,
literal|"Load session"
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|ACCELERATOR_KEY
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Load session"
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
DECL|method|actionPerformed (ActionEvent e)
specifier|public
name|void
name|actionPerformed
parameter_list|(
name|ActionEvent
name|e
parameter_list|)
block|{
if|if
condition|(
name|prefs
operator|.
name|get
argument_list|(
literal|"savedSession"
argument_list|)
operator|==
literal|null
condition|)
block|{
name|output
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"No saved session found."
argument_list|)
argument_list|)
expr_stmt|;
return|return;
block|}
if|if
condition|(
name|running
condition|)
block|{
return|return;
block|}
else|else
block|{
name|running
operator|=
literal|true
expr_stmt|;
block|}
name|output
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Loading session..."
argument_list|)
argument_list|)
expr_stmt|;
name|JabRefExecutorService
operator|.
name|INSTANCE
operator|.
name|execute
argument_list|(
operator|new
name|Runnable
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|run
parameter_list|()
block|{
name|HashSet
argument_list|<
name|String
argument_list|>
name|currentFiles
init|=
operator|new
name|HashSet
argument_list|<
name|String
argument_list|>
argument_list|()
decl_stmt|;
if|if
condition|(
name|tabbedPane
operator|.
name|getTabCount
argument_list|()
operator|>
literal|0
condition|)
block|{
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|tabbedPane
operator|.
name|getTabCount
argument_list|()
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
name|baseAt
argument_list|(
name|i
argument_list|)
operator|.
name|getFile
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|currentFiles
operator|.
name|add
argument_list|(
name|baseAt
argument_list|(
name|i
argument_list|)
operator|.
name|getFile
argument_list|()
operator|.
name|getPath
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
block|}
name|int
name|i0
init|=
name|tabbedPane
operator|.
name|getTabCount
argument_list|()
decl_stmt|;
name|String
index|[]
name|names
init|=
name|prefs
operator|.
name|getStringArray
argument_list|(
literal|"savedSession"
argument_list|)
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|names
operator|.
name|length
condition|;
name|i
operator|++
control|)
block|{
if|if
condition|(
operator|!
name|currentFiles
operator|.
name|contains
argument_list|(
name|names
index|[
name|i
index|]
argument_list|)
condition|)
block|{
name|File
name|file
init|=
operator|new
name|File
argument_list|(
name|names
index|[
name|i
index|]
argument_list|)
decl_stmt|;
if|if
condition|(
name|file
operator|.
name|exists
argument_list|()
condition|)
block|{
comment|//Util.pr("Opening last edited file:"
comment|//+fileToOpen.getName());
name|open
operator|.
name|openIt
argument_list|(
name|file
argument_list|,
name|i
operator|==
literal|0
argument_list|)
expr_stmt|;
block|}
block|}
block|}
name|output
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Files opened"
argument_list|)
operator|+
literal|": "
operator|+
operator|(
name|tabbedPane
operator|.
name|getTabCount
argument_list|()
operator|-
name|i0
operator|)
argument_list|)
expr_stmt|;
name|running
operator|=
literal|false
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
block|}
block|}
DECL|class|ChangeTabAction
class|class
name|ChangeTabAction
extends|extends
name|MnemonicAwareAction
block|{
DECL|field|next
specifier|private
specifier|final
name|boolean
name|next
decl_stmt|;
DECL|method|ChangeTabAction (boolean next)
specifier|public
name|ChangeTabAction
parameter_list|(
name|boolean
name|next
parameter_list|)
block|{
name|putValue
argument_list|(
name|Action
operator|.
name|NAME
argument_list|,
name|next
condition|?
literal|"Next tab"
else|:
literal|"Previous tab"
argument_list|)
expr_stmt|;
name|this
operator|.
name|next
operator|=
name|next
expr_stmt|;
comment|//Util.pr(""+prefs.getKey("Next tab"));
name|putValue
argument_list|(
name|Action
operator|.
name|ACCELERATOR_KEY
argument_list|,
name|next
condition|?
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Next tab"
argument_list|)
else|:
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Previous tab"
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
DECL|method|actionPerformed (ActionEvent e)
specifier|public
name|void
name|actionPerformed
parameter_list|(
name|ActionEvent
name|e
parameter_list|)
block|{
name|int
name|i
init|=
name|tabbedPane
operator|.
name|getSelectedIndex
argument_list|()
decl_stmt|;
name|int
name|newI
init|=
name|next
condition|?
name|i
operator|+
literal|1
else|:
name|i
operator|-
literal|1
decl_stmt|;
if|if
condition|(
name|newI
operator|<
literal|0
condition|)
block|{
name|newI
operator|=
name|tabbedPane
operator|.
name|getTabCount
argument_list|()
operator|-
literal|1
expr_stmt|;
block|}
if|if
condition|(
name|newI
operator|==
name|tabbedPane
operator|.
name|getTabCount
argument_list|()
condition|)
block|{
name|newI
operator|=
literal|0
expr_stmt|;
block|}
name|tabbedPane
operator|.
name|setSelectedIndex
argument_list|(
name|newI
argument_list|)
expr_stmt|;
block|}
block|}
comment|/**      * Class for handling general actions; cut, copy and paste. The focused component is      * kept track of by Globals.focusListener, and we call the action stored under the      * relevant name in its action map.      */
DECL|class|EditAction
class|class
name|EditAction
extends|extends
name|MnemonicAwareAction
block|{
DECL|field|command
specifier|private
specifier|final
name|String
name|command
decl_stmt|;
DECL|method|EditAction (String command, URL icon)
specifier|public
name|EditAction
parameter_list|(
name|String
name|command
parameter_list|,
name|URL
name|icon
parameter_list|)
block|{
name|super
argument_list|(
operator|new
name|ImageIcon
argument_list|(
name|icon
argument_list|)
argument_list|)
expr_stmt|;
name|this
operator|.
name|command
operator|=
name|command
expr_stmt|;
name|String
name|nName
init|=
name|StringUtil
operator|.
name|capitalizeFirst
argument_list|(
name|command
argument_list|)
decl_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|NAME
argument_list|,
name|nName
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|ACCELERATOR_KEY
argument_list|,
name|prefs
operator|.
name|getKey
argument_list|(
name|nName
argument_list|)
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|SHORT_DESCRIPTION
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
name|nName
argument_list|)
argument_list|)
expr_stmt|;
comment|//putValue(ACCELERATOR_KEY,
comment|//         (next?prefs.getKey("Next tab"):prefs.getKey("Previous tab")));
block|}
annotation|@
name|Override
DECL|method|actionPerformed (ActionEvent e)
specifier|public
name|void
name|actionPerformed
parameter_list|(
name|ActionEvent
name|e
parameter_list|)
block|{
comment|//Util.pr(Globals.focusListener.getFocused().toString());
name|JComponent
name|source
init|=
name|Globals
operator|.
name|focusListener
operator|.
name|getFocused
argument_list|()
decl_stmt|;
try|try
block|{
name|source
operator|.
name|getActionMap
argument_list|()
operator|.
name|get
argument_list|(
name|command
argument_list|)
operator|.
name|actionPerformed
argument_list|(
operator|new
name|ActionEvent
argument_list|(
name|source
argument_list|,
literal|0
argument_list|,
name|command
argument_list|)
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|NullPointerException
name|ex
parameter_list|)
block|{
comment|// No component is focused, so we do nothing.
block|}
block|}
block|}
DECL|class|CustomizeExportsAction
class|class
name|CustomizeExportsAction
extends|extends
name|MnemonicAwareAction
block|{
DECL|method|CustomizeExportsAction ()
specifier|public
name|CustomizeExportsAction
parameter_list|()
block|{
name|putValue
argument_list|(
name|Action
operator|.
name|NAME
argument_list|,
literal|"Manage custom exports"
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
DECL|method|actionPerformed (ActionEvent e)
specifier|public
name|void
name|actionPerformed
parameter_list|(
name|ActionEvent
name|e
parameter_list|)
block|{
name|ExportCustomizationDialog
name|ecd
init|=
operator|new
name|ExportCustomizationDialog
argument_list|(
name|JabRefFrame
operator|.
name|this
argument_list|)
decl_stmt|;
name|ecd
operator|.
name|setVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
block|}
block|}
DECL|class|CustomizeImportsAction
class|class
name|CustomizeImportsAction
extends|extends
name|MnemonicAwareAction
block|{
DECL|method|CustomizeImportsAction ()
specifier|public
name|CustomizeImportsAction
parameter_list|()
block|{
name|putValue
argument_list|(
name|Action
operator|.
name|NAME
argument_list|,
literal|"Manage custom imports"
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
DECL|method|actionPerformed (ActionEvent e)
specifier|public
name|void
name|actionPerformed
parameter_list|(
name|ActionEvent
name|e
parameter_list|)
block|{
name|ImportCustomizationDialog
name|ecd
init|=
operator|new
name|ImportCustomizationDialog
argument_list|(
name|JabRefFrame
operator|.
name|this
argument_list|)
decl_stmt|;
name|ecd
operator|.
name|setVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
block|}
block|}
DECL|class|CustomizeEntryTypeAction
class|class
name|CustomizeEntryTypeAction
extends|extends
name|MnemonicAwareAction
block|{
DECL|method|CustomizeEntryTypeAction ()
specifier|public
name|CustomizeEntryTypeAction
parameter_list|()
block|{
name|putValue
argument_list|(
name|Action
operator|.
name|NAME
argument_list|,
literal|"Customize entry types"
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
DECL|method|actionPerformed (ActionEvent e)
specifier|public
name|void
name|actionPerformed
parameter_list|(
name|ActionEvent
name|e
parameter_list|)
block|{
name|JDialog
name|dl
init|=
operator|new
name|EntryCustomizationDialog2
argument_list|(
name|JabRefFrame
operator|.
name|this
argument_list|)
decl_stmt|;
name|Util
operator|.
name|placeDialog
argument_list|(
name|dl
argument_list|,
name|JabRefFrame
operator|.
name|this
argument_list|)
expr_stmt|;
name|dl
operator|.
name|setVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
block|}
block|}
DECL|class|GenFieldsCustomizationAction
class|class
name|GenFieldsCustomizationAction
extends|extends
name|MnemonicAwareAction
block|{
DECL|method|GenFieldsCustomizationAction ()
specifier|public
name|GenFieldsCustomizationAction
parameter_list|()
block|{
name|putValue
argument_list|(
name|Action
operator|.
name|NAME
argument_list|,
literal|"Set up general fields"
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
DECL|method|actionPerformed (ActionEvent e)
specifier|public
name|void
name|actionPerformed
parameter_list|(
name|ActionEvent
name|e
parameter_list|)
block|{
name|GenFieldsCustomizer
name|gf
init|=
operator|new
name|GenFieldsCustomizer
argument_list|(
name|JabRefFrame
operator|.
name|this
argument_list|)
decl_stmt|;
name|Util
operator|.
name|placeDialog
argument_list|(
name|gf
argument_list|,
name|JabRefFrame
operator|.
name|this
argument_list|)
expr_stmt|;
name|gf
operator|.
name|setVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
block|}
block|}
DECL|class|DatabasePropertiesAction
class|class
name|DatabasePropertiesAction
extends|extends
name|MnemonicAwareAction
block|{
DECL|field|propertiesDialog
name|DatabasePropertiesDialog
name|propertiesDialog
decl_stmt|;
DECL|method|DatabasePropertiesAction ()
specifier|public
name|DatabasePropertiesAction
parameter_list|()
block|{
name|putValue
argument_list|(
name|Action
operator|.
name|NAME
argument_list|,
literal|"Database properties"
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
DECL|method|actionPerformed (ActionEvent e)
specifier|public
name|void
name|actionPerformed
parameter_list|(
name|ActionEvent
name|e
parameter_list|)
block|{
if|if
condition|(
name|propertiesDialog
operator|==
literal|null
condition|)
block|{
name|propertiesDialog
operator|=
operator|new
name|DatabasePropertiesDialog
argument_list|(
name|JabRefFrame
operator|.
name|this
argument_list|)
expr_stmt|;
block|}
name|propertiesDialog
operator|.
name|setPanel
argument_list|(
name|basePanel
argument_list|()
argument_list|)
expr_stmt|;
name|Util
operator|.
name|placeDialog
argument_list|(
name|propertiesDialog
argument_list|,
name|JabRefFrame
operator|.
name|this
argument_list|)
expr_stmt|;
name|propertiesDialog
operator|.
name|setVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
block|}
block|}
DECL|class|BibtexKeyPatternAction
class|class
name|BibtexKeyPatternAction
extends|extends
name|MnemonicAwareAction
block|{
DECL|field|bibtexKeyPatternDialog
name|BibtexKeyPatternDialog
name|bibtexKeyPatternDialog
decl_stmt|;
DECL|method|BibtexKeyPatternAction ()
specifier|public
name|BibtexKeyPatternAction
parameter_list|()
block|{
name|putValue
argument_list|(
name|Action
operator|.
name|NAME
argument_list|,
literal|"Bibtex key patterns"
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
DECL|method|actionPerformed (ActionEvent e)
specifier|public
name|void
name|actionPerformed
parameter_list|(
name|ActionEvent
name|e
parameter_list|)
block|{
name|JabRefPreferences
operator|.
name|getInstance
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtexKeyPatternDialog
operator|==
literal|null
condition|)
block|{
comment|// if no instance of BibtexKeyPatternDialog exists, create new one
name|bibtexKeyPatternDialog
operator|=
operator|new
name|BibtexKeyPatternDialog
argument_list|(
name|JabRefFrame
operator|.
name|this
argument_list|,
name|basePanel
argument_list|()
argument_list|)
expr_stmt|;
block|}
else|else
block|{
comment|// BibtexKeyPatternDialog allows for updating content based on currently selected panel
name|bibtexKeyPatternDialog
operator|.
name|setPanel
argument_list|(
name|basePanel
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|Util
operator|.
name|placeDialog
argument_list|(
name|bibtexKeyPatternDialog
argument_list|,
name|JabRefFrame
operator|.
name|this
argument_list|)
expr_stmt|;
name|bibtexKeyPatternDialog
operator|.
name|setVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
block|}
block|}
DECL|class|IncreaseTableFontSizeAction
class|class
name|IncreaseTableFontSizeAction
extends|extends
name|MnemonicAwareAction
block|{
DECL|method|IncreaseTableFontSizeAction ()
specifier|public
name|IncreaseTableFontSizeAction
parameter_list|()
block|{
name|putValue
argument_list|(
name|Action
operator|.
name|NAME
argument_list|,
literal|"Increase table font size"
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|ACCELERATOR_KEY
argument_list|,
name|Globals
operator|.
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Increase table font size"
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
DECL|method|actionPerformed (ActionEvent event)
specifier|public
name|void
name|actionPerformed
parameter_list|(
name|ActionEvent
name|event
parameter_list|)
block|{
name|int
name|currentSize
init|=
name|GUIGlobals
operator|.
name|CURRENTFONT
operator|.
name|getSize
argument_list|()
decl_stmt|;
name|GUIGlobals
operator|.
name|CURRENTFONT
operator|=
operator|new
name|Font
argument_list|(
name|GUIGlobals
operator|.
name|CURRENTFONT
operator|.
name|getFamily
argument_list|()
argument_list|,
name|GUIGlobals
operator|.
name|CURRENTFONT
operator|.
name|getStyle
argument_list|()
argument_list|,
name|currentSize
operator|+
literal|1
argument_list|)
expr_stmt|;
name|Globals
operator|.
name|prefs
operator|.
name|putInt
argument_list|(
name|JabRefPreferences
operator|.
name|FONT_SIZE
argument_list|,
name|currentSize
operator|+
literal|1
argument_list|)
expr_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|baseCount
argument_list|()
condition|;
name|i
operator|++
control|)
block|{
name|baseAt
argument_list|(
name|i
argument_list|)
operator|.
name|updateTableFont
argument_list|()
expr_stmt|;
block|}
block|}
block|}
DECL|class|DecreaseTableFontSizeAction
class|class
name|DecreaseTableFontSizeAction
extends|extends
name|MnemonicAwareAction
block|{
DECL|method|DecreaseTableFontSizeAction ()
specifier|public
name|DecreaseTableFontSizeAction
parameter_list|()
block|{
name|putValue
argument_list|(
name|Action
operator|.
name|NAME
argument_list|,
literal|"Decrease table font size"
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|ACCELERATOR_KEY
argument_list|,
name|Globals
operator|.
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Decrease table font size"
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
DECL|method|actionPerformed (ActionEvent event)
specifier|public
name|void
name|actionPerformed
parameter_list|(
name|ActionEvent
name|event
parameter_list|)
block|{
name|int
name|currentSize
init|=
name|GUIGlobals
operator|.
name|CURRENTFONT
operator|.
name|getSize
argument_list|()
decl_stmt|;
if|if
condition|(
name|currentSize
operator|<
literal|2
condition|)
block|{
return|return;
block|}
name|GUIGlobals
operator|.
name|CURRENTFONT
operator|=
operator|new
name|Font
argument_list|(
name|GUIGlobals
operator|.
name|CURRENTFONT
operator|.
name|getFamily
argument_list|()
argument_list|,
name|GUIGlobals
operator|.
name|CURRENTFONT
operator|.
name|getStyle
argument_list|()
argument_list|,
name|currentSize
operator|-
literal|1
argument_list|)
expr_stmt|;
name|Globals
operator|.
name|prefs
operator|.
name|putInt
argument_list|(
name|JabRefPreferences
operator|.
name|FONT_SIZE
argument_list|,
name|currentSize
operator|-
literal|1
argument_list|)
expr_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|baseCount
argument_list|()
condition|;
name|i
operator|++
control|)
block|{
name|baseAt
argument_list|(
name|i
argument_list|)
operator|.
name|updateTableFont
argument_list|()
expr_stmt|;
block|}
block|}
block|}
DECL|class|MinimizeToSysTrayAction
class|class
name|MinimizeToSysTrayAction
extends|extends
name|MnemonicAwareAction
block|{
DECL|method|MinimizeToSysTrayAction ()
specifier|public
name|MinimizeToSysTrayAction
parameter_list|()
block|{
name|putValue
argument_list|(
name|Action
operator|.
name|NAME
argument_list|,
literal|"Minimize to system tray"
argument_list|)
expr_stmt|;
name|putValue
argument_list|(
name|Action
operator|.
name|ACCELERATOR_KEY
argument_list|,
name|Globals
operator|.
name|prefs
operator|.
name|getKey
argument_list|(
literal|"Minimize to system tray"
argument_list|)
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
DECL|method|actionPerformed (ActionEvent event)
specifier|public
name|void
name|actionPerformed
parameter_list|(
name|ActionEvent
name|event
parameter_list|)
block|{
if|if
condition|(
name|sysTray
operator|==
literal|null
condition|)
block|{
name|sysTray
operator|=
operator|new
name|SysTray
argument_list|(
name|JabRefFrame
operator|.
name|this
argument_list|)
expr_stmt|;
block|}
name|SwingUtilities
operator|.
name|invokeLater
argument_list|(
operator|new
name|Runnable
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|run
parameter_list|()
block|{
name|sysTray
operator|.
name|show
argument_list|()
expr_stmt|;
name|JabRefFrame
operator|.
name|this
operator|.
name|setVisible
argument_list|(
literal|false
argument_list|)
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
block|}
block|}
DECL|method|showIfMinimizedToSysTray ()
specifier|public
name|void
name|showIfMinimizedToSysTray
parameter_list|()
block|{
comment|// TODO: does not work correctly when a dialog is shown
comment|// Workaround: put into invokeLater queue before a dialog is added to that queue
if|if
condition|(
operator|!
name|this
operator|.
name|isVisible
argument_list|()
condition|)
block|{
comment|// isVisible() is false if minimized to systray
if|if
condition|(
name|sysTray
operator|!=
literal|null
condition|)
block|{
name|sysTray
operator|.
name|hide
argument_list|()
expr_stmt|;
block|}
name|setVisible
argument_list|(
literal|true
argument_list|)
expr_stmt|;
name|this
operator|.
name|isActive
argument_list|()
expr_stmt|;
name|toFront
argument_list|()
expr_stmt|;
block|}
block|}
comment|/*private class ForegroundLabel extends JLabel {          public ForegroundLabel(String s) {              super(s);              setFont(new Font("plain", Font.BOLD, 70));              setHorizontalAlignment(JLabel.CENTER);          }          public void paint(Graphics g) {             Graphics2D g2 = (Graphics2D)g;             g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);             super.paint(g2);    //To change body of overridden methods use File | Settings | File Templates.         }     }       */
DECL|class|MyGlassPane
specifier|private
specifier|static
class|class
name|MyGlassPane
extends|extends
name|JPanel
block|{
comment|//ForegroundLabel infoLabel = new ForegroundLabel("Showing search");
DECL|method|MyGlassPane ()
specifier|public
name|MyGlassPane
parameter_list|()
block|{
name|addKeyListener
argument_list|(
operator|new
name|KeyAdapter
argument_list|()
block|{             }
argument_list|)
expr_stmt|;
name|addMouseListener
argument_list|(
operator|new
name|MouseAdapter
argument_list|()
block|{             }
argument_list|)
expr_stmt|;
comment|/*  infoLabel.setForeground(new Color(255, 100, 100, 124));                setLayout(new BorderLayout());               add(infoLabel, BorderLayout.CENTER);*/
name|super
operator|.
name|setCursor
argument_list|(
name|Cursor
operator|.
name|getPredefinedCursor
argument_list|(
name|Cursor
operator|.
name|WAIT_CURSOR
argument_list|)
argument_list|)
expr_stmt|;
block|}
comment|// Override isOpaque() to prevent the glasspane from hiding the window contents:
annotation|@
name|Override
DECL|method|isOpaque ()
specifier|public
name|boolean
name|isOpaque
parameter_list|()
block|{
return|return
literal|false
return|;
block|}
block|}
annotation|@
name|Override
DECL|method|showMessage (Object message, String title, int msgType)
specifier|public
name|void
name|showMessage
parameter_list|(
name|Object
name|message
parameter_list|,
name|String
name|title
parameter_list|,
name|int
name|msgType
parameter_list|)
block|{
name|JOptionPane
operator|.
name|showMessageDialog
argument_list|(
name|this
argument_list|,
name|message
argument_list|,
name|title
argument_list|,
name|msgType
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
DECL|method|setStatus (String s)
specifier|public
name|void
name|setStatus
parameter_list|(
name|String
name|s
parameter_list|)
block|{
name|output
argument_list|(
name|s
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
DECL|method|showMessage (String message)
specifier|public
name|void
name|showMessage
parameter_list|(
name|String
name|message
parameter_list|)
block|{
name|JOptionPane
operator|.
name|showMessageDialog
argument_list|(
name|this
argument_list|,
name|message
argument_list|)
expr_stmt|;
block|}
DECL|method|getSearchManager ()
specifier|public
name|SearchManager2
name|getSearchManager
parameter_list|()
block|{
return|return
name|searchManager
return|;
block|}
block|}
end_class

end_unit

