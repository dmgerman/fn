begin_unit|revision:0.9.5;language:Java;cregit-version:0.0.1
begin_comment
comment|/*  Copyright (C) 2003-2016 JabRef contributors.     This program is free software; you can redistribute it and/or modify     it under the terms of the GNU General Public License as published by     the Free Software Foundation; either version 2 of the License, or     (at your option) any later version.      This program is distributed in the hope that it will be useful,     but WITHOUT ANY WARRANTY; without even the implied warranty of     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the     GNU General Public License for more details.      You should have received a copy of the GNU General Public License along     with this program; if not, write to the Free Software Foundation, Inc.,     51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA. */
end_comment

begin_package
DECL|package|net.sf.jabref.logic.msbib
package|package
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|logic
operator|.
name|msbib
package|;
end_package

begin_import
import|import
name|java
operator|.
name|io
operator|.
name|StringWriter
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|HashMap
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|LinkedList
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|List
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Map
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|regex
operator|.
name|Matcher
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|regex
operator|.
name|Pattern
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|stream
operator|.
name|Collectors
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|xml
operator|.
name|parsers
operator|.
name|DocumentBuilder
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|xml
operator|.
name|parsers
operator|.
name|DocumentBuilderFactory
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|xml
operator|.
name|parsers
operator|.
name|ParserConfigurationException
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|xml
operator|.
name|transform
operator|.
name|*
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|xml
operator|.
name|transform
operator|.
name|dom
operator|.
name|DOMSource
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|xml
operator|.
name|transform
operator|.
name|stream
operator|.
name|StreamResult
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|exporter
operator|.
name|layout
operator|.
name|format
operator|.
name|RemoveBrackets
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|importer
operator|.
name|fileformat
operator|.
name|ImportFormat
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|model
operator|.
name|entry
operator|.
name|BibEntry
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|model
operator|.
name|entry
operator|.
name|BibtexEntryTypes
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|exporter
operator|.
name|layout
operator|.
name|LayoutFormatter
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|exporter
operator|.
name|layout
operator|.
name|format
operator|.
name|XMLChars
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|logic
operator|.
name|mods
operator|.
name|PageNumbers
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|logic
operator|.
name|mods
operator|.
name|PersonName
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|logic
operator|.
name|util
operator|.
name|strings
operator|.
name|StringUtil
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|model
operator|.
name|entry
operator|.
name|EntryType
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|commons
operator|.
name|logging
operator|.
name|Log
import|;
end_import

begin_import
import|import
name|org
operator|.
name|apache
operator|.
name|commons
operator|.
name|logging
operator|.
name|LogFactory
import|;
end_import

begin_import
import|import
name|org
operator|.
name|w3c
operator|.
name|dom
operator|.
name|Document
import|;
end_import

begin_import
import|import
name|org
operator|.
name|w3c
operator|.
name|dom
operator|.
name|Element
import|;
end_import

begin_import
import|import
name|org
operator|.
name|w3c
operator|.
name|dom
operator|.
name|Node
import|;
end_import

begin_import
import|import
name|org
operator|.
name|w3c
operator|.
name|dom
operator|.
name|NodeList
import|;
end_import

begin_comment
comment|/**  * Date: May 15, 2007; May 03, 2007  *<p>  * History  * May 03, 2007 - Added export functionality  * May 15, 2007 - Added import functionality  * May 16, 2007 - Changed all interger entries to strings,  * except LCID which must be an integer.  * To avoid exception during integer parsing  * the exception is caught and LCID is set to zero.  * Jan 06, 2012 - Changed the XML element ConferenceName to present  * the Booktitle instead of the organization field content  *  * @author S M Mahbub Murshed (udvranto@yahoo.com)  * @version 2.0.0  * @see<a href="http://mahbub.wordpress.com/2007/03/24/details-of-microsoft-office-2007-bibliographic-format-compared-to-bibtex/">ms office 2007 bibliography format compared to bibtex</a>  * @see<a href="http://mahbub.wordpress.com/2007/03/22/deciphering-microsoft-office-2007-bibliography-format/">deciphering ms office 2007 bibliography format</a>  * See http://www.ecma-international.org/publications/standards/Ecma-376.htm  */
end_comment

begin_class
DECL|class|MSBibEntry
class|class
name|MSBibEntry
block|{
DECL|field|LOGGER
specifier|private
specifier|static
specifier|final
name|Log
name|LOGGER
init|=
name|LogFactory
operator|.
name|getLog
argument_list|(
name|MSBibEntry
operator|.
name|class
argument_list|)
decl_stmt|;
DECL|field|sourceType
specifier|private
name|String
name|sourceType
init|=
literal|"Misc"
decl_stmt|;
DECL|field|bibTexEntry
specifier|private
name|String
name|bibTexEntry
decl_stmt|;
DECL|field|tag
specifier|private
name|String
name|tag
decl_stmt|;
DECL|field|GUID
specifier|private
specifier|static
specifier|final
name|String
name|GUID
init|=
literal|null
decl_stmt|;
DECL|field|LCID
specifier|private
name|int
name|LCID
init|=
operator|-
literal|1
decl_stmt|;
DECL|field|authors
specifier|private
name|List
argument_list|<
name|PersonName
argument_list|>
name|authors
decl_stmt|;
DECL|field|bookAuthors
specifier|private
name|List
argument_list|<
name|PersonName
argument_list|>
name|bookAuthors
decl_stmt|;
DECL|field|editors
specifier|private
name|List
argument_list|<
name|PersonName
argument_list|>
name|editors
decl_stmt|;
DECL|field|translators
specifier|private
name|List
argument_list|<
name|PersonName
argument_list|>
name|translators
decl_stmt|;
DECL|field|producerNames
specifier|private
name|List
argument_list|<
name|PersonName
argument_list|>
name|producerNames
decl_stmt|;
DECL|field|composers
specifier|private
name|List
argument_list|<
name|PersonName
argument_list|>
name|composers
decl_stmt|;
DECL|field|conductors
specifier|private
name|List
argument_list|<
name|PersonName
argument_list|>
name|conductors
decl_stmt|;
DECL|field|performers
specifier|private
name|List
argument_list|<
name|PersonName
argument_list|>
name|performers
decl_stmt|;
DECL|field|writers
specifier|private
name|List
argument_list|<
name|PersonName
argument_list|>
name|writers
decl_stmt|;
DECL|field|directors
specifier|private
name|List
argument_list|<
name|PersonName
argument_list|>
name|directors
decl_stmt|;
DECL|field|compilers
specifier|private
name|List
argument_list|<
name|PersonName
argument_list|>
name|compilers
decl_stmt|;
DECL|field|interviewers
specifier|private
name|List
argument_list|<
name|PersonName
argument_list|>
name|interviewers
decl_stmt|;
DECL|field|interviewees
specifier|private
name|List
argument_list|<
name|PersonName
argument_list|>
name|interviewees
decl_stmt|;
DECL|field|inventors
specifier|private
name|List
argument_list|<
name|PersonName
argument_list|>
name|inventors
decl_stmt|;
DECL|field|counsels
specifier|private
name|List
argument_list|<
name|PersonName
argument_list|>
name|counsels
decl_stmt|;
DECL|field|title
specifier|private
name|String
name|title
decl_stmt|;
DECL|field|year
specifier|private
name|String
name|year
decl_stmt|;
DECL|field|month
specifier|private
name|String
name|month
decl_stmt|;
DECL|field|day
specifier|private
name|String
name|day
decl_stmt|;
DECL|field|shortTitle
specifier|private
name|String
name|shortTitle
decl_stmt|;
DECL|field|comments
specifier|private
name|String
name|comments
decl_stmt|;
DECL|field|pages
specifier|private
name|PageNumbers
name|pages
decl_stmt|;
DECL|field|volume
specifier|private
name|String
name|volume
decl_stmt|;
DECL|field|numberOfVolumes
specifier|private
name|String
name|numberOfVolumes
decl_stmt|;
DECL|field|edition
specifier|private
name|String
name|edition
decl_stmt|;
DECL|field|standardNumber
specifier|private
name|String
name|standardNumber
decl_stmt|;
DECL|field|publisher
specifier|private
name|String
name|publisher
decl_stmt|;
DECL|field|address
specifier|private
name|String
name|address
decl_stmt|;
DECL|field|bookTitle
specifier|private
name|String
name|bookTitle
decl_stmt|;
DECL|field|chapterNumber
specifier|private
name|String
name|chapterNumber
decl_stmt|;
DECL|field|journalName
specifier|private
name|String
name|journalName
decl_stmt|;
DECL|field|issue
specifier|private
name|String
name|issue
decl_stmt|;
DECL|field|periodicalTitle
specifier|private
name|String
name|periodicalTitle
decl_stmt|;
DECL|field|conferenceName
specifier|private
name|String
name|conferenceName
decl_stmt|;
DECL|field|department
specifier|private
name|String
name|department
decl_stmt|;
DECL|field|institution
specifier|private
name|String
name|institution
decl_stmt|;
DECL|field|thesisType
specifier|private
name|String
name|thesisType
decl_stmt|;
DECL|field|internetSiteTitle
specifier|private
name|String
name|internetSiteTitle
decl_stmt|;
DECL|field|dateAccessed
specifier|private
name|String
name|dateAccessed
decl_stmt|;
DECL|field|url
specifier|private
name|String
name|url
decl_stmt|;
DECL|field|productionCompany
specifier|private
name|String
name|productionCompany
decl_stmt|;
DECL|field|publicationTitle
specifier|private
name|String
name|publicationTitle
decl_stmt|;
DECL|field|medium
specifier|private
name|String
name|medium
decl_stmt|;
DECL|field|albumTitle
specifier|private
name|String
name|albumTitle
decl_stmt|;
DECL|field|recordingNumber
specifier|private
name|String
name|recordingNumber
decl_stmt|;
DECL|field|theater
specifier|private
name|String
name|theater
decl_stmt|;
DECL|field|distributor
specifier|private
name|String
name|distributor
decl_stmt|;
DECL|field|broadcastTitle
specifier|private
name|String
name|broadcastTitle
decl_stmt|;
DECL|field|broadcaster
specifier|private
name|String
name|broadcaster
decl_stmt|;
DECL|field|station
specifier|private
name|String
name|station
decl_stmt|;
DECL|field|type
specifier|private
name|String
name|type
decl_stmt|;
DECL|field|patentNumber
specifier|private
name|String
name|patentNumber
decl_stmt|;
DECL|field|court
specifier|private
name|String
name|court
decl_stmt|;
DECL|field|reporter
specifier|private
name|String
name|reporter
decl_stmt|;
DECL|field|caseNumber
specifier|private
name|String
name|caseNumber
decl_stmt|;
DECL|field|abbreviatedCaseNumber
specifier|private
name|String
name|abbreviatedCaseNumber
decl_stmt|;
DECL|field|bibTexSeries
specifier|private
name|String
name|bibTexSeries
decl_stmt|;
DECL|field|bibTexAbstract
specifier|private
name|String
name|bibTexAbstract
decl_stmt|;
DECL|field|bibTexKeyWords
specifier|private
name|String
name|bibTexKeyWords
decl_stmt|;
DECL|field|bibTexCrossRef
specifier|private
name|String
name|bibTexCrossRef
decl_stmt|;
DECL|field|bibTex_HowPublished
specifier|private
name|String
name|bibTex_HowPublished
decl_stmt|;
DECL|field|bibTexAffiliation
specifier|private
name|String
name|bibTexAffiliation
decl_stmt|;
DECL|field|bibTexContents
specifier|private
name|String
name|bibTexContents
decl_stmt|;
DECL|field|bibTexCopyright
specifier|private
name|String
name|bibTexCopyright
decl_stmt|;
DECL|field|bibTexPrice
specifier|private
name|String
name|bibTexPrice
decl_stmt|;
DECL|field|bibTexSize
specifier|private
name|String
name|bibTexSize
decl_stmt|;
comment|/* SM 2010.10 intype, paper support */
DECL|field|bibTexInType
specifier|private
name|String
name|bibTexInType
decl_stmt|;
DECL|field|bibTexPaper
specifier|private
name|String
name|bibTexPaper
decl_stmt|;
DECL|field|BIBTEX
specifier|private
specifier|static
specifier|final
name|String
name|BIBTEX
init|=
literal|"BIBTEX_"
decl_stmt|;
DECL|field|MSBIB
specifier|private
specifier|static
specifier|final
name|String
name|MSBIB
init|=
literal|"msbib-"
decl_stmt|;
DECL|field|B_COLON
specifier|private
specifier|static
specifier|final
name|String
name|B_COLON
init|=
literal|"b:"
decl_stmt|;
comment|// reduced subset, supports only "CITY , STATE, COUNTRY"
comment|// \b(\w+)\s?[,]?\s?(\w+)\s?[,]?\s?(\w+)\b
comment|// WORD SPACE , SPACE WORD SPACE , SPACE WORD
comment|// tested using http://www.javaregex.com/test.html
DECL|field|ADDRESS_PATTERN
specifier|private
specifier|static
specifier|final
name|Pattern
name|ADDRESS_PATTERN
init|=
name|Pattern
operator|.
name|compile
argument_list|(
literal|"\\b(\\w+)\\s*[,]?\\s*(\\w+)\\s*[,]?\\s*(\\w+)\\b"
argument_list|)
decl_stmt|;
comment|// Allows 20.3-2007|||20/3-  2007 etc.
comment|// (\d{1,2})\s?[.,-/]\s?(\d{1,2})\s?[.,-/]\s?(\d{2,4})
comment|// 1-2 DIGITS SPACE SEPERATOR SPACE 1-2 DIGITS SPACE SEPERATOR SPACE 2-4 DIGITS
comment|// tested using http://www.javaregex.com/test.html
DECL|field|DATE_PATTERN
specifier|private
specifier|static
specifier|final
name|Pattern
name|DATE_PATTERN
init|=
name|Pattern
operator|.
name|compile
argument_list|(
literal|"(\\d{1,2})\\s*[.,-/]\\s*(\\d{1,2})\\s*[.,-/]\\s*(\\d{2,4})"
argument_list|)
decl_stmt|;
DECL|method|MSBibEntry (BibEntry bibtex)
specifier|public
name|MSBibEntry
parameter_list|(
name|BibEntry
name|bibtex
parameter_list|)
block|{
name|populateFromBibtex
argument_list|(
name|bibtex
argument_list|)
expr_stmt|;
block|}
DECL|method|MSBibEntry (Element entry, String bcol)
specifier|public
name|MSBibEntry
parameter_list|(
name|Element
name|entry
parameter_list|,
name|String
name|bcol
parameter_list|)
block|{
name|populateFromXml
argument_list|(
name|entry
argument_list|,
name|bcol
argument_list|)
expr_stmt|;
block|}
DECL|method|getFromXml (String name, Element entry)
specifier|private
name|String
name|getFromXml
parameter_list|(
name|String
name|name
parameter_list|,
name|Element
name|entry
parameter_list|)
block|{
name|String
name|value
init|=
literal|null
decl_stmt|;
name|NodeList
name|nodeLst
init|=
name|entry
operator|.
name|getElementsByTagName
argument_list|(
name|name
argument_list|)
decl_stmt|;
if|if
condition|(
name|nodeLst
operator|.
name|getLength
argument_list|()
operator|>
literal|0
condition|)
block|{
name|value
operator|=
name|nodeLst
operator|.
name|item
argument_list|(
literal|0
argument_list|)
operator|.
name|getTextContent
argument_list|()
expr_stmt|;
block|}
return|return
name|value
return|;
block|}
DECL|method|populateFromXml (Element entry, String bcol)
specifier|private
name|void
name|populateFromXml
parameter_list|(
name|Element
name|entry
parameter_list|,
name|String
name|bcol
parameter_list|)
block|{
name|String
name|temp
decl_stmt|;
name|sourceType
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"SourceType"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|tag
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"Tag"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|temp
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"LCID"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
if|if
condition|(
name|temp
operator|!=
literal|null
condition|)
block|{
try|try
block|{
name|LCID
operator|=
name|Integer
operator|.
name|parseInt
argument_list|(
name|temp
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|NumberFormatException
name|e
parameter_list|)
block|{
name|LCID
operator|=
operator|-
literal|1
expr_stmt|;
block|}
block|}
name|title
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"Title"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|year
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"Year"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|month
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"Month"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|day
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"Day"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|shortTitle
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"ShortTitle"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|comments
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"Comments"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|temp
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"Pages"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
if|if
condition|(
name|temp
operator|!=
literal|null
condition|)
block|{
name|pages
operator|=
operator|new
name|PageNumbers
argument_list|(
name|temp
argument_list|)
expr_stmt|;
block|}
name|volume
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"Volume"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|numberOfVolumes
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"NumberVolumes"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|edition
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"Edition"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|standardNumber
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"StandardNumber"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|publisher
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"Publisher"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|String
name|city
init|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"City"
argument_list|,
name|entry
argument_list|)
decl_stmt|;
name|String
name|state
init|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"StateProvince"
argument_list|,
name|entry
argument_list|)
decl_stmt|;
name|String
name|country
init|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"CountryRegion"
argument_list|,
name|entry
argument_list|)
decl_stmt|;
name|StringBuffer
name|addressBuffer
init|=
operator|new
name|StringBuffer
argument_list|()
decl_stmt|;
if|if
condition|(
name|city
operator|!=
literal|null
condition|)
block|{
name|addressBuffer
operator|.
name|append
argument_list|(
name|city
argument_list|)
operator|.
name|append
argument_list|(
literal|", "
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|state
operator|!=
literal|null
condition|)
block|{
name|addressBuffer
operator|.
name|append
argument_list|(
name|state
argument_list|)
operator|.
name|append
argument_list|(
literal|' '
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|country
operator|!=
literal|null
condition|)
block|{
name|addressBuffer
operator|.
name|append
argument_list|(
name|country
argument_list|)
expr_stmt|;
block|}
name|address
operator|=
name|addressBuffer
operator|.
name|toString
argument_list|()
operator|.
name|trim
argument_list|()
expr_stmt|;
if|if
condition|(
name|address
operator|.
name|isEmpty
argument_list|()
operator|||
literal|","
operator|.
name|equals
argument_list|(
name|address
argument_list|)
condition|)
block|{
name|address
operator|=
literal|null
expr_stmt|;
block|}
name|bookTitle
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"BookTitle"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|chapterNumber
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"ChapterNumber"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|journalName
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"JournalName"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|issue
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"Issue"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|periodicalTitle
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"PeriodicalTitle"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|conferenceName
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"ConferenceName"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|department
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"Department"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|institution
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"Institution"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|thesisType
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"ThesisType"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|internetSiteTitle
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"InternetSiteTitle"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|String
name|month
init|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"MonthAccessed"
argument_list|,
name|entry
argument_list|)
decl_stmt|;
name|String
name|day
init|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"DayAccessed"
argument_list|,
name|entry
argument_list|)
decl_stmt|;
name|String
name|year
init|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"YearAccessed"
argument_list|,
name|entry
argument_list|)
decl_stmt|;
name|dateAccessed
operator|=
literal|""
expr_stmt|;
if|if
condition|(
name|month
operator|!=
literal|null
condition|)
block|{
name|dateAccessed
operator|+=
name|month
operator|+
literal|' '
expr_stmt|;
block|}
if|if
condition|(
name|day
operator|!=
literal|null
condition|)
block|{
name|dateAccessed
operator|+=
name|day
operator|+
literal|", "
expr_stmt|;
block|}
if|if
condition|(
name|year
operator|!=
literal|null
condition|)
block|{
name|dateAccessed
operator|+=
name|year
expr_stmt|;
block|}
name|dateAccessed
operator|=
name|dateAccessed
operator|.
name|trim
argument_list|()
expr_stmt|;
if|if
condition|(
name|dateAccessed
operator|.
name|isEmpty
argument_list|()
operator|||
literal|","
operator|.
name|equals
argument_list|(
name|dateAccessed
argument_list|)
condition|)
block|{
name|dateAccessed
operator|=
literal|null
expr_stmt|;
block|}
name|url
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"URL"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|productionCompany
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"ProductionCompany"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|publicationTitle
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"PublicationTitle"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|medium
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"Medium"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|albumTitle
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"AlbumTitle"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|recordingNumber
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"RecordingNumber"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|theater
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"Theater"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|distributor
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"Distributor"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|broadcastTitle
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"BroadcastTitle"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|broadcaster
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"Broadcaster"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|station
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"Station"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|type
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"Type"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|patentNumber
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"PatentNumber"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|court
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"Court"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|reporter
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"Reporter"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|caseNumber
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"CaseNumber"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|abbreviatedCaseNumber
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
literal|"AbbreviatedCaseNumber"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|bibTexSeries
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
name|BIBTEX
operator|+
literal|"Series"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|bibTexAbstract
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
name|BIBTEX
operator|+
literal|"Abstract"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|bibTexKeyWords
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
name|BIBTEX
operator|+
literal|"KeyWords"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|bibTexCrossRef
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
name|BIBTEX
operator|+
literal|"CrossRef"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|bibTex_HowPublished
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
name|BIBTEX
operator|+
literal|"HowPublished"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|bibTexAffiliation
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
name|BIBTEX
operator|+
literal|"Affiliation"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|bibTexContents
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
name|BIBTEX
operator|+
literal|"Contents"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|bibTexCopyright
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
name|BIBTEX
operator|+
literal|"Copyright"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|bibTexPrice
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
name|BIBTEX
operator|+
literal|"Price"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|bibTexSize
operator|=
name|getFromXml
argument_list|(
name|bcol
operator|+
name|BIBTEX
operator|+
literal|"Size"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|NodeList
name|nodeLst
init|=
name|entry
operator|.
name|getElementsByTagName
argument_list|(
name|bcol
operator|+
literal|"Author"
argument_list|)
decl_stmt|;
if|if
condition|(
name|nodeLst
operator|.
name|getLength
argument_list|()
operator|>
literal|0
condition|)
block|{
name|getAuthors
argument_list|(
operator|(
name|Element
operator|)
name|nodeLst
operator|.
name|item
argument_list|(
literal|0
argument_list|)
argument_list|,
name|bcol
argument_list|)
expr_stmt|;
block|}
block|}
DECL|method|populateFromBibtex (BibEntry bibtex)
specifier|private
name|void
name|populateFromBibtex
parameter_list|(
name|BibEntry
name|bibtex
parameter_list|)
block|{
name|sourceType
operator|=
name|getMSBibSourceType
argument_list|(
name|bibtex
argument_list|)
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
name|BibEntry
operator|.
name|KEY_FIELD
argument_list|)
condition|)
block|{
name|tag
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|BibEntry
operator|.
name|KEY_FIELD
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"language"
argument_list|)
condition|)
block|{
name|LCID
operator|=
name|getLCID
argument_list|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"language"
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"title"
argument_list|)
condition|)
block|{
name|String
name|temp
init|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"title"
argument_list|)
decl_stmt|;
comment|// TODO: remove LaTex syntax
name|title
operator|=
operator|new
name|RemoveBrackets
argument_list|()
operator|.
name|format
argument_list|(
name|temp
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"year"
argument_list|)
condition|)
block|{
name|year
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"year"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"month"
argument_list|)
condition|)
block|{
name|month
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"month"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
name|MSBIB
operator|+
literal|"day"
argument_list|)
condition|)
block|{
name|day
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"day"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
name|MSBIB
operator|+
literal|"shorttitle"
argument_list|)
condition|)
block|{
name|shortTitle
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"shorttitle"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"note"
argument_list|)
condition|)
block|{
name|comments
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"note"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"pages"
argument_list|)
condition|)
block|{
name|pages
operator|=
operator|new
name|PageNumbers
argument_list|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"pages"
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"volume"
argument_list|)
condition|)
block|{
name|volume
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"volume"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
name|MSBIB
operator|+
literal|"numberofvolume"
argument_list|)
condition|)
block|{
name|numberOfVolumes
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"numberofvolume"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"edition"
argument_list|)
condition|)
block|{
name|edition
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"edition"
argument_list|)
expr_stmt|;
block|}
name|standardNumber
operator|=
literal|""
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"isbn"
argument_list|)
condition|)
block|{
name|standardNumber
operator|+=
literal|" ISBN: "
operator|+
name|bibtex
operator|.
name|getField
argument_list|(
literal|"isbn"
argument_list|)
expr_stmt|;
comment|/* SM: 2010.10: lower case */
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"issn"
argument_list|)
condition|)
block|{
name|standardNumber
operator|+=
literal|" ISSN: "
operator|+
name|bibtex
operator|.
name|getField
argument_list|(
literal|"issn"
argument_list|)
expr_stmt|;
comment|/* SM: 2010.10: lower case */
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"lccn"
argument_list|)
condition|)
block|{
name|standardNumber
operator|+=
literal|" LCCN: "
operator|+
name|bibtex
operator|.
name|getField
argument_list|(
literal|"lccn"
argument_list|)
expr_stmt|;
comment|/* SM: 2010.10: lower case */
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"mrnumber"
argument_list|)
condition|)
block|{
name|standardNumber
operator|+=
literal|" MRN: "
operator|+
name|bibtex
operator|.
name|getField
argument_list|(
literal|"mrnumber"
argument_list|)
expr_stmt|;
block|}
comment|/* SM: 2010.10 begin DOI support */
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"doi"
argument_list|)
condition|)
block|{
name|standardNumber
operator|+=
literal|" DOI: "
operator|+
name|bibtex
operator|.
name|getField
argument_list|(
literal|"doi"
argument_list|)
expr_stmt|;
block|}
comment|/* SM: 2010.10 end DOI support */
if|if
condition|(
name|standardNumber
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|standardNumber
operator|=
literal|null
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"publisher"
argument_list|)
condition|)
block|{
name|publisher
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"publisher"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"address"
argument_list|)
condition|)
block|{
name|address
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"address"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"booktitle"
argument_list|)
condition|)
block|{
name|bookTitle
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"booktitle"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"chapter"
argument_list|)
condition|)
block|{
name|chapterNumber
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"chapter"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"journal"
argument_list|)
condition|)
block|{
name|journalName
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"journal"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"number"
argument_list|)
condition|)
block|{
name|issue
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"number"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
name|MSBIB
operator|+
literal|"periodical"
argument_list|)
condition|)
block|{
name|periodicalTitle
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"periodical"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"booktitle"
argument_list|)
condition|)
block|{
name|conferenceName
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"booktitle"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"school"
argument_list|)
condition|)
block|{
name|department
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"school"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"institution"
argument_list|)
condition|)
block|{
name|institution
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"institution"
argument_list|)
expr_stmt|;
block|}
comment|/* SM: 2010.10 Modified for default source types */
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"type"
argument_list|)
condition|)
block|{
name|thesisType
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"type"
argument_list|)
expr_stmt|;
block|}
else|else
block|{
if|if
condition|(
literal|"techreport"
operator|.
name|equalsIgnoreCase
argument_list|(
name|bibtex
operator|.
name|getType
argument_list|()
argument_list|)
condition|)
block|{
name|thesisType
operator|=
literal|"Tech. rep."
expr_stmt|;
block|}
elseif|else
if|if
condition|(
literal|"mastersthesis"
operator|.
name|equalsIgnoreCase
argument_list|(
name|bibtex
operator|.
name|getType
argument_list|()
argument_list|)
condition|)
block|{
name|thesisType
operator|=
literal|"Master's thesis"
expr_stmt|;
block|}
elseif|else
if|if
condition|(
literal|"phdthesis"
operator|.
name|equalsIgnoreCase
argument_list|(
name|bibtex
operator|.
name|getType
argument_list|()
argument_list|)
condition|)
block|{
name|thesisType
operator|=
literal|"Ph.D. dissertation"
expr_stmt|;
block|}
elseif|else
if|if
condition|(
literal|"unpublished"
operator|.
name|equalsIgnoreCase
argument_list|(
name|bibtex
operator|.
name|getType
argument_list|()
argument_list|)
condition|)
block|{
name|thesisType
operator|=
literal|"unpublished"
expr_stmt|;
block|}
block|}
if|if
condition|(
operator|(
literal|"InternetSite"
operator|.
name|equals
argument_list|(
name|sourceType
argument_list|)
operator|||
literal|"DocumentFromInternetSite"
operator|.
name|equals
argument_list|(
name|sourceType
argument_list|)
operator|)
operator|&&
operator|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"title"
argument_list|)
operator|)
condition|)
block|{
name|internetSiteTitle
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"title"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
name|MSBIB
operator|+
literal|"accessed"
argument_list|)
condition|)
block|{
name|dateAccessed
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"accessed"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"url"
argument_list|)
condition|)
block|{
name|url
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"url"
argument_list|)
expr_stmt|;
comment|/* SM: 2010.10: lower case */
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
name|MSBIB
operator|+
literal|"productioncompany"
argument_list|)
condition|)
block|{
name|productionCompany
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"productioncompany"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
operator|(
literal|"ElectronicSource"
operator|.
name|equals
argument_list|(
name|sourceType
argument_list|)
operator|||
literal|"Art"
operator|.
name|equals
argument_list|(
name|sourceType
argument_list|)
operator|||
literal|"Misc"
operator|.
name|equals
argument_list|(
name|sourceType
argument_list|)
operator|)
operator|&&
operator|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"title"
argument_list|)
operator|)
condition|)
block|{
name|publicationTitle
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"title"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
name|MSBIB
operator|+
literal|"medium"
argument_list|)
condition|)
block|{
name|medium
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"medium"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
literal|"SoundRecording"
operator|.
name|equals
argument_list|(
name|sourceType
argument_list|)
operator|&&
operator|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"title"
argument_list|)
operator|)
condition|)
block|{
name|albumTitle
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"title"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
name|MSBIB
operator|+
literal|"recordingnumber"
argument_list|)
condition|)
block|{
name|recordingNumber
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"recordingnumber"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
name|MSBIB
operator|+
literal|"theater"
argument_list|)
condition|)
block|{
name|theater
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"theater"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
name|MSBIB
operator|+
literal|"distributor"
argument_list|)
condition|)
block|{
name|distributor
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"distributor"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
literal|"Interview"
operator|.
name|equals
argument_list|(
name|sourceType
argument_list|)
operator|&&
operator|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"title"
argument_list|)
operator|)
condition|)
block|{
name|broadcastTitle
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"title"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
name|MSBIB
operator|+
literal|"broadcaster"
argument_list|)
condition|)
block|{
name|broadcaster
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"broadcaster"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
name|MSBIB
operator|+
literal|"station"
argument_list|)
condition|)
block|{
name|station
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"station"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
name|MSBIB
operator|+
literal|"type"
argument_list|)
condition|)
block|{
name|type
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"type"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
name|MSBIB
operator|+
literal|"patentnumber"
argument_list|)
condition|)
block|{
name|patentNumber
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"patentnumber"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
name|MSBIB
operator|+
literal|"court"
argument_list|)
condition|)
block|{
name|court
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"court"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
name|MSBIB
operator|+
literal|"reporter"
argument_list|)
condition|)
block|{
name|reporter
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"reporter"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
name|MSBIB
operator|+
literal|"casenumber"
argument_list|)
condition|)
block|{
name|caseNumber
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"casenumber"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
name|MSBIB
operator|+
literal|"abbreviatedcasenumber"
argument_list|)
condition|)
block|{
name|abbreviatedCaseNumber
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"abbreviatedcasenumber"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"series"
argument_list|)
condition|)
block|{
name|bibTexSeries
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"series"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"abstract"
argument_list|)
condition|)
block|{
name|bibTexAbstract
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"abstract"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"keywords"
argument_list|)
condition|)
block|{
name|bibTexKeyWords
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"keywords"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"crossref"
argument_list|)
condition|)
block|{
name|bibTexCrossRef
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"crossref"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"howpublished"
argument_list|)
condition|)
block|{
name|bibTex_HowPublished
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"howpublished"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"affiliation"
argument_list|)
condition|)
block|{
name|bibTexAffiliation
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"affiliation"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"contents"
argument_list|)
condition|)
block|{
name|bibTexContents
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"contents"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"copyright"
argument_list|)
condition|)
block|{
name|bibTexCopyright
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"copyright"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"price"
argument_list|)
condition|)
block|{
name|bibTexPrice
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"price"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"size"
argument_list|)
condition|)
block|{
name|bibTexSize
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"size"
argument_list|)
expr_stmt|;
block|}
comment|/* SM: 2010.10 end intype, paper support */
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"intype"
argument_list|)
condition|)
block|{
name|bibTexInType
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"intype"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"paper"
argument_list|)
condition|)
block|{
name|bibTexPaper
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"paper"
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"author"
argument_list|)
condition|)
block|{
name|authors
operator|=
name|getAuthors
argument_list|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"author"
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibtex
operator|.
name|hasField
argument_list|(
literal|"editor"
argument_list|)
condition|)
block|{
name|editors
operator|=
name|getAuthors
argument_list|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"editor"
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|boolean
name|FORMATXML
init|=
literal|false
decl_stmt|;
if|if
condition|(
name|FORMATXML
condition|)
block|{
name|title
operator|=
name|format
argument_list|(
name|title
argument_list|)
expr_stmt|;
name|bibTexAbstract
operator|=
name|format
argument_list|(
name|bibTexAbstract
argument_list|)
expr_stmt|;
block|}
block|}
DECL|method|format (String value)
specifier|private
name|String
name|format
parameter_list|(
name|String
name|value
parameter_list|)
block|{
if|if
condition|(
name|value
operator|==
literal|null
condition|)
block|{
return|return
literal|null
return|;
block|}
name|String
name|result
decl_stmt|;
name|LayoutFormatter
name|chars
init|=
operator|new
name|XMLChars
argument_list|()
decl_stmt|;
name|result
operator|=
name|chars
operator|.
name|format
argument_list|(
name|value
argument_list|)
expr_stmt|;
return|return
name|result
return|;
block|}
comment|// http://www.microsoft.com/globaldev/reference/lcid-all.mspx
DECL|method|getLCID (String language)
specifier|private
name|int
name|getLCID
parameter_list|(
name|String
name|language
parameter_list|)
block|{
comment|// TODO: add language to LCID mapping
return|return
literal|0
return|;
block|}
comment|// http://www.microsoft.com/globaldev/reference/lcid-all.mspx
DECL|method|getLanguage (int LCID)
specifier|private
name|String
name|getLanguage
parameter_list|(
name|int
name|LCID
parameter_list|)
block|{
comment|// TODO: add language to LCID mapping
return|return
literal|"english"
return|;
block|}
DECL|method|getSpecificAuthors (String type, Element authors, String bcol)
specifier|private
name|List
argument_list|<
name|PersonName
argument_list|>
name|getSpecificAuthors
parameter_list|(
name|String
name|type
parameter_list|,
name|Element
name|authors
parameter_list|,
name|String
name|bcol
parameter_list|)
block|{
name|List
argument_list|<
name|PersonName
argument_list|>
name|result
init|=
literal|null
decl_stmt|;
name|NodeList
name|nodeLst
init|=
name|authors
operator|.
name|getElementsByTagName
argument_list|(
name|bcol
operator|+
name|type
argument_list|)
decl_stmt|;
if|if
condition|(
name|nodeLst
operator|.
name|getLength
argument_list|()
operator|<=
literal|0
condition|)
block|{
return|return
name|result
return|;
block|}
name|nodeLst
operator|=
operator|(
operator|(
name|Element
operator|)
name|nodeLst
operator|.
name|item
argument_list|(
literal|0
argument_list|)
operator|)
operator|.
name|getElementsByTagName
argument_list|(
name|bcol
operator|+
literal|"NameList"
argument_list|)
expr_stmt|;
if|if
condition|(
name|nodeLst
operator|.
name|getLength
argument_list|()
operator|<=
literal|0
condition|)
block|{
return|return
name|result
return|;
block|}
name|NodeList
name|person
init|=
operator|(
operator|(
name|Element
operator|)
name|nodeLst
operator|.
name|item
argument_list|(
literal|0
argument_list|)
operator|)
operator|.
name|getElementsByTagName
argument_list|(
name|bcol
operator|+
literal|"Person"
argument_list|)
decl_stmt|;
if|if
condition|(
name|person
operator|.
name|getLength
argument_list|()
operator|<=
literal|0
condition|)
block|{
return|return
name|result
return|;
block|}
name|result
operator|=
operator|new
name|LinkedList
argument_list|<>
argument_list|()
expr_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|person
operator|.
name|getLength
argument_list|()
condition|;
name|i
operator|++
control|)
block|{
name|NodeList
name|firstName
init|=
operator|(
operator|(
name|Element
operator|)
name|person
operator|.
name|item
argument_list|(
name|i
argument_list|)
operator|)
operator|.
name|getElementsByTagName
argument_list|(
name|bcol
operator|+
literal|"First"
argument_list|)
decl_stmt|;
name|NodeList
name|lastName
init|=
operator|(
operator|(
name|Element
operator|)
name|person
operator|.
name|item
argument_list|(
name|i
argument_list|)
operator|)
operator|.
name|getElementsByTagName
argument_list|(
name|bcol
operator|+
literal|"Last"
argument_list|)
decl_stmt|;
name|NodeList
name|middleName
init|=
operator|(
operator|(
name|Element
operator|)
name|person
operator|.
name|item
argument_list|(
name|i
argument_list|)
operator|)
operator|.
name|getElementsByTagName
argument_list|(
name|bcol
operator|+
literal|"Middle"
argument_list|)
decl_stmt|;
name|PersonName
name|name
init|=
operator|new
name|PersonName
argument_list|()
decl_stmt|;
if|if
condition|(
name|firstName
operator|.
name|getLength
argument_list|()
operator|>
literal|0
condition|)
block|{
name|name
operator|.
name|setFirstname
argument_list|(
name|firstName
operator|.
name|item
argument_list|(
literal|0
argument_list|)
operator|.
name|getTextContent
argument_list|()
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|middleName
operator|.
name|getLength
argument_list|()
operator|>
literal|0
condition|)
block|{
name|name
operator|.
name|setMiddlename
argument_list|(
name|middleName
operator|.
name|item
argument_list|(
literal|0
argument_list|)
operator|.
name|getTextContent
argument_list|()
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|lastName
operator|.
name|getLength
argument_list|()
operator|>
literal|0
condition|)
block|{
name|name
operator|.
name|setSurname
argument_list|(
name|lastName
operator|.
name|item
argument_list|(
literal|0
argument_list|)
operator|.
name|getTextContent
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|result
operator|.
name|add
argument_list|(
name|name
argument_list|)
expr_stmt|;
block|}
return|return
name|result
return|;
block|}
DECL|method|getAuthors (Element authorsElem, String bcol)
specifier|private
name|void
name|getAuthors
parameter_list|(
name|Element
name|authorsElem
parameter_list|,
name|String
name|bcol
parameter_list|)
block|{
name|authors
operator|=
name|getSpecificAuthors
argument_list|(
literal|"Author"
argument_list|,
name|authorsElem
argument_list|,
name|bcol
argument_list|)
expr_stmt|;
name|bookAuthors
operator|=
name|getSpecificAuthors
argument_list|(
literal|"BookAuthor"
argument_list|,
name|authorsElem
argument_list|,
name|bcol
argument_list|)
expr_stmt|;
name|editors
operator|=
name|getSpecificAuthors
argument_list|(
literal|"Editor"
argument_list|,
name|authorsElem
argument_list|,
name|bcol
argument_list|)
expr_stmt|;
name|translators
operator|=
name|getSpecificAuthors
argument_list|(
literal|"Translator"
argument_list|,
name|authorsElem
argument_list|,
name|bcol
argument_list|)
expr_stmt|;
name|producerNames
operator|=
name|getSpecificAuthors
argument_list|(
literal|"ProducerName"
argument_list|,
name|authorsElem
argument_list|,
name|bcol
argument_list|)
expr_stmt|;
name|composers
operator|=
name|getSpecificAuthors
argument_list|(
literal|"Composer"
argument_list|,
name|authorsElem
argument_list|,
name|bcol
argument_list|)
expr_stmt|;
name|conductors
operator|=
name|getSpecificAuthors
argument_list|(
literal|"Conductor"
argument_list|,
name|authorsElem
argument_list|,
name|bcol
argument_list|)
expr_stmt|;
name|performers
operator|=
name|getSpecificAuthors
argument_list|(
literal|"Performer"
argument_list|,
name|authorsElem
argument_list|,
name|bcol
argument_list|)
expr_stmt|;
name|writers
operator|=
name|getSpecificAuthors
argument_list|(
literal|"Writer"
argument_list|,
name|authorsElem
argument_list|,
name|bcol
argument_list|)
expr_stmt|;
name|directors
operator|=
name|getSpecificAuthors
argument_list|(
literal|"Director"
argument_list|,
name|authorsElem
argument_list|,
name|bcol
argument_list|)
expr_stmt|;
name|compilers
operator|=
name|getSpecificAuthors
argument_list|(
literal|"Compiler"
argument_list|,
name|authorsElem
argument_list|,
name|bcol
argument_list|)
expr_stmt|;
name|interviewers
operator|=
name|getSpecificAuthors
argument_list|(
literal|"Interviewer"
argument_list|,
name|authorsElem
argument_list|,
name|bcol
argument_list|)
expr_stmt|;
name|interviewees
operator|=
name|getSpecificAuthors
argument_list|(
literal|"Interviewee"
argument_list|,
name|authorsElem
argument_list|,
name|bcol
argument_list|)
expr_stmt|;
name|inventors
operator|=
name|getSpecificAuthors
argument_list|(
literal|"Inventor"
argument_list|,
name|authorsElem
argument_list|,
name|bcol
argument_list|)
expr_stmt|;
name|counsels
operator|=
name|getSpecificAuthors
argument_list|(
literal|"Counsel"
argument_list|,
name|authorsElem
argument_list|,
name|bcol
argument_list|)
expr_stmt|;
block|}
DECL|method|getAuthors (String authors)
specifier|private
name|List
argument_list|<
name|PersonName
argument_list|>
name|getAuthors
parameter_list|(
name|String
name|authors
parameter_list|)
block|{
name|List
argument_list|<
name|PersonName
argument_list|>
name|result
init|=
operator|new
name|LinkedList
argument_list|<>
argument_list|()
decl_stmt|;
if|if
condition|(
name|authors
operator|.
name|contains
argument_list|(
literal|" and "
argument_list|)
condition|)
block|{
name|String
index|[]
name|names
init|=
name|authors
operator|.
name|split
argument_list|(
literal|" and "
argument_list|)
decl_stmt|;
for|for
control|(
name|String
name|name
range|:
name|names
control|)
block|{
name|result
operator|.
name|add
argument_list|(
operator|new
name|PersonName
argument_list|(
name|name
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
name|result
operator|.
name|add
argument_list|(
operator|new
name|PersonName
argument_list|(
name|authors
argument_list|)
argument_list|)
expr_stmt|;
block|}
return|return
name|result
return|;
block|}
DECL|method|getMSBibSourceType (BibEntry bibtex)
specifier|private
name|String
name|getMSBibSourceType
parameter_list|(
name|BibEntry
name|bibtex
parameter_list|)
block|{
name|String
name|bibtexType
init|=
name|bibtex
operator|.
name|getType
argument_list|()
decl_stmt|;
name|String
name|result
init|=
literal|"Misc"
decl_stmt|;
if|if
condition|(
literal|"book"
operator|.
name|equalsIgnoreCase
argument_list|(
name|bibtexType
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"Book"
expr_stmt|;
block|}
elseif|else
if|if
condition|(
literal|"inbook"
operator|.
name|equalsIgnoreCase
argument_list|(
name|bibtexType
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"BookSection"
expr_stmt|;
name|bibTexEntry
operator|=
literal|"inbook"
expr_stmt|;
block|}
comment|/* SM 2010.10: generalized */
elseif|else
if|if
condition|(
literal|"booklet"
operator|.
name|equalsIgnoreCase
argument_list|(
name|bibtexType
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"BookSection"
expr_stmt|;
name|bibTexEntry
operator|=
literal|"booklet"
expr_stmt|;
block|}
elseif|else
if|if
condition|(
literal|"incollection"
operator|.
name|equalsIgnoreCase
argument_list|(
name|bibtexType
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"BookSection"
expr_stmt|;
name|bibTexEntry
operator|=
literal|"incollection"
expr_stmt|;
block|}
elseif|else
if|if
condition|(
literal|"article"
operator|.
name|equalsIgnoreCase
argument_list|(
name|bibtexType
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"JournalArticle"
expr_stmt|;
block|}
elseif|else
if|if
condition|(
literal|"inproceedings"
operator|.
name|equalsIgnoreCase
argument_list|(
name|bibtexType
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"ConferenceProceedings"
expr_stmt|;
name|bibTexEntry
operator|=
literal|"inproceedings"
expr_stmt|;
block|}
comment|/* SM 2010.10: generalized */
elseif|else
if|if
condition|(
literal|"conference"
operator|.
name|equalsIgnoreCase
argument_list|(
name|bibtexType
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"ConferenceProceedings"
expr_stmt|;
name|bibTexEntry
operator|=
literal|"conference"
expr_stmt|;
block|}
elseif|else
if|if
condition|(
literal|"proceedings"
operator|.
name|equalsIgnoreCase
argument_list|(
name|bibtexType
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"ConferenceProceedings"
expr_stmt|;
name|bibTexEntry
operator|=
literal|"proceedings"
expr_stmt|;
block|}
elseif|else
if|if
condition|(
literal|"collection"
operator|.
name|equalsIgnoreCase
argument_list|(
name|bibtexType
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"ConferenceProceedings"
expr_stmt|;
name|bibTexEntry
operator|=
literal|"collection"
expr_stmt|;
block|}
elseif|else
if|if
condition|(
literal|"techreport"
operator|.
name|equalsIgnoreCase
argument_list|(
name|bibtexType
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"Report"
expr_stmt|;
name|bibTexEntry
operator|=
literal|"techreport"
expr_stmt|;
block|}
comment|/* SM 2010.10: generalized */
elseif|else
if|if
condition|(
literal|"manual"
operator|.
name|equalsIgnoreCase
argument_list|(
name|bibtexType
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"Report"
expr_stmt|;
name|bibTexEntry
operator|=
literal|"manual"
expr_stmt|;
block|}
elseif|else
if|if
condition|(
literal|"mastersthesis"
operator|.
name|equalsIgnoreCase
argument_list|(
name|bibtexType
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"Report"
expr_stmt|;
name|bibTexEntry
operator|=
literal|"mastersthesis"
expr_stmt|;
block|}
elseif|else
if|if
condition|(
literal|"phdthesis"
operator|.
name|equalsIgnoreCase
argument_list|(
name|bibtexType
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"Report"
expr_stmt|;
name|bibTexEntry
operator|=
literal|"phdthesis"
expr_stmt|;
block|}
elseif|else
if|if
condition|(
literal|"unpublished"
operator|.
name|equalsIgnoreCase
argument_list|(
name|bibtexType
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"Report"
expr_stmt|;
name|bibTexEntry
operator|=
literal|"unpublished"
expr_stmt|;
block|}
elseif|else
if|if
condition|(
literal|"patent"
operator|.
name|equalsIgnoreCase
argument_list|(
name|bibtexType
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"Patent"
expr_stmt|;
block|}
elseif|else
if|if
condition|(
literal|"misc"
operator|.
name|equalsIgnoreCase
argument_list|(
name|bibtexType
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"Misc"
expr_stmt|;
block|}
elseif|else
if|if
condition|(
literal|"electronic"
operator|.
name|equalsIgnoreCase
argument_list|(
name|bibtexType
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"Misc"
expr_stmt|;
name|bibTexEntry
operator|=
literal|"electronic"
expr_stmt|;
block|}
return|return
name|result
return|;
block|}
DECL|method|getDOMrepresentation ()
specifier|private
name|Node
name|getDOMrepresentation
parameter_list|()
block|{
name|Node
name|result
init|=
literal|null
decl_stmt|;
try|try
block|{
name|DocumentBuilder
name|documentBuilder
init|=
name|DocumentBuilderFactory
operator|.
name|newInstance
argument_list|()
operator|.
name|newDocumentBuilder
argument_list|()
decl_stmt|;
name|result
operator|=
name|getDOMrepresentation
argument_list|(
name|documentBuilder
operator|.
name|newDocument
argument_list|()
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|ParserConfigurationException
name|e
parameter_list|)
block|{
name|LOGGER
operator|.
name|warn
argument_list|(
literal|"Could not create DocumentBuilder"
argument_list|,
name|e
argument_list|)
expr_stmt|;
block|}
return|return
name|result
return|;
block|}
DECL|method|addField (Document document, Element parent, String name, String value)
specifier|private
name|void
name|addField
parameter_list|(
name|Document
name|document
parameter_list|,
name|Element
name|parent
parameter_list|,
name|String
name|name
parameter_list|,
name|String
name|value
parameter_list|)
block|{
if|if
condition|(
name|value
operator|==
literal|null
condition|)
block|{
return|return;
block|}
name|Element
name|elem
init|=
name|document
operator|.
name|createElement
argument_list|(
name|B_COLON
operator|+
name|name
argument_list|)
decl_stmt|;
name|elem
operator|.
name|appendChild
argument_list|(
name|document
operator|.
name|createTextNode
argument_list|(
name|StringUtil
operator|.
name|stripNonValidXMLCharacters
argument_list|(
name|value
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|parent
operator|.
name|appendChild
argument_list|(
name|elem
argument_list|)
expr_stmt|;
block|}
DECL|method|addAuthor (Document document, Element allAuthors, String entryName, List<PersonName> authorsLst)
specifier|private
name|void
name|addAuthor
parameter_list|(
name|Document
name|document
parameter_list|,
name|Element
name|allAuthors
parameter_list|,
name|String
name|entryName
parameter_list|,
name|List
argument_list|<
name|PersonName
argument_list|>
name|authorsLst
parameter_list|)
block|{
if|if
condition|(
name|authorsLst
operator|==
literal|null
condition|)
block|{
return|return;
block|}
name|Element
name|authorTop
init|=
name|document
operator|.
name|createElement
argument_list|(
name|B_COLON
operator|+
name|entryName
argument_list|)
decl_stmt|;
name|Element
name|nameList
init|=
name|document
operator|.
name|createElement
argument_list|(
name|B_COLON
operator|+
literal|"NameList"
argument_list|)
decl_stmt|;
for|for
control|(
name|PersonName
name|name
range|:
name|authorsLst
control|)
block|{
name|Element
name|person
init|=
name|document
operator|.
name|createElement
argument_list|(
name|B_COLON
operator|+
literal|"Person"
argument_list|)
decl_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|person
argument_list|,
literal|"Last"
argument_list|,
name|name
operator|.
name|getSurname
argument_list|()
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|person
argument_list|,
literal|"Middle"
argument_list|,
name|name
operator|.
name|getMiddlename
argument_list|()
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|person
argument_list|,
literal|"First"
argument_list|,
name|name
operator|.
name|getFirstname
argument_list|()
argument_list|)
expr_stmt|;
name|nameList
operator|.
name|appendChild
argument_list|(
name|person
argument_list|)
expr_stmt|;
block|}
name|authorTop
operator|.
name|appendChild
argument_list|(
name|nameList
argument_list|)
expr_stmt|;
name|allAuthors
operator|.
name|appendChild
argument_list|(
name|authorTop
argument_list|)
expr_stmt|;
block|}
DECL|method|addAddress (Document document, Element parent, String address)
specifier|private
name|void
name|addAddress
parameter_list|(
name|Document
name|document
parameter_list|,
name|Element
name|parent
parameter_list|,
name|String
name|address
parameter_list|)
block|{
if|if
condition|(
name|address
operator|==
literal|null
condition|)
block|{
return|return;
block|}
name|Matcher
name|matcher
init|=
name|ADDRESS_PATTERN
operator|.
name|matcher
argument_list|(
name|address
argument_list|)
decl_stmt|;
if|if
condition|(
name|matcher
operator|.
name|matches
argument_list|()
operator|&&
operator|(
name|matcher
operator|.
name|groupCount
argument_list|()
operator|>
literal|3
operator|)
condition|)
block|{
name|addField
argument_list|(
name|document
argument_list|,
name|parent
argument_list|,
literal|"City"
argument_list|,
name|matcher
operator|.
name|group
argument_list|(
literal|1
argument_list|)
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|parent
argument_list|,
literal|"StateProvince"
argument_list|,
name|matcher
operator|.
name|group
argument_list|(
literal|2
argument_list|)
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|parent
argument_list|,
literal|"CountryRegion"
argument_list|,
name|matcher
operator|.
name|group
argument_list|(
literal|3
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
comment|/* SM: 2010.10 generalized */
name|addField
argument_list|(
name|document
argument_list|,
name|parent
argument_list|,
literal|"City"
argument_list|,
name|address
argument_list|)
expr_stmt|;
block|}
block|}
DECL|method|addDate (Document document, Element parent, String date, String extra)
specifier|private
name|void
name|addDate
parameter_list|(
name|Document
name|document
parameter_list|,
name|Element
name|parent
parameter_list|,
name|String
name|date
parameter_list|,
name|String
name|extra
parameter_list|)
block|{
if|if
condition|(
name|date
operator|==
literal|null
condition|)
block|{
return|return;
block|}
name|Matcher
name|matcher
init|=
name|DATE_PATTERN
operator|.
name|matcher
argument_list|(
name|date
argument_list|)
decl_stmt|;
if|if
condition|(
name|matcher
operator|.
name|matches
argument_list|()
operator|&&
operator|(
name|matcher
operator|.
name|groupCount
argument_list|()
operator|>
literal|3
operator|)
condition|)
block|{
name|addField
argument_list|(
name|document
argument_list|,
name|parent
argument_list|,
literal|"Month"
operator|+
name|extra
argument_list|,
name|matcher
operator|.
name|group
argument_list|(
literal|1
argument_list|)
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|parent
argument_list|,
literal|"Day"
operator|+
name|extra
argument_list|,
name|matcher
operator|.
name|group
argument_list|(
literal|2
argument_list|)
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|parent
argument_list|,
literal|"Year"
operator|+
name|extra
argument_list|,
name|matcher
operator|.
name|group
argument_list|(
literal|3
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
DECL|method|getDOMrepresentation (Document document)
specifier|public
name|Element
name|getDOMrepresentation
parameter_list|(
name|Document
name|document
parameter_list|)
block|{
name|Element
name|msbibEntry
init|=
name|document
operator|.
name|createElement
argument_list|(
name|B_COLON
operator|+
literal|"Source"
argument_list|)
decl_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"SourceType"
argument_list|,
name|sourceType
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
name|BIBTEX
operator|+
literal|"Entry"
argument_list|,
name|bibTexEntry
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"Tag"
argument_list|,
name|tag
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"GUID"
argument_list|,
name|GUID
argument_list|)
expr_stmt|;
if|if
condition|(
name|LCID
operator|>=
literal|0
condition|)
block|{
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"LCID"
argument_list|,
name|Integer
operator|.
name|toString
argument_list|(
name|LCID
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"Title"
argument_list|,
name|title
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"Year"
argument_list|,
name|year
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"ShortTitle"
argument_list|,
name|shortTitle
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"Comments"
argument_list|,
name|comments
argument_list|)
expr_stmt|;
name|Element
name|allAuthors
init|=
name|document
operator|.
name|createElement
argument_list|(
name|B_COLON
operator|+
literal|"Author"
argument_list|)
decl_stmt|;
name|addAuthor
argument_list|(
name|document
argument_list|,
name|allAuthors
argument_list|,
literal|"Author"
argument_list|,
name|authors
argument_list|)
expr_stmt|;
name|String
name|bookAuthor
init|=
literal|"BookAuthor"
decl_stmt|;
name|addAuthor
argument_list|(
name|document
argument_list|,
name|allAuthors
argument_list|,
name|bookAuthor
argument_list|,
name|bookAuthors
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|document
argument_list|,
name|allAuthors
argument_list|,
literal|"Editor"
argument_list|,
name|editors
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|document
argument_list|,
name|allAuthors
argument_list|,
literal|"Translator"
argument_list|,
name|translators
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|document
argument_list|,
name|allAuthors
argument_list|,
literal|"ProducerName"
argument_list|,
name|producerNames
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|document
argument_list|,
name|allAuthors
argument_list|,
literal|"Composer"
argument_list|,
name|composers
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|document
argument_list|,
name|allAuthors
argument_list|,
literal|"Conductor"
argument_list|,
name|conductors
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|document
argument_list|,
name|allAuthors
argument_list|,
literal|"Performer"
argument_list|,
name|performers
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|document
argument_list|,
name|allAuthors
argument_list|,
literal|"Writer"
argument_list|,
name|writers
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|document
argument_list|,
name|allAuthors
argument_list|,
literal|"Director"
argument_list|,
name|directors
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|document
argument_list|,
name|allAuthors
argument_list|,
literal|"Compiler"
argument_list|,
name|compilers
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|document
argument_list|,
name|allAuthors
argument_list|,
literal|"Interviewer"
argument_list|,
name|interviewers
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|document
argument_list|,
name|allAuthors
argument_list|,
literal|"Interviewee"
argument_list|,
name|interviewees
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|document
argument_list|,
name|allAuthors
argument_list|,
literal|"Inventor"
argument_list|,
name|inventors
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|document
argument_list|,
name|allAuthors
argument_list|,
literal|"Counsel"
argument_list|,
name|counsels
argument_list|)
expr_stmt|;
name|msbibEntry
operator|.
name|appendChild
argument_list|(
name|allAuthors
argument_list|)
expr_stmt|;
if|if
condition|(
name|pages
operator|!=
literal|null
condition|)
block|{
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"Pages"
argument_list|,
name|pages
operator|.
name|toString
argument_list|(
literal|"-"
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"Volume"
argument_list|,
name|volume
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"NumberVolumes"
argument_list|,
name|numberOfVolumes
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"Edition"
argument_list|,
name|edition
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"StandardNumber"
argument_list|,
name|standardNumber
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"Publisher"
argument_list|,
name|publisher
argument_list|)
expr_stmt|;
name|addAddress
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
name|address
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"BookTitle"
argument_list|,
name|bookTitle
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"ChapterNumber"
argument_list|,
name|chapterNumber
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"JournalName"
argument_list|,
name|journalName
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"Issue"
argument_list|,
name|issue
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"PeriodicalTitle"
argument_list|,
name|periodicalTitle
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"ConferenceName"
argument_list|,
name|conferenceName
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"Department"
argument_list|,
name|department
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"Institution"
argument_list|,
name|institution
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"ThesisType"
argument_list|,
name|thesisType
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"InternetSiteTitle"
argument_list|,
name|internetSiteTitle
argument_list|)
expr_stmt|;
name|addDate
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
name|dateAccessed
argument_list|,
literal|"Accessed"
argument_list|)
expr_stmt|;
comment|/* SM 2010.10 added month export */
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"Month"
argument_list|,
name|month
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"URL"
argument_list|,
name|url
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"ProductionCompany"
argument_list|,
name|productionCompany
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"PublicationTitle"
argument_list|,
name|publicationTitle
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"Medium"
argument_list|,
name|medium
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"AlbumTitle"
argument_list|,
name|albumTitle
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"RecordingNumber"
argument_list|,
name|recordingNumber
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"Theater"
argument_list|,
name|theater
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"Distributor"
argument_list|,
name|distributor
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"BroadcastTitle"
argument_list|,
name|broadcastTitle
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"Broadcaster"
argument_list|,
name|broadcaster
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"Station"
argument_list|,
name|station
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"Type"
argument_list|,
name|type
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"PatentNumber"
argument_list|,
name|patentNumber
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"Court"
argument_list|,
name|court
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"Reporter"
argument_list|,
name|reporter
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"CaseNumber"
argument_list|,
name|caseNumber
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
literal|"AbbreviatedCaseNumber"
argument_list|,
name|abbreviatedCaseNumber
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
name|BIBTEX
operator|+
literal|"Series"
argument_list|,
name|bibTexSeries
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
name|BIBTEX
operator|+
literal|"Abstract"
argument_list|,
name|bibTexAbstract
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
name|BIBTEX
operator|+
literal|"KeyWords"
argument_list|,
name|bibTexKeyWords
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
name|BIBTEX
operator|+
literal|"CrossRef"
argument_list|,
name|bibTexCrossRef
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
name|BIBTEX
operator|+
literal|"HowPublished"
argument_list|,
name|bibTex_HowPublished
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
name|BIBTEX
operator|+
literal|"Affiliation"
argument_list|,
name|bibTexAffiliation
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
name|BIBTEX
operator|+
literal|"Contents"
argument_list|,
name|bibTexContents
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
name|BIBTEX
operator|+
literal|"Copyright"
argument_list|,
name|bibTexCopyright
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
name|BIBTEX
operator|+
literal|"Price"
argument_list|,
name|bibTexPrice
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
name|BIBTEX
operator|+
literal|"Size"
argument_list|,
name|bibTexSize
argument_list|)
expr_stmt|;
comment|/* SM: 2010.10 end intype, paper support */
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
name|BIBTEX
operator|+
literal|"InType"
argument_list|,
name|bibTexInType
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|document
argument_list|,
name|msbibEntry
argument_list|,
name|BIBTEX
operator|+
literal|"Paper"
argument_list|,
name|bibTexPaper
argument_list|)
expr_stmt|;
return|return
name|msbibEntry
return|;
block|}
DECL|method|parseSingleStandardNumber (String type, String bibtype, String standardNum, Map<String, String> map)
specifier|private
name|void
name|parseSingleStandardNumber
parameter_list|(
name|String
name|type
parameter_list|,
name|String
name|bibtype
parameter_list|,
name|String
name|standardNum
parameter_list|,
name|Map
argument_list|<
name|String
argument_list|,
name|String
argument_list|>
name|map
parameter_list|)
block|{
comment|// tested using http://www.javaregex.com/test.html
name|Pattern
name|pattern
init|=
name|Pattern
operator|.
name|compile
argument_list|(
literal|':'
operator|+
name|type
operator|+
literal|":(.[^:]+)"
argument_list|)
decl_stmt|;
name|Matcher
name|matcher
init|=
name|pattern
operator|.
name|matcher
argument_list|(
name|standardNum
argument_list|)
decl_stmt|;
if|if
condition|(
name|matcher
operator|.
name|matches
argument_list|()
condition|)
block|{
name|map
operator|.
name|put
argument_list|(
name|bibtype
argument_list|,
name|matcher
operator|.
name|group
argument_list|(
literal|1
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
DECL|method|parseStandardNumber (String standardNum, Map<String, String> map)
specifier|private
name|void
name|parseStandardNumber
parameter_list|(
name|String
name|standardNum
parameter_list|,
name|Map
argument_list|<
name|String
argument_list|,
name|String
argument_list|>
name|map
parameter_list|)
block|{
if|if
condition|(
name|standardNumber
operator|==
literal|null
condition|)
block|{
return|return;
block|}
name|parseSingleStandardNumber
argument_list|(
literal|"ISBN"
argument_list|,
literal|"isbn"
argument_list|,
name|standardNum
argument_list|,
name|map
argument_list|)
expr_stmt|;
comment|/* SM: 2010.10: lower case */
name|parseSingleStandardNumber
argument_list|(
literal|"ISSN"
argument_list|,
literal|"issn"
argument_list|,
name|standardNum
argument_list|,
name|map
argument_list|)
expr_stmt|;
comment|/* SM: 2010.10: lower case */
name|parseSingleStandardNumber
argument_list|(
literal|"LCCN"
argument_list|,
literal|"lccn"
argument_list|,
name|standardNum
argument_list|,
name|map
argument_list|)
expr_stmt|;
comment|/* SM: 2010.10: lower case */
name|parseSingleStandardNumber
argument_list|(
literal|"MRN"
argument_list|,
literal|"mrnumber"
argument_list|,
name|standardNum
argument_list|,
name|map
argument_list|)
expr_stmt|;
comment|/* SM: 2010.10 begin DOI support */
name|parseSingleStandardNumber
argument_list|(
literal|"DOI"
argument_list|,
literal|"doi"
argument_list|,
name|standardNum
argument_list|,
name|map
argument_list|)
expr_stmt|;
comment|/* SM: 2010.10 end DOI support */
block|}
DECL|method|addAuthor (Map<String, String> map, String type, List<PersonName> authors)
specifier|private
name|void
name|addAuthor
parameter_list|(
name|Map
argument_list|<
name|String
argument_list|,
name|String
argument_list|>
name|map
parameter_list|,
name|String
name|type
parameter_list|,
name|List
argument_list|<
name|PersonName
argument_list|>
name|authors
parameter_list|)
block|{
if|if
condition|(
name|authors
operator|==
literal|null
condition|)
block|{
return|return;
block|}
name|String
name|allAuthors
init|=
name|authors
operator|.
name|stream
argument_list|()
operator|.
name|map
argument_list|(
name|name
lambda|->
name|name
operator|.
name|getFullname
argument_list|()
argument_list|)
operator|.
name|collect
argument_list|(
name|Collectors
operator|.
name|joining
argument_list|(
literal|" and "
argument_list|)
argument_list|)
decl_stmt|;
name|map
operator|.
name|put
argument_list|(
name|type
argument_list|,
name|allAuthors
argument_list|)
expr_stmt|;
block|}
DECL|method|mapMSBibToBibtexType (String msbib)
specifier|private
name|EntryType
name|mapMSBibToBibtexType
parameter_list|(
name|String
name|msbib
parameter_list|)
block|{
name|EntryType
name|bibtex
decl_stmt|;
if|if
condition|(
literal|"Book"
operator|.
name|equals
argument_list|(
name|msbib
argument_list|)
condition|)
block|{
name|bibtex
operator|=
name|BibtexEntryTypes
operator|.
name|BOOK
expr_stmt|;
block|}
elseif|else
if|if
condition|(
literal|"BookSection"
operator|.
name|equals
argument_list|(
name|msbib
argument_list|)
condition|)
block|{
name|bibtex
operator|=
name|BibtexEntryTypes
operator|.
name|INBOOK
expr_stmt|;
block|}
elseif|else
if|if
condition|(
literal|"JournalArticle"
operator|.
name|equals
argument_list|(
name|msbib
argument_list|)
operator|||
literal|"ArticleInAPeriodical"
operator|.
name|equals
argument_list|(
name|msbib
argument_list|)
condition|)
block|{
name|bibtex
operator|=
name|BibtexEntryTypes
operator|.
name|ARTICLE
expr_stmt|;
block|}
elseif|else
if|if
condition|(
literal|"ConferenceProceedings"
operator|.
name|equals
argument_list|(
name|msbib
argument_list|)
condition|)
block|{
name|bibtex
operator|=
name|BibtexEntryTypes
operator|.
name|CONFERENCE
expr_stmt|;
block|}
elseif|else
if|if
condition|(
literal|"Report"
operator|.
name|equals
argument_list|(
name|msbib
argument_list|)
condition|)
block|{
name|bibtex
operator|=
name|BibtexEntryTypes
operator|.
name|TECHREPORT
expr_stmt|;
block|}
elseif|else
if|if
condition|(
literal|"InternetSite"
operator|.
name|equals
argument_list|(
name|msbib
argument_list|)
operator|||
literal|"DocumentFromInternetSite"
operator|.
name|equals
argument_list|(
name|msbib
argument_list|)
operator|||
literal|"ElectronicSource"
operator|.
name|equals
argument_list|(
name|msbib
argument_list|)
operator|||
literal|"Art"
operator|.
name|equals
argument_list|(
name|msbib
argument_list|)
operator|||
literal|"SoundRecording"
operator|.
name|equals
argument_list|(
name|msbib
argument_list|)
operator|||
literal|"Performance"
operator|.
name|equals
argument_list|(
name|msbib
argument_list|)
operator|||
literal|"Film"
operator|.
name|equals
argument_list|(
name|msbib
argument_list|)
operator|||
literal|"Interview"
operator|.
name|equals
argument_list|(
name|msbib
argument_list|)
operator|||
literal|"Patent"
operator|.
name|equals
argument_list|(
name|msbib
argument_list|)
operator|||
literal|"Case"
operator|.
name|equals
argument_list|(
name|msbib
argument_list|)
condition|)
block|{
name|bibtex
operator|=
name|BibtexEntryTypes
operator|.
name|MISC
expr_stmt|;
block|}
else|else
block|{
name|bibtex
operator|=
name|BibtexEntryTypes
operator|.
name|MISC
expr_stmt|;
block|}
return|return
name|bibtex
return|;
block|}
DECL|method|getBibtexRepresentation ()
specifier|public
name|BibEntry
name|getBibtexRepresentation
parameter_list|()
block|{
name|BibEntry
name|entry
decl_stmt|;
if|if
condition|(
name|tag
operator|==
literal|null
condition|)
block|{
name|entry
operator|=
operator|new
name|BibEntry
argument_list|(
name|ImportFormat
operator|.
name|DEFAULT_BIBTEXENTRY_ID
argument_list|,
name|mapMSBibToBibtexType
argument_list|(
name|sourceType
argument_list|)
operator|.
name|getName
argument_list|()
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|entry
operator|=
operator|new
name|BibEntry
argument_list|(
name|tag
argument_list|,
name|mapMSBibToBibtexType
argument_list|(
name|sourceType
argument_list|)
operator|.
name|getName
argument_list|()
argument_list|)
expr_stmt|;
comment|// id assumes an existing database so don't
block|}
comment|// Todo: add check for BibTexEntry types
name|HashMap
argument_list|<
name|String
argument_list|,
name|String
argument_list|>
name|hm
init|=
operator|new
name|HashMap
argument_list|<>
argument_list|()
decl_stmt|;
if|if
condition|(
name|tag
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
name|BibEntry
operator|.
name|KEY_FIELD
argument_list|,
name|tag
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|LCID
operator|>=
literal|0
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"language"
argument_list|,
name|getLanguage
argument_list|(
name|LCID
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|title
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"title"
argument_list|,
name|title
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|year
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"year"
argument_list|,
name|year
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|shortTitle
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"shorttitle"
argument_list|,
name|shortTitle
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|comments
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"note"
argument_list|,
name|comments
argument_list|)
expr_stmt|;
block|}
name|addAuthor
argument_list|(
name|hm
argument_list|,
literal|"author"
argument_list|,
name|authors
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
name|MSBIB
operator|+
literal|"bookauthor"
argument_list|,
name|bookAuthors
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
literal|"editor"
argument_list|,
name|editors
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
name|MSBIB
operator|+
literal|"translator"
argument_list|,
name|translators
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
name|MSBIB
operator|+
literal|"producername"
argument_list|,
name|producerNames
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
name|MSBIB
operator|+
literal|"composer"
argument_list|,
name|composers
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
name|MSBIB
operator|+
literal|"conductor"
argument_list|,
name|conductors
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
name|MSBIB
operator|+
literal|"performer"
argument_list|,
name|performers
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
name|MSBIB
operator|+
literal|"writer"
argument_list|,
name|writers
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
name|MSBIB
operator|+
literal|"director"
argument_list|,
name|directors
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
name|MSBIB
operator|+
literal|"compiler"
argument_list|,
name|compilers
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
name|MSBIB
operator|+
literal|"interviewer"
argument_list|,
name|interviewers
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
name|MSBIB
operator|+
literal|"interviewee"
argument_list|,
name|interviewees
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
name|MSBIB
operator|+
literal|"inventor"
argument_list|,
name|inventors
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
name|MSBIB
operator|+
literal|"counsel"
argument_list|,
name|counsels
argument_list|)
expr_stmt|;
if|if
condition|(
name|pages
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"pages"
argument_list|,
name|pages
operator|.
name|toString
argument_list|(
literal|"--"
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|volume
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"volume"
argument_list|,
name|volume
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|numberOfVolumes
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"numberofvolume"
argument_list|,
name|numberOfVolumes
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|edition
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"edition"
argument_list|,
name|edition
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|edition
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"edition"
argument_list|,
name|edition
argument_list|)
expr_stmt|;
block|}
name|parseStandardNumber
argument_list|(
name|standardNumber
argument_list|,
name|hm
argument_list|)
expr_stmt|;
if|if
condition|(
name|publisher
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"publisher"
argument_list|,
name|publisher
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|publisher
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"publisher"
argument_list|,
name|publisher
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|address
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"address"
argument_list|,
name|address
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bookTitle
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"booktitle"
argument_list|,
name|bookTitle
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|chapterNumber
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"chapter"
argument_list|,
name|chapterNumber
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|journalName
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"journal"
argument_list|,
name|journalName
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|issue
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"number"
argument_list|,
name|issue
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|month
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"month"
argument_list|,
name|month
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|periodicalTitle
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"organization"
argument_list|,
name|periodicalTitle
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|conferenceName
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"organization"
argument_list|,
name|conferenceName
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|department
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"school"
argument_list|,
name|department
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|institution
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"institution"
argument_list|,
name|institution
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|dateAccessed
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"accessed"
argument_list|,
name|dateAccessed
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|url
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"url"
argument_list|,
name|url
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|productionCompany
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"productioncompany"
argument_list|,
name|productionCompany
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|medium
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"medium"
argument_list|,
name|medium
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|recordingNumber
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"recordingnumber"
argument_list|,
name|recordingNumber
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|theater
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"theater"
argument_list|,
name|theater
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|distributor
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"distributor"
argument_list|,
name|distributor
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|broadcaster
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"broadcaster"
argument_list|,
name|broadcaster
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|station
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"station"
argument_list|,
name|station
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|type
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"type"
argument_list|,
name|type
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|patentNumber
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"patentnumber"
argument_list|,
name|patentNumber
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|court
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"court"
argument_list|,
name|court
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|reporter
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"reporter"
argument_list|,
name|reporter
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|caseNumber
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"casenumber"
argument_list|,
name|caseNumber
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|abbreviatedCaseNumber
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"abbreviatedcasenumber"
argument_list|,
name|abbreviatedCaseNumber
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibTexSeries
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"series"
argument_list|,
name|bibTexSeries
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibTexAbstract
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"abstract"
argument_list|,
name|bibTexAbstract
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibTexKeyWords
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"keywords"
argument_list|,
name|bibTexKeyWords
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibTexCrossRef
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"crossref"
argument_list|,
name|bibTexCrossRef
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibTex_HowPublished
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"howpublished"
argument_list|,
name|bibTex_HowPublished
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibTexAffiliation
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"affiliation"
argument_list|,
name|bibTexAffiliation
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibTexContents
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"contents"
argument_list|,
name|bibTexContents
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibTexCopyright
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"copyright"
argument_list|,
name|bibTexCopyright
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibTexPrice
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"price"
argument_list|,
name|bibTexPrice
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|bibTexSize
operator|!=
literal|null
condition|)
block|{
name|hm
operator|.
name|put
argument_list|(
literal|"size"
argument_list|,
name|bibTexSize
argument_list|)
expr_stmt|;
block|}
name|entry
operator|.
name|setField
argument_list|(
name|hm
argument_list|)
expr_stmt|;
return|return
name|entry
return|;
block|}
comment|/*      * render as XML      *      * TODO This is untested.      */
annotation|@
name|Override
DECL|method|toString ()
specifier|public
name|String
name|toString
parameter_list|()
block|{
name|StringWriter
name|result
init|=
operator|new
name|StringWriter
argument_list|()
decl_stmt|;
try|try
block|{
name|DOMSource
name|source
init|=
operator|new
name|DOMSource
argument_list|(
name|getDOMrepresentation
argument_list|()
argument_list|)
decl_stmt|;
name|StreamResult
name|streamResult
init|=
operator|new
name|StreamResult
argument_list|(
name|result
argument_list|)
decl_stmt|;
name|Transformer
name|trans
init|=
name|TransformerFactory
operator|.
name|newInstance
argument_list|()
operator|.
name|newTransformer
argument_list|()
decl_stmt|;
name|trans
operator|.
name|setOutputProperty
argument_list|(
name|OutputKeys
operator|.
name|INDENT
argument_list|,
literal|"yes"
argument_list|)
expr_stmt|;
name|trans
operator|.
name|transform
argument_list|(
name|source
argument_list|,
name|streamResult
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|TransformerException
name|e
parameter_list|)
block|{
name|LOGGER
operator|.
name|warn
argument_list|(
literal|"Could not build XML representation"
argument_list|,
name|e
argument_list|)
expr_stmt|;
block|}
return|return
name|result
operator|.
name|toString
argument_list|()
return|;
block|}
block|}
end_class

end_unit

