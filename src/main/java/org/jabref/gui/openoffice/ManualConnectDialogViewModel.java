begin_unit|revision:0.9.5;language:Java;cregit-version:0.0.1
begin_package
DECL|package|org.jabref.gui.openoffice
package|package
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|openoffice
package|;
end_package

begin_import
import|import
name|javafx
operator|.
name|beans
operator|.
name|property
operator|.
name|SimpleStringProperty
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|beans
operator|.
name|property
operator|.
name|StringProperty
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|DialogService
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|desktop
operator|.
name|JabRefDesktop
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|desktop
operator|.
name|os
operator|.
name|NativeDesktop
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|util
operator|.
name|DirectoryDialogConfiguration
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|util
operator|.
name|FileDialogConfiguration
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|logic
operator|.
name|openoffice
operator|.
name|OpenOfficePreferences
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|logic
operator|.
name|util
operator|.
name|OS
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|preferences
operator|.
name|PreferencesService
import|;
end_import

begin_class
DECL|class|ManualConnectDialogViewModel
specifier|public
class|class
name|ManualConnectDialogViewModel
block|{
DECL|field|ooPath
specifier|private
specifier|final
name|StringProperty
name|ooPath
init|=
operator|new
name|SimpleStringProperty
argument_list|(
literal|""
argument_list|)
decl_stmt|;
DECL|field|ooExec
specifier|private
specifier|final
name|StringProperty
name|ooExec
init|=
operator|new
name|SimpleStringProperty
argument_list|(
literal|""
argument_list|)
decl_stmt|;
DECL|field|ooJars
specifier|private
specifier|final
name|StringProperty
name|ooJars
init|=
operator|new
name|SimpleStringProperty
argument_list|(
literal|""
argument_list|)
decl_stmt|;
DECL|field|dialogService
specifier|private
specifier|final
name|DialogService
name|dialogService
decl_stmt|;
DECL|field|nativeDesktop
specifier|private
specifier|final
name|NativeDesktop
name|nativeDesktop
init|=
name|JabRefDesktop
operator|.
name|getNativeDesktop
argument_list|()
decl_stmt|;
DECL|field|fileDialogConfiguration
specifier|private
specifier|final
name|FileDialogConfiguration
name|fileDialogConfiguration
decl_stmt|;
DECL|field|dirDialogConfiguration
specifier|private
specifier|final
name|DirectoryDialogConfiguration
name|dirDialogConfiguration
decl_stmt|;
DECL|field|ooPreferences
specifier|private
specifier|final
name|OpenOfficePreferences
name|ooPreferences
decl_stmt|;
DECL|field|preferencesService
specifier|private
specifier|final
name|PreferencesService
name|preferencesService
decl_stmt|;
DECL|method|ManualConnectDialogViewModel (PreferencesService preferencesService, DialogService dialogService)
specifier|public
name|ManualConnectDialogViewModel
parameter_list|(
name|PreferencesService
name|preferencesService
parameter_list|,
name|DialogService
name|dialogService
parameter_list|)
block|{
name|this
operator|.
name|dialogService
operator|=
name|dialogService
expr_stmt|;
name|this
operator|.
name|preferencesService
operator|=
name|preferencesService
expr_stmt|;
name|ooPreferences
operator|=
name|preferencesService
operator|.
name|getOpenOfficePreferences
argument_list|()
expr_stmt|;
name|ooPathProperty
argument_list|()
operator|.
name|setValue
argument_list|(
name|ooPreferences
operator|.
name|getInstallationPath
argument_list|()
argument_list|)
expr_stmt|;
name|ooExecProperty
argument_list|()
operator|.
name|setValue
argument_list|(
name|ooPreferences
operator|.
name|getExecutablePath
argument_list|()
argument_list|)
expr_stmt|;
name|ooJarsProperty
argument_list|()
operator|.
name|setValue
argument_list|(
name|ooPreferences
operator|.
name|getJarsPath
argument_list|()
argument_list|)
expr_stmt|;
name|dirDialogConfiguration
operator|=
operator|new
name|DirectoryDialogConfiguration
operator|.
name|Builder
argument_list|()
operator|.
name|withInitialDirectory
argument_list|(
name|nativeDesktop
operator|.
name|getApplicationDirectory
argument_list|()
argument_list|)
operator|.
name|build
argument_list|()
expr_stmt|;
name|fileDialogConfiguration
operator|=
operator|new
name|FileDialogConfiguration
operator|.
name|Builder
argument_list|()
operator|.
name|withInitialDirectory
argument_list|(
name|nativeDesktop
operator|.
name|getApplicationDirectory
argument_list|()
argument_list|)
operator|.
name|build
argument_list|()
expr_stmt|;
block|}
DECL|method|browseOOPath ()
specifier|public
name|void
name|browseOOPath
parameter_list|()
block|{
name|dialogService
operator|.
name|showDirectorySelectionDialog
argument_list|(
name|dirDialogConfiguration
argument_list|)
operator|.
name|ifPresent
argument_list|(
name|path
lambda|->
name|ooPath
operator|.
name|setValue
argument_list|(
name|path
operator|.
name|toAbsolutePath
argument_list|()
operator|.
name|toString
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
DECL|method|browseOOExec ()
specifier|public
name|void
name|browseOOExec
parameter_list|()
block|{
name|dialogService
operator|.
name|showFileOpenDialog
argument_list|(
name|fileDialogConfiguration
argument_list|)
operator|.
name|ifPresent
argument_list|(
name|f
lambda|->
name|ooExec
operator|.
name|setValue
argument_list|(
name|f
operator|.
name|toAbsolutePath
argument_list|()
operator|.
name|toString
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
DECL|method|browseOOJars ()
specifier|public
name|void
name|browseOOJars
parameter_list|()
block|{
name|dialogService
operator|.
name|showDirectorySelectionDialog
argument_list|(
name|dirDialogConfiguration
argument_list|)
operator|.
name|ifPresent
argument_list|(
name|path
lambda|->
name|ooJars
operator|.
name|setValue
argument_list|(
name|path
operator|.
name|toAbsolutePath
argument_list|()
operator|.
name|toString
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
DECL|method|ooPathProperty ()
specifier|public
name|StringProperty
name|ooPathProperty
parameter_list|()
block|{
return|return
name|ooPath
return|;
block|}
DECL|method|ooExecProperty ()
specifier|public
name|StringProperty
name|ooExecProperty
parameter_list|()
block|{
return|return
name|ooExec
return|;
block|}
DECL|method|ooJarsProperty ()
specifier|public
name|StringProperty
name|ooJarsProperty
parameter_list|()
block|{
return|return
name|ooJars
return|;
block|}
DECL|method|save ()
specifier|public
name|void
name|save
parameter_list|()
block|{
if|if
condition|(
name|OS
operator|.
name|WINDOWS
operator|||
name|OS
operator|.
name|OS_X
condition|)
block|{
name|ooPreferences
operator|.
name|updateConnectionParams
argument_list|(
name|ooPath
operator|.
name|getValue
argument_list|()
argument_list|,
name|ooPath
operator|.
name|getValue
argument_list|()
argument_list|,
name|ooPath
operator|.
name|getValue
argument_list|()
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|ooPreferences
operator|.
name|updateConnectionParams
argument_list|(
name|ooPath
operator|.
name|getValue
argument_list|()
argument_list|,
name|ooExec
operator|.
name|getValue
argument_list|()
argument_list|,
name|ooJars
operator|.
name|getValue
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|preferencesService
operator|.
name|setOpenOfficePreferences
argument_list|(
name|ooPreferences
argument_list|)
expr_stmt|;
block|}
block|}
end_class

end_unit

