begin_unit|revision:0.9.5;language:Java;cregit-version:0.0.1
begin_package
DECL|package|org.jabref.gui
package|package
name|org
operator|.
name|jabref
operator|.
name|gui
package|;
end_package

begin_import
import|import
name|java
operator|.
name|awt
operator|.
name|Window
import|;
end_import

begin_import
import|import
name|java
operator|.
name|io
operator|.
name|File
import|;
end_import

begin_import
import|import
name|java
operator|.
name|io
operator|.
name|IOException
import|;
end_import

begin_import
import|import
name|java
operator|.
name|nio
operator|.
name|file
operator|.
name|Path
import|;
end_import

begin_import
import|import
name|java
operator|.
name|nio
operator|.
name|file
operator|.
name|Paths
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|ArrayList
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|HashMap
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|List
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Map
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Objects
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Optional
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|TimerTask
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|stream
operator|.
name|Collectors
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|JOptionPane
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|SwingUtilities
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|application
operator|.
name|Platform
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|beans
operator|.
name|value
operator|.
name|ChangeListener
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|beans
operator|.
name|value
operator|.
name|ObservableValue
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|geometry
operator|.
name|Orientation
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|Node
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|control
operator|.
name|Alert
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|control
operator|.
name|Button
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|control
operator|.
name|ButtonBar
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|control
operator|.
name|ButtonType
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|control
operator|.
name|Menu
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|control
operator|.
name|MenuBar
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|control
operator|.
name|MenuItem
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|control
operator|.
name|ProgressBar
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|control
operator|.
name|Separator
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|control
operator|.
name|SeparatorMenuItem
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|control
operator|.
name|SplitPane
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|control
operator|.
name|Tab
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|control
operator|.
name|TabPane
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|control
operator|.
name|TextInputControl
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|control
operator|.
name|ToolBar
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|control
operator|.
name|Tooltip
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|input
operator|.
name|DataFormat
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|input
operator|.
name|KeyEvent
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|input
operator|.
name|TransferMode
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|layout
operator|.
name|BorderPane
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|layout
operator|.
name|HBox
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|layout
operator|.
name|Pane
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|layout
operator|.
name|Priority
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|stage
operator|.
name|Stage
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|Globals
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|JabRefExecutorService
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|actions
operator|.
name|ActionFactory
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|actions
operator|.
name|Actions
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|actions
operator|.
name|OldDatabaseCommandWrapper
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|actions
operator|.
name|SimpleCommand
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|actions
operator|.
name|StandardActions
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|auximport
operator|.
name|NewSubLibraryAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|bibtexkeypattern
operator|.
name|BibtexKeyPatternAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|contentselector
operator|.
name|ManageContentSelectorAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|copyfiles
operator|.
name|CopyFilesAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|customizefields
operator|.
name|SetupGeneralFieldsAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|dialogs
operator|.
name|AutosaveUIManager
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|documentviewer
operator|.
name|ShowDocumentViewerAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|duplicationFinder
operator|.
name|DuplicateSearch
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|edit
operator|.
name|ManageKeywordsAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|edit
operator|.
name|MassSetFieldsAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|edit
operator|.
name|OpenBrowserAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|exporter
operator|.
name|ExportCommand
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|exporter
operator|.
name|ExportToClipboardAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|exporter
operator|.
name|ManageCustomExportsAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|exporter
operator|.
name|SaveAllAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|exporter
operator|.
name|SaveDatabaseAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|externalfiles
operator|.
name|AutoLinkFilesAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|externalfiles
operator|.
name|FindUnlinkedFilesAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|externalfiletype
operator|.
name|EditExternalFileTypesAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|externalfiletype
operator|.
name|ExternalFileTypes
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|help
operator|.
name|AboutAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|help
operator|.
name|ErrorConsoleAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|help
operator|.
name|HelpAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|help
operator|.
name|SearchForUpdateAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|importer
operator|.
name|ImportCommand
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|importer
operator|.
name|ImportEntriesDialog
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|importer
operator|.
name|ManageCustomImportsAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|importer
operator|.
name|NewDatabaseAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|importer
operator|.
name|NewEntryAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|importer
operator|.
name|actions
operator|.
name|OpenDatabaseAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|importer
operator|.
name|fetcher
operator|.
name|LookupIdentifierAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|integrity
operator|.
name|IntegrityCheckAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|journals
operator|.
name|ManageJournalsAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|keyboard
operator|.
name|CustomizeKeyBindingAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|keyboard
operator|.
name|KeyBinding
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|libraryproperties
operator|.
name|LibraryPropertiesAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|menus
operator|.
name|FileHistoryMenu
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|mergeentries
operator|.
name|MergeEntriesAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|metadata
operator|.
name|BibtexStringEditorAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|metadata
operator|.
name|PreambleEditor
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|preferences
operator|.
name|ShowPreferencesAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|protectedterms
operator|.
name|ManageProtectedTermsAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|push
operator|.
name|PushToApplicationAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|push
operator|.
name|PushToApplicationsManager
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|search
operator|.
name|GlobalSearchBar
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|shared
operator|.
name|ConnectToSharedDatabaseCommand
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|specialfields
operator|.
name|SpecialFieldMenuItemFactory
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|texparser
operator|.
name|ParseTexAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|undo
operator|.
name|CountingUndoManager
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|util
operator|.
name|BackgroundTask
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|util
operator|.
name|DefaultTaskExecutor
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|logic
operator|.
name|autosaveandbackup
operator|.
name|AutosaveManager
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|logic
operator|.
name|autosaveandbackup
operator|.
name|BackupManager
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|logic
operator|.
name|importer
operator|.
name|IdFetcher
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|logic
operator|.
name|importer
operator|.
name|OpenDatabase
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|logic
operator|.
name|importer
operator|.
name|ParserResult
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|logic
operator|.
name|importer
operator|.
name|WebFetchers
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|logic
operator|.
name|l10n
operator|.
name|Localization
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|logic
operator|.
name|search
operator|.
name|SearchQuery
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|logic
operator|.
name|undo
operator|.
name|AddUndoableActionEvent
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|logic
operator|.
name|undo
operator|.
name|UndoChangeEvent
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|logic
operator|.
name|undo
operator|.
name|UndoRedoEvent
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|logic
operator|.
name|util
operator|.
name|io
operator|.
name|FileUtil
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|model
operator|.
name|database
operator|.
name|BibDatabaseContext
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|model
operator|.
name|database
operator|.
name|BibDatabaseMode
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|model
operator|.
name|database
operator|.
name|shared
operator|.
name|DatabaseLocation
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|model
operator|.
name|entry
operator|.
name|BibEntry
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|model
operator|.
name|entry
operator|.
name|BiblatexEntryTypes
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|model
operator|.
name|entry
operator|.
name|FieldName
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|model
operator|.
name|entry
operator|.
name|specialfields
operator|.
name|SpecialField
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|preferences
operator|.
name|JabRefPreferences
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|preferences
operator|.
name|LastFocusedTabPreferences
import|;
end_import

begin_import
import|import
name|com
operator|.
name|google
operator|.
name|common
operator|.
name|eventbus
operator|.
name|Subscribe
import|;
end_import

begin_import
import|import
name|org
operator|.
name|eclipse
operator|.
name|fx
operator|.
name|ui
operator|.
name|controls
operator|.
name|tabpane
operator|.
name|DndTabPane
import|;
end_import

begin_import
import|import
name|org
operator|.
name|eclipse
operator|.
name|fx
operator|.
name|ui
operator|.
name|controls
operator|.
name|tabpane
operator|.
name|DndTabPaneFactory
import|;
end_import

begin_import
import|import
name|org
operator|.
name|fxmisc
operator|.
name|easybind
operator|.
name|EasyBind
import|;
end_import

begin_import
import|import
name|org
operator|.
name|slf4j
operator|.
name|Logger
import|;
end_import

begin_import
import|import
name|org
operator|.
name|slf4j
operator|.
name|LoggerFactory
import|;
end_import

begin_comment
comment|/**  * The main window of the application.  */
end_comment

begin_class
DECL|class|JabRefFrame
specifier|public
class|class
name|JabRefFrame
extends|extends
name|BorderPane
block|{
comment|// Frame titles.
DECL|field|FRAME_TITLE
specifier|public
specifier|static
specifier|final
name|String
name|FRAME_TITLE
init|=
literal|"JabRef"
decl_stmt|;
DECL|field|LOGGER
specifier|private
specifier|static
specifier|final
name|Logger
name|LOGGER
init|=
name|LoggerFactory
operator|.
name|getLogger
argument_list|(
name|JabRefFrame
operator|.
name|class
argument_list|)
decl_stmt|;
DECL|field|splitPane
specifier|private
specifier|final
name|SplitPane
name|splitPane
init|=
operator|new
name|SplitPane
argument_list|()
decl_stmt|;
DECL|field|prefs
specifier|private
specifier|final
name|JabRefPreferences
name|prefs
init|=
name|Globals
operator|.
name|prefs
decl_stmt|;
DECL|field|globalSearchBar
specifier|private
specifier|final
name|GlobalSearchBar
name|globalSearchBar
init|=
operator|new
name|GlobalSearchBar
argument_list|(
name|this
argument_list|)
decl_stmt|;
DECL|field|progressBar
specifier|private
specifier|final
name|ProgressBar
name|progressBar
init|=
operator|new
name|ProgressBar
argument_list|()
decl_stmt|;
DECL|field|fileHistory
specifier|private
specifier|final
name|FileHistoryMenu
name|fileHistory
init|=
operator|new
name|FileHistoryMenu
argument_list|(
name|prefs
argument_list|,
name|this
argument_list|)
decl_stmt|;
DECL|field|mainStage
specifier|private
specifier|final
name|Stage
name|mainStage
decl_stmt|;
DECL|field|stateManager
specifier|private
specifier|final
name|StateManager
name|stateManager
decl_stmt|;
DECL|field|undoManager
specifier|private
specifier|final
name|CountingUndoManager
name|undoManager
decl_stmt|;
DECL|field|sidePaneManager
specifier|private
name|SidePaneManager
name|sidePaneManager
decl_stmt|;
DECL|field|tabbedPane
specifier|private
name|TabPane
name|tabbedPane
decl_stmt|;
DECL|field|pushToApplicationsManager
specifier|private
specifier|final
name|PushToApplicationsManager
name|pushToApplicationsManager
decl_stmt|;
DECL|field|dialogService
specifier|private
specifier|final
name|DialogService
name|dialogService
decl_stmt|;
DECL|field|sidePane
specifier|private
name|SidePane
name|sidePane
decl_stmt|;
DECL|method|JabRefFrame (Stage mainStage)
specifier|public
name|JabRefFrame
parameter_list|(
name|Stage
name|mainStage
parameter_list|)
block|{
name|this
operator|.
name|mainStage
operator|=
name|mainStage
expr_stmt|;
name|this
operator|.
name|dialogService
operator|=
operator|new
name|JabRefDialogService
argument_list|(
name|mainStage
argument_list|,
name|this
argument_list|)
expr_stmt|;
name|this
operator|.
name|stateManager
operator|=
name|Globals
operator|.
name|stateManager
expr_stmt|;
name|this
operator|.
name|pushToApplicationsManager
operator|=
operator|new
name|PushToApplicationsManager
argument_list|(
name|dialogService
argument_list|,
name|stateManager
argument_list|)
expr_stmt|;
name|this
operator|.
name|undoManager
operator|=
name|Globals
operator|.
name|undoManager
expr_stmt|;
block|}
DECL|method|init ()
specifier|public
name|void
name|init
parameter_list|()
block|{
name|sidePaneManager
operator|=
operator|new
name|SidePaneManager
argument_list|(
name|Globals
operator|.
name|prefs
argument_list|,
name|this
argument_list|)
expr_stmt|;
name|sidePane
operator|=
name|sidePaneManager
operator|.
name|getPane
argument_list|()
expr_stmt|;
name|Pane
name|containerPane
init|=
name|DndTabPaneFactory
operator|.
name|createDefaultDnDPane
argument_list|(
name|DndTabPaneFactory
operator|.
name|FeedbackType
operator|.
name|MARKER
argument_list|,
literal|null
argument_list|)
decl_stmt|;
name|tabbedPane
operator|=
operator|(
name|DndTabPane
operator|)
name|containerPane
operator|.
name|getChildren
argument_list|()
operator|.
name|get
argument_list|(
literal|0
argument_list|)
expr_stmt|;
name|initLayout
argument_list|()
expr_stmt|;
name|initKeyBindings
argument_list|()
expr_stmt|;
name|tabbedPane
operator|.
name|setOnDragOver
argument_list|(
name|event
lambda|->
block|{
if|if
condition|(
name|event
operator|.
name|getDragboard
argument_list|()
operator|.
name|hasFiles
argument_list|()
condition|)
block|{
name|event
operator|.
name|acceptTransferModes
argument_list|(
name|TransferMode
operator|.
name|COPY
argument_list|,
name|TransferMode
operator|.
name|MOVE
argument_list|,
name|TransferMode
operator|.
name|LINK
argument_list|)
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
name|tabbedPane
operator|.
name|setOnDragDropped
argument_list|(
name|event
lambda|->
block|{
name|boolean
name|success
init|=
literal|false
decl_stmt|;
if|if
condition|(
name|event
operator|.
name|getDragboard
argument_list|()
operator|.
name|hasContent
argument_list|(
name|DataFormat
operator|.
name|FILES
argument_list|)
condition|)
block|{
name|List
argument_list|<
name|Path
argument_list|>
name|files
init|=
name|event
operator|.
name|getDragboard
argument_list|()
operator|.
name|getFiles
argument_list|()
operator|.
name|stream
argument_list|()
operator|.
name|map
argument_list|(
name|File
operator|::
name|toPath
argument_list|)
operator|.
name|filter
argument_list|(
name|FileUtil
operator|::
name|isBibFile
argument_list|)
operator|.
name|collect
argument_list|(
name|Collectors
operator|.
name|toList
argument_list|()
argument_list|)
decl_stmt|;
name|success
operator|=
literal|true
expr_stmt|;
for|for
control|(
name|Path
name|file
range|:
name|files
control|)
block|{
name|ParserResult
name|pr
init|=
name|OpenDatabase
operator|.
name|loadDatabase
argument_list|(
name|file
operator|.
name|toString
argument_list|()
argument_list|,
name|Globals
operator|.
name|prefs
operator|.
name|getImportFormatPreferences
argument_list|()
argument_list|,
name|Globals
operator|.
name|getFileUpdateMonitor
argument_list|()
argument_list|)
decl_stmt|;
name|addParserResult
argument_list|(
name|pr
argument_list|,
literal|true
argument_list|)
expr_stmt|;
block|}
block|}
name|event
operator|.
name|setDropCompleted
argument_list|(
name|success
argument_list|)
expr_stmt|;
name|event
operator|.
name|consume
argument_list|()
expr_stmt|;
block|}
argument_list|)
expr_stmt|;
comment|//setBounds(GraphicsEnvironment.getLocalGraphicsEnvironment().getMaximumWindowBounds());
comment|//WindowLocation pw = new WindowLocation(this, JabRefPreferences.POS_X, JabRefPreferences.POS_Y, JabRefPreferences.SIZE_X,
comment|//        JabRefPreferences.SIZE_Y);
comment|//pw.displayWindowAtStoredLocation();
comment|/*          * The following state listener makes sure focus is registered with the          * correct database when the user switches tabs. Without this,          * cut/paste/copy operations would some times occur in the wrong tab.          */
name|EasyBind
operator|.
name|subscribe
argument_list|(
name|tabbedPane
operator|.
name|getSelectionModel
argument_list|()
operator|.
name|selectedItemProperty
argument_list|()
argument_list|,
name|e
lambda|->
block|{
if|if
condition|(
name|e
operator|==
literal|null
condition|)
block|{
name|stateManager
operator|.
name|activeDatabaseProperty
argument_list|()
operator|.
name|setValue
argument_list|(
name|Optional
operator|.
name|empty
argument_list|()
argument_list|)
expr_stmt|;
return|return;
block|}
name|BasePanel
name|currentBasePanel
init|=
name|getCurrentBasePanel
argument_list|()
decl_stmt|;
if|if
condition|(
name|currentBasePanel
operator|==
literal|null
condition|)
block|{
return|return;
block|}
comment|// Poor-mans binding to global state
name|stateManager
operator|.
name|activeDatabaseProperty
argument_list|()
operator|.
name|setValue
argument_list|(
name|Optional
operator|.
name|of
argument_list|(
name|currentBasePanel
operator|.
name|getBibDatabaseContext
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|stateManager
operator|.
name|setSelectedEntries
argument_list|(
name|currentBasePanel
operator|.
name|getSelectedEntries
argument_list|()
argument_list|)
expr_stmt|;
comment|// Update search query
name|String
name|content
init|=
literal|""
decl_stmt|;
name|Optional
argument_list|<
name|SearchQuery
argument_list|>
name|currentSearchQuery
init|=
name|currentBasePanel
operator|.
name|getCurrentSearchQuery
argument_list|()
decl_stmt|;
if|if
condition|(
name|currentSearchQuery
operator|.
name|isPresent
argument_list|()
condition|)
block|{
name|content
operator|=
name|currentSearchQuery
operator|.
name|get
argument_list|()
operator|.
name|getQuery
argument_list|()
expr_stmt|;
block|}
name|globalSearchBar
operator|.
name|setSearchTerm
argument_list|(
name|content
argument_list|)
expr_stmt|;
comment|// groupSidePane.getToggleCommand().setSelected(sidePaneManager.isComponentVisible(GroupSidePane.class));
comment|//previewToggle.setSelected(Globals.prefs.getPreviewPreferences().isPreviewPanelEnabled());
comment|//generalFetcher.getToggleCommand().setSelected(sidePaneManager.isComponentVisible(WebSearchPane.class));
comment|//openOfficePanel.getToggleCommand().setSelected(sidePaneManager.isComponentVisible(OpenOfficeSidePanel.class));
name|setWindowTitle
argument_list|()
expr_stmt|;
comment|// Update search autocompleter with information for the correct database:
name|currentBasePanel
operator|.
name|updateSearchManager
argument_list|()
expr_stmt|;
name|currentBasePanel
operator|.
name|getUndoManager
argument_list|()
operator|.
name|postUndoRedoEvent
argument_list|()
expr_stmt|;
name|currentBasePanel
operator|.
name|getMainTable
argument_list|()
operator|.
name|requestFocus
argument_list|()
expr_stmt|;
block|}
argument_list|)
expr_stmt|;
name|initShowTrackingNotification
argument_list|()
expr_stmt|;
block|}
DECL|method|initKeyBindings ()
specifier|private
name|void
name|initKeyBindings
parameter_list|()
block|{
name|addEventFilter
argument_list|(
name|KeyEvent
operator|.
name|KEY_PRESSED
argument_list|,
name|event
lambda|->
block|{
name|Optional
argument_list|<
name|KeyBinding
argument_list|>
name|keyBinding
init|=
name|Globals
operator|.
name|getKeyPrefs
argument_list|()
operator|.
name|mapToKeyBinding
argument_list|(
name|event
argument_list|)
decl_stmt|;
if|if
condition|(
name|keyBinding
operator|.
name|isPresent
argument_list|()
condition|)
block|{
switch|switch
condition|(
name|keyBinding
operator|.
name|get
argument_list|()
condition|)
block|{
case|case
name|FOCUS_ENTRY_TABLE
case|:
name|getCurrentBasePanel
argument_list|()
operator|.
name|getMainTable
argument_list|()
operator|.
name|requestFocus
argument_list|()
expr_stmt|;
name|event
operator|.
name|consume
argument_list|()
expr_stmt|;
break|break;
case|case
name|NEXT_LIBRARY
case|:
name|tabbedPane
operator|.
name|getSelectionModel
argument_list|()
operator|.
name|selectNext
argument_list|()
expr_stmt|;
name|event
operator|.
name|consume
argument_list|()
expr_stmt|;
break|break;
case|case
name|PREVIOUS_LIBRARY
case|:
name|tabbedPane
operator|.
name|getSelectionModel
argument_list|()
operator|.
name|selectPrevious
argument_list|()
expr_stmt|;
name|event
operator|.
name|consume
argument_list|()
expr_stmt|;
break|break;
case|case
name|INCREASE_TABLE_FONT_SIZE
case|:
name|increaseTableFontSize
argument_list|()
expr_stmt|;
name|event
operator|.
name|consume
argument_list|()
expr_stmt|;
break|break;
case|case
name|DECREASE_TABLE_FONT_SIZE
case|:
name|decreaseTableFontSize
argument_list|()
expr_stmt|;
name|event
operator|.
name|consume
argument_list|()
expr_stmt|;
break|break;
case|case
name|DEFAULT_TABLE_FONT_SIZE
case|:
name|setDefaultTableFontSize
argument_list|()
expr_stmt|;
name|event
operator|.
name|consume
argument_list|()
expr_stmt|;
break|break;
case|case
name|SEARCH
case|:
name|getGlobalSearchBar
argument_list|()
operator|.
name|focus
argument_list|()
expr_stmt|;
break|break;
default|default:
block|}
block|}
block|}
argument_list|)
expr_stmt|;
block|}
DECL|method|initShowTrackingNotification ()
specifier|private
name|void
name|initShowTrackingNotification
parameter_list|()
block|{
if|if
condition|(
operator|!
name|Globals
operator|.
name|prefs
operator|.
name|shouldAskToCollectTelemetry
argument_list|()
condition|)
block|{
name|JabRefExecutorService
operator|.
name|INSTANCE
operator|.
name|submit
argument_list|(
operator|new
name|TimerTask
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|run
parameter_list|()
block|{
name|SwingUtilities
operator|.
name|invokeLater
argument_list|(
parameter_list|()
lambda|->
block|{
name|DefaultTaskExecutor
operator|.
name|runInJavaFXThread
argument_list|(
name|JabRefFrame
operator|.
name|this
operator|::
name|showTrackingNotification
argument_list|)
expr_stmt|;
block|}
argument_list|)
expr_stmt|;
block|}
block|}
argument_list|,
literal|60000
argument_list|)
expr_stmt|;
comment|// run in one minute
block|}
block|}
DECL|method|showTrackingNotification ()
specifier|private
name|Void
name|showTrackingNotification
parameter_list|()
block|{
if|if
condition|(
operator|!
name|Globals
operator|.
name|prefs
operator|.
name|shouldCollectTelemetry
argument_list|()
condition|)
block|{
name|boolean
name|shouldCollect
init|=
name|dialogService
operator|.
name|showConfirmationDialogAndWait
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Telemetry: Help make JabRef better"
argument_list|)
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"To improve the user experience, we would like to collect anonymous statistics on the features you use. We will only record what features you access and how often you do it. We will neither collect any personal data nor the content of bibliographic items. If you choose to allow data collection, you can later disable it via Options -> Preferences -> General."
argument_list|)
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Share anonymous statistics"
argument_list|)
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Don't share"
argument_list|)
argument_list|)
decl_stmt|;
name|Globals
operator|.
name|prefs
operator|.
name|setShouldCollectTelemetry
argument_list|(
name|shouldCollect
argument_list|)
expr_stmt|;
block|}
name|Globals
operator|.
name|prefs
operator|.
name|askedToCollectTelemetry
argument_list|()
expr_stmt|;
return|return
literal|null
return|;
block|}
DECL|method|refreshTitleAndTabs ()
specifier|public
name|void
name|refreshTitleAndTabs
parameter_list|()
block|{
name|DefaultTaskExecutor
operator|.
name|runInJavaFXThread
argument_list|(
parameter_list|()
lambda|->
block|{
name|setWindowTitle
argument_list|()
expr_stmt|;
name|updateAllTabTitles
argument_list|()
expr_stmt|;
block|}
argument_list|)
expr_stmt|;
block|}
comment|/**      * Sets the title of the main window.      */
DECL|method|setWindowTitle ()
specifier|public
name|void
name|setWindowTitle
parameter_list|()
block|{
name|BasePanel
name|panel
init|=
name|getCurrentBasePanel
argument_list|()
decl_stmt|;
comment|// no database open
if|if
condition|(
name|panel
operator|==
literal|null
condition|)
block|{
comment|//setTitle(FRAME_TITLE);
return|return;
block|}
name|String
name|mode
init|=
name|panel
operator|.
name|getBibDatabaseContext
argument_list|()
operator|.
name|getMode
argument_list|()
operator|.
name|getFormattedName
argument_list|()
decl_stmt|;
name|String
name|modeInfo
init|=
name|String
operator|.
name|format
argument_list|(
literal|" (%s)"
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"%0 mode"
argument_list|,
name|mode
argument_list|)
argument_list|)
decl_stmt|;
name|boolean
name|isAutosaveEnabled
init|=
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|LOCAL_AUTO_SAVE
argument_list|)
decl_stmt|;
if|if
condition|(
name|panel
operator|.
name|getBibDatabaseContext
argument_list|()
operator|.
name|getLocation
argument_list|()
operator|==
name|DatabaseLocation
operator|.
name|LOCAL
condition|)
block|{
name|String
name|changeFlag
init|=
name|panel
operator|.
name|isModified
argument_list|()
operator|&&
operator|!
name|isAutosaveEnabled
condition|?
literal|"*"
else|:
literal|""
decl_stmt|;
name|String
name|databaseFile
init|=
name|panel
operator|.
name|getBibDatabaseContext
argument_list|()
operator|.
name|getDatabaseFile
argument_list|()
operator|.
name|map
argument_list|(
name|File
operator|::
name|getPath
argument_list|)
operator|.
name|orElse
argument_list|(
name|GUIGlobals
operator|.
name|UNTITLED_TITLE
argument_list|)
decl_stmt|;
comment|//setTitle(FRAME_TITLE + " - " + databaseFile + changeFlag + modeInfo);
block|}
elseif|else
if|if
condition|(
name|panel
operator|.
name|getBibDatabaseContext
argument_list|()
operator|.
name|getLocation
argument_list|()
operator|==
name|DatabaseLocation
operator|.
name|SHARED
condition|)
block|{
comment|//setTitle(FRAME_TITLE + " - " + panel.getBibDatabaseContext().getDBMSSynchronizer().getDBName() + " ["
comment|//        + Localization.lang("shared") + "]" + modeInfo);
block|}
block|}
comment|/**      * The MacAdapter calls this method when a "BIB" file has been double-clicked from the Finder.      */
DECL|method|openAction (String filePath)
specifier|public
name|void
name|openAction
parameter_list|(
name|String
name|filePath
parameter_list|)
block|{
name|Path
name|file
init|=
name|Paths
operator|.
name|get
argument_list|(
name|filePath
argument_list|)
decl_stmt|;
comment|// all the logic is done in openIt. Even raising an existing panel
name|getOpenDatabaseAction
argument_list|()
operator|.
name|openFile
argument_list|(
name|file
argument_list|,
literal|true
argument_list|)
expr_stmt|;
block|}
comment|/**      * The MacAdapter calls this method when "About" is selected from the application menu.      */
DECL|method|about ()
specifier|public
name|void
name|about
parameter_list|()
block|{
name|HelpAction
operator|.
name|getMainHelpPageCommand
argument_list|()
operator|.
name|execute
argument_list|()
expr_stmt|;
block|}
DECL|method|prefs ()
specifier|public
name|JabRefPreferences
name|prefs
parameter_list|()
block|{
return|return
name|prefs
return|;
block|}
comment|/**      * Tears down all things started by JabRef      *<p>      * FIXME: Currently some threads remain and therefore hinder JabRef to be closed properly      *      * @param filenames the filenames of all currently opened files - used for storing them if prefs openLastEdited is      *                  set to true      */
DECL|method|tearDownJabRef (List<String> filenames)
specifier|private
name|void
name|tearDownJabRef
parameter_list|(
name|List
argument_list|<
name|String
argument_list|>
name|filenames
parameter_list|)
block|{
comment|//prefs.putBoolean(JabRefPreferences.WINDOW_MAXIMISED, getExtendedState() == Frame.MAXIMIZED_BOTH);
if|if
condition|(
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|OPEN_LAST_EDITED
argument_list|)
condition|)
block|{
comment|// Here we store the names of all current files. If
comment|// there is no current file, we remove any
comment|// previously stored filename.
if|if
condition|(
name|filenames
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|prefs
operator|.
name|remove
argument_list|(
name|JabRefPreferences
operator|.
name|LAST_EDITED
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|prefs
operator|.
name|putStringList
argument_list|(
name|JabRefPreferences
operator|.
name|LAST_EDITED
argument_list|,
name|filenames
argument_list|)
expr_stmt|;
name|File
name|focusedDatabase
init|=
name|getCurrentBasePanel
argument_list|()
operator|.
name|getBibDatabaseContext
argument_list|()
operator|.
name|getDatabaseFile
argument_list|()
operator|.
name|orElse
argument_list|(
literal|null
argument_list|)
decl_stmt|;
operator|new
name|LastFocusedTabPreferences
argument_list|(
name|prefs
argument_list|)
operator|.
name|setLastFocusedTab
argument_list|(
name|focusedDatabase
argument_list|)
expr_stmt|;
block|}
block|}
name|fileHistory
operator|.
name|storeHistory
argument_list|()
expr_stmt|;
name|prefs
operator|.
name|flush
argument_list|()
expr_stmt|;
comment|// dispose all windows, even if they are not displayed anymore
for|for
control|(
name|Window
name|window
range|:
name|Window
operator|.
name|getWindows
argument_list|()
control|)
block|{
name|window
operator|.
name|dispose
argument_list|()
expr_stmt|;
block|}
block|}
comment|/**      * General info dialog.  The MacAdapter calls this method when "Quit" is selected from the application menu, Cmd-Q      * is pressed, or "Quit" is selected from the Dock. The function returns a boolean indicating if quitting is ok or      * not.      *<p>      * Non-OSX JabRef calls this when choosing "Quit" from the menu      *<p>      * SIDE EFFECT: tears down JabRef      *      * @return true if the user chose to quit; false otherwise      */
DECL|method|quit ()
specifier|public
name|boolean
name|quit
parameter_list|()
block|{
comment|// First ask if the user really wants to close, if the library has not been saved since last save.
name|List
argument_list|<
name|String
argument_list|>
name|filenames
init|=
operator|new
name|ArrayList
argument_list|<>
argument_list|()
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|tabbedPane
operator|.
name|getTabs
argument_list|()
operator|.
name|size
argument_list|()
condition|;
name|i
operator|++
control|)
block|{
name|BasePanel
name|panel
init|=
name|getBasePanelAt
argument_list|(
name|i
argument_list|)
decl_stmt|;
name|BibDatabaseContext
name|context
init|=
name|panel
operator|.
name|getBibDatabaseContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|panel
operator|.
name|isModified
argument_list|()
operator|&&
operator|(
name|context
operator|.
name|getLocation
argument_list|()
operator|==
name|DatabaseLocation
operator|.
name|LOCAL
operator|)
condition|)
block|{
name|tabbedPane
operator|.
name|getSelectionModel
argument_list|()
operator|.
name|select
argument_list|(
name|i
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|confirmClose
argument_list|(
name|panel
argument_list|)
condition|)
block|{
return|return
literal|false
return|;
block|}
block|}
elseif|else
if|if
condition|(
name|context
operator|.
name|getLocation
argument_list|()
operator|==
name|DatabaseLocation
operator|.
name|SHARED
condition|)
block|{
name|context
operator|.
name|convertToLocalDatabase
argument_list|()
expr_stmt|;
name|context
operator|.
name|getDBMSSynchronizer
argument_list|()
operator|.
name|closeSharedDatabase
argument_list|()
expr_stmt|;
name|context
operator|.
name|clearDBMSSynchronizer
argument_list|()
expr_stmt|;
block|}
name|AutosaveManager
operator|.
name|shutdown
argument_list|(
name|context
argument_list|)
expr_stmt|;
name|BackupManager
operator|.
name|shutdown
argument_list|(
name|context
argument_list|)
expr_stmt|;
name|context
operator|.
name|getDatabaseFile
argument_list|()
operator|.
name|map
argument_list|(
name|File
operator|::
name|getAbsolutePath
argument_list|)
operator|.
name|ifPresent
argument_list|(
name|filenames
operator|::
name|add
argument_list|)
expr_stmt|;
block|}
name|WaitForSaveFinishedDialog
name|waitForSaveFinishedDialog
init|=
operator|new
name|WaitForSaveFinishedDialog
argument_list|(
name|dialogService
argument_list|)
decl_stmt|;
name|waitForSaveFinishedDialog
operator|.
name|showAndWait
argument_list|(
name|getBasePanelList
argument_list|()
argument_list|)
expr_stmt|;
comment|// Good bye!
name|tearDownJabRef
argument_list|(
name|filenames
argument_list|)
expr_stmt|;
name|Platform
operator|.
name|exit
argument_list|()
expr_stmt|;
return|return
literal|true
return|;
block|}
DECL|method|initLayout ()
specifier|private
name|void
name|initLayout
parameter_list|()
block|{
name|setProgressBarVisible
argument_list|(
literal|false
argument_list|)
expr_stmt|;
name|BorderPane
name|head
init|=
operator|new
name|BorderPane
argument_list|()
decl_stmt|;
name|head
operator|.
name|setTop
argument_list|(
name|createMenu
argument_list|()
argument_list|)
expr_stmt|;
name|head
operator|.
name|setCenter
argument_list|(
name|createToolbar
argument_list|()
argument_list|)
expr_stmt|;
name|setTop
argument_list|(
name|head
argument_list|)
expr_stmt|;
name|SplitPane
operator|.
name|setResizableWithParent
argument_list|(
name|sidePane
argument_list|,
name|Boolean
operator|.
name|FALSE
argument_list|)
expr_stmt|;
name|splitPane
operator|.
name|getItems
argument_list|()
operator|.
name|addAll
argument_list|(
name|sidePane
argument_list|,
name|tabbedPane
argument_list|)
expr_stmt|;
comment|// We need to wait with setting the divider since it gets reset a few times during the initial set-up
name|mainStage
operator|.
name|showingProperty
argument_list|()
operator|.
name|addListener
argument_list|(
operator|new
name|ChangeListener
argument_list|<
name|Boolean
argument_list|>
argument_list|()
block|{
annotation|@
name|Override
specifier|public
name|void
name|changed
parameter_list|(
name|ObservableValue
argument_list|<
name|?
extends|extends
name|Boolean
argument_list|>
name|observable
parameter_list|,
name|Boolean
name|oldValue
parameter_list|,
name|Boolean
name|showing
parameter_list|)
block|{
if|if
condition|(
name|showing
condition|)
block|{
name|setDividerPosition
argument_list|()
expr_stmt|;
name|EasyBind
operator|.
name|subscribe
argument_list|(
name|sidePane
operator|.
name|visibleProperty
argument_list|()
argument_list|,
name|visible
lambda|->
block|{
if|if
condition|(
name|visible
condition|)
block|{
if|if
condition|(
operator|!
name|splitPane
operator|.
name|getItems
argument_list|()
operator|.
name|contains
argument_list|(
name|sidePane
argument_list|)
condition|)
block|{
name|splitPane
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
literal|0
argument_list|,
name|sidePane
argument_list|)
expr_stmt|;
name|setDividerPosition
argument_list|()
expr_stmt|;
block|}
block|}
else|else
block|{
name|splitPane
operator|.
name|getItems
argument_list|()
operator|.
name|remove
argument_list|(
name|sidePane
argument_list|)
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
name|mainStage
operator|.
name|showingProperty
argument_list|()
operator|.
name|removeListener
argument_list|(
name|this
argument_list|)
expr_stmt|;
name|observable
operator|.
name|removeListener
argument_list|(
name|this
argument_list|)
expr_stmt|;
block|}
block|}
block|}
argument_list|)
expr_stmt|;
name|setCenter
argument_list|(
name|splitPane
argument_list|)
expr_stmt|;
block|}
DECL|method|setDividerPosition ()
specifier|private
name|void
name|setDividerPosition
parameter_list|()
block|{
name|splitPane
operator|.
name|setDividerPositions
argument_list|(
name|prefs
operator|.
name|getDouble
argument_list|(
name|JabRefPreferences
operator|.
name|SIDE_PANE_WIDTH
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
operator|!
name|splitPane
operator|.
name|getDividers
argument_list|()
operator|.
name|isEmpty
argument_list|()
condition|)
block|{
name|EasyBind
operator|.
name|subscribe
argument_list|(
name|splitPane
operator|.
name|getDividers
argument_list|()
operator|.
name|get
argument_list|(
literal|0
argument_list|)
operator|.
name|positionProperty
argument_list|()
argument_list|,
name|position
lambda|->
name|prefs
operator|.
name|putDouble
argument_list|(
name|JabRefPreferences
operator|.
name|SIDE_PANE_WIDTH
argument_list|,
name|position
operator|.
name|doubleValue
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
DECL|method|createToolbar ()
specifier|private
name|Node
name|createToolbar
parameter_list|()
block|{
name|Pane
name|leftSpacer
init|=
operator|new
name|Pane
argument_list|()
decl_stmt|;
name|HBox
operator|.
name|setHgrow
argument_list|(
name|leftSpacer
argument_list|,
name|Priority
operator|.
name|SOMETIMES
argument_list|)
expr_stmt|;
name|Pane
name|rightSpacer
init|=
operator|new
name|Pane
argument_list|()
decl_stmt|;
name|HBox
operator|.
name|setHgrow
argument_list|(
name|rightSpacer
argument_list|,
name|Priority
operator|.
name|SOMETIMES
argument_list|)
expr_stmt|;
name|ActionFactory
name|factory
init|=
operator|new
name|ActionFactory
argument_list|(
name|Globals
operator|.
name|getKeyPrefs
argument_list|()
argument_list|)
decl_stmt|;
name|Button
name|newLibrary
decl_stmt|;
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|BIBLATEX_DEFAULT_MODE
argument_list|)
condition|)
block|{
name|newLibrary
operator|=
name|factory
operator|.
name|createIconButton
argument_list|(
name|StandardActions
operator|.
name|NEW_LIBRARY_BIBLATEX
argument_list|,
operator|new
name|NewDatabaseAction
argument_list|(
name|this
argument_list|,
name|BibDatabaseMode
operator|.
name|BIBLATEX
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|newLibrary
operator|=
name|factory
operator|.
name|createIconButton
argument_list|(
name|StandardActions
operator|.
name|NEW_LIBRARY_BIBTEX
argument_list|,
operator|new
name|NewDatabaseAction
argument_list|(
name|this
argument_list|,
name|BibDatabaseMode
operator|.
name|BIBTEX
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|HBox
name|leftSide
init|=
operator|new
name|HBox
argument_list|(
name|newLibrary
argument_list|,
name|factory
operator|.
name|createIconButton
argument_list|(
name|StandardActions
operator|.
name|OPEN_LIBRARY
argument_list|,
operator|new
name|OpenDatabaseAction
argument_list|(
name|this
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createIconButton
argument_list|(
name|StandardActions
operator|.
name|SAVE_LIBRARY
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|SAVE
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|leftSpacer
argument_list|)
decl_stmt|;
name|leftSide
operator|.
name|setMinWidth
argument_list|(
literal|100
argument_list|)
expr_stmt|;
name|leftSide
operator|.
name|prefWidthProperty
argument_list|()
operator|.
name|bind
argument_list|(
name|sidePane
operator|.
name|widthProperty
argument_list|()
argument_list|)
expr_stmt|;
name|leftSide
operator|.
name|maxWidthProperty
argument_list|()
operator|.
name|bind
argument_list|(
name|sidePane
operator|.
name|widthProperty
argument_list|()
argument_list|)
expr_stmt|;
specifier|final
name|PushToApplicationAction
name|pushToApplicationAction
init|=
name|getPushToApplicationsManager
argument_list|()
operator|.
name|getPushToApplicationAction
argument_list|()
decl_stmt|;
specifier|final
name|Button
name|pushToApplicationButton
init|=
name|factory
operator|.
name|createIconButton
argument_list|(
name|pushToApplicationAction
operator|.
name|getActionInformation
argument_list|()
argument_list|,
name|pushToApplicationAction
argument_list|)
decl_stmt|;
name|pushToApplicationsManager
operator|.
name|setToolBarButton
argument_list|(
name|pushToApplicationButton
argument_list|)
expr_stmt|;
name|HBox
name|rightSide
init|=
operator|new
name|HBox
argument_list|(
name|factory
operator|.
name|createIconButton
argument_list|(
name|StandardActions
operator|.
name|NEW_ARTICLE
argument_list|,
operator|new
name|NewEntryAction
argument_list|(
name|this
argument_list|,
name|BiblatexEntryTypes
operator|.
name|ARTICLE
argument_list|,
name|dialogService
argument_list|,
name|Globals
operator|.
name|prefs
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createIconButton
argument_list|(
name|StandardActions
operator|.
name|DELETE_ENTRY
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|DELETE
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
operator|new
name|Separator
argument_list|(
name|Orientation
operator|.
name|VERTICAL
argument_list|)
argument_list|,
name|factory
operator|.
name|createIconButton
argument_list|(
name|StandardActions
operator|.
name|UNDO
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|UNDO
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createIconButton
argument_list|(
name|StandardActions
operator|.
name|REDO
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|REDO
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createIconButton
argument_list|(
name|StandardActions
operator|.
name|CUT
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|CUT
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createIconButton
argument_list|(
name|StandardActions
operator|.
name|COPY
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|COPY
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createIconButton
argument_list|(
name|StandardActions
operator|.
name|PASTE
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|PASTE
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
operator|new
name|Separator
argument_list|(
name|Orientation
operator|.
name|VERTICAL
argument_list|)
argument_list|,
name|pushToApplicationButton
argument_list|,
name|factory
operator|.
name|createIconButton
argument_list|(
name|StandardActions
operator|.
name|GENERATE_CITE_KEYS
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|MAKE_KEY
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createIconButton
argument_list|(
name|StandardActions
operator|.
name|CLEANUP_ENTRIES
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|CLEANUP
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
operator|new
name|Separator
argument_list|(
name|Orientation
operator|.
name|VERTICAL
argument_list|)
argument_list|,
name|factory
operator|.
name|createIconButton
argument_list|(
name|StandardActions
operator|.
name|FORK_ME
argument_list|,
operator|new
name|OpenBrowserAction
argument_list|(
literal|"https://github.com/JabRef/jabref"
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createIconButton
argument_list|(
name|StandardActions
operator|.
name|OPEN_FACEBOOK
argument_list|,
operator|new
name|OpenBrowserAction
argument_list|(
literal|"https://www.facebook.com/JabRef/"
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createIconButton
argument_list|(
name|StandardActions
operator|.
name|OPEN_TWITTER
argument_list|,
operator|new
name|OpenBrowserAction
argument_list|(
literal|"https://twitter.com/jabref_org"
argument_list|)
argument_list|)
argument_list|)
decl_stmt|;
name|HBox
operator|.
name|setHgrow
argument_list|(
name|globalSearchBar
argument_list|,
name|Priority
operator|.
name|ALWAYS
argument_list|)
expr_stmt|;
name|ToolBar
name|toolBar
init|=
operator|new
name|ToolBar
argument_list|(
name|leftSide
argument_list|,
name|globalSearchBar
argument_list|,
name|rightSpacer
argument_list|,
name|rightSide
argument_list|)
decl_stmt|;
name|toolBar
operator|.
name|getStyleClass
argument_list|()
operator|.
name|add
argument_list|(
literal|"mainToolbar"
argument_list|)
expr_stmt|;
return|return
name|toolBar
return|;
block|}
comment|/**      * Returns the indexed BasePanel.      *      * @param i Index of base      */
DECL|method|getBasePanelAt (int i)
specifier|public
name|BasePanel
name|getBasePanelAt
parameter_list|(
name|int
name|i
parameter_list|)
block|{
return|return
operator|(
name|BasePanel
operator|)
name|tabbedPane
operator|.
name|getTabs
argument_list|()
operator|.
name|get
argument_list|(
name|i
argument_list|)
operator|.
name|getContent
argument_list|()
return|;
block|}
comment|/**      * Returns a list of BasePanel.      */
DECL|method|getBasePanelList ()
specifier|public
name|List
argument_list|<
name|BasePanel
argument_list|>
name|getBasePanelList
parameter_list|()
block|{
name|List
argument_list|<
name|BasePanel
argument_list|>
name|returnList
init|=
operator|new
name|ArrayList
argument_list|<>
argument_list|()
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|getBasePanelCount
argument_list|()
condition|;
name|i
operator|++
control|)
block|{
name|returnList
operator|.
name|add
argument_list|(
name|getBasePanelAt
argument_list|(
name|i
argument_list|)
argument_list|)
expr_stmt|;
block|}
return|return
name|returnList
return|;
block|}
DECL|method|showBasePanelAt (int i)
specifier|public
name|void
name|showBasePanelAt
parameter_list|(
name|int
name|i
parameter_list|)
block|{
name|tabbedPane
operator|.
name|getSelectionModel
argument_list|()
operator|.
name|select
argument_list|(
name|i
argument_list|)
expr_stmt|;
block|}
DECL|method|showBasePanel (BasePanel bp)
specifier|public
name|void
name|showBasePanel
parameter_list|(
name|BasePanel
name|bp
parameter_list|)
block|{
name|tabbedPane
operator|.
name|getSelectionModel
argument_list|()
operator|.
name|select
argument_list|(
name|getTab
argument_list|(
name|bp
argument_list|)
argument_list|)
expr_stmt|;
block|}
comment|/**      * Returns the currently viewed BasePanel.      */
DECL|method|getCurrentBasePanel ()
specifier|public
name|BasePanel
name|getCurrentBasePanel
parameter_list|()
block|{
if|if
condition|(
operator|(
name|tabbedPane
operator|==
literal|null
operator|)
operator|||
operator|(
name|tabbedPane
operator|.
name|getSelectionModel
argument_list|()
operator|.
name|getSelectedItem
argument_list|()
operator|==
literal|null
operator|)
condition|)
block|{
return|return
literal|null
return|;
block|}
return|return
operator|(
name|BasePanel
operator|)
name|tabbedPane
operator|.
name|getSelectionModel
argument_list|()
operator|.
name|getSelectedItem
argument_list|()
operator|.
name|getContent
argument_list|()
return|;
block|}
comment|/**      * @return the BasePanel count.      */
DECL|method|getBasePanelCount ()
specifier|public
name|int
name|getBasePanelCount
parameter_list|()
block|{
return|return
name|tabbedPane
operator|.
name|getTabs
argument_list|()
operator|.
name|size
argument_list|()
return|;
block|}
DECL|method|getTab (BasePanel comp)
specifier|private
name|Tab
name|getTab
parameter_list|(
name|BasePanel
name|comp
parameter_list|)
block|{
for|for
control|(
name|Tab
name|tab
range|:
name|tabbedPane
operator|.
name|getTabs
argument_list|()
control|)
block|{
if|if
condition|(
name|tab
operator|.
name|getContent
argument_list|()
operator|==
name|comp
condition|)
block|{
return|return
name|tab
return|;
block|}
block|}
return|return
literal|null
return|;
block|}
comment|/**      * @deprecated do not operate on tabs but on BibDatabaseContexts      */
annotation|@
name|Deprecated
DECL|method|getTabbedPane ()
specifier|public
name|TabPane
name|getTabbedPane
parameter_list|()
block|{
return|return
name|tabbedPane
return|;
block|}
DECL|method|setTabTitle (BasePanel comp, String title, String toolTip)
specifier|public
name|void
name|setTabTitle
parameter_list|(
name|BasePanel
name|comp
parameter_list|,
name|String
name|title
parameter_list|,
name|String
name|toolTip
parameter_list|)
block|{
name|DefaultTaskExecutor
operator|.
name|runInJavaFXThread
argument_list|(
parameter_list|()
lambda|->
block|{
name|Tab
name|tab
init|=
name|getTab
argument_list|(
name|comp
argument_list|)
decl_stmt|;
name|tab
operator|.
name|setText
argument_list|(
name|title
argument_list|)
expr_stmt|;
name|tab
operator|.
name|setTooltip
argument_list|(
operator|new
name|Tooltip
argument_list|(
name|toolTip
argument_list|)
argument_list|)
expr_stmt|;
block|}
argument_list|)
expr_stmt|;
block|}
DECL|method|createMenu ()
specifier|private
name|MenuBar
name|createMenu
parameter_list|()
block|{
name|ActionFactory
name|factory
init|=
operator|new
name|ActionFactory
argument_list|(
name|Globals
operator|.
name|getKeyPrefs
argument_list|()
argument_list|)
decl_stmt|;
name|Menu
name|file
init|=
operator|new
name|Menu
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"File"
argument_list|)
argument_list|)
decl_stmt|;
name|Menu
name|edit
init|=
operator|new
name|Menu
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Edit"
argument_list|)
argument_list|)
decl_stmt|;
name|Menu
name|library
init|=
operator|new
name|Menu
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Library"
argument_list|)
argument_list|)
decl_stmt|;
name|Menu
name|quality
init|=
operator|new
name|Menu
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Quality"
argument_list|)
argument_list|)
decl_stmt|;
name|Menu
name|view
init|=
operator|new
name|Menu
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"View"
argument_list|)
argument_list|)
decl_stmt|;
name|Menu
name|tools
init|=
operator|new
name|Menu
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Tools"
argument_list|)
argument_list|)
decl_stmt|;
name|Menu
name|options
init|=
operator|new
name|Menu
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Options"
argument_list|)
argument_list|)
decl_stmt|;
name|Menu
name|help
init|=
operator|new
name|Menu
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Help"
argument_list|)
argument_list|)
decl_stmt|;
name|file
operator|.
name|getItems
argument_list|()
operator|.
name|addAll
argument_list|(
name|factory
operator|.
name|createSubMenu
argument_list|(
name|StandardActions
operator|.
name|NEW_LIBRARY
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|NEW_LIBRARY_BIBTEX
argument_list|,
operator|new
name|NewDatabaseAction
argument_list|(
name|this
argument_list|,
name|BibDatabaseMode
operator|.
name|BIBTEX
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|NEW_LIBRARY_BIBLATEX
argument_list|,
operator|new
name|NewDatabaseAction
argument_list|(
name|this
argument_list|,
name|BibDatabaseMode
operator|.
name|BIBLATEX
argument_list|)
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|OPEN_LIBRARY
argument_list|,
name|getOpenDatabaseAction
argument_list|()
argument_list|)
argument_list|,
name|fileHistory
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|SAVE_LIBRARY
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|SAVE
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|SAVE_LIBRARY_AS
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|SAVE_AS
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|SAVE_ALL
argument_list|,
operator|new
name|SaveAllAction
argument_list|(
name|this
argument_list|)
argument_list|)
argument_list|,
operator|new
name|SeparatorMenuItem
argument_list|()
argument_list|,
name|factory
operator|.
name|createSubMenu
argument_list|(
name|StandardActions
operator|.
name|IMPORT
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|MERGE_DATABASE
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|MERGE_DATABASE
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
comment|// TODO: merge with import
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|IMPORT_INTO_CURRENT_LIBRARY
argument_list|,
operator|new
name|ImportCommand
argument_list|(
name|this
argument_list|,
literal|false
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|IMPORT_INTO_NEW_LIBRARY
argument_list|,
operator|new
name|ImportCommand
argument_list|(
name|this
argument_list|,
literal|true
argument_list|)
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createSubMenu
argument_list|(
name|StandardActions
operator|.
name|EXPORT
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|EXPORT_ALL
argument_list|,
operator|new
name|ExportCommand
argument_list|(
name|this
argument_list|,
literal|false
argument_list|,
name|Globals
operator|.
name|prefs
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|EXPORT_SELECTED
argument_list|,
operator|new
name|ExportCommand
argument_list|(
name|this
argument_list|,
literal|true
argument_list|,
name|Globals
operator|.
name|prefs
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|SAVE_SELECTED_AS_PLAIN_BIBTEX
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|SAVE_SELECTED_AS_PLAIN
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|CONNECT_TO_SHARED_DB
argument_list|,
operator|new
name|ConnectToSharedDatabaseCommand
argument_list|(
name|this
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|PULL_CHANGES_FROM_SHARED_DB
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|PULL_CHANGES_FROM_SHARED_DATABASE
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
operator|new
name|SeparatorMenuItem
argument_list|()
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|CLOSE_LIBRARY
argument_list|,
operator|new
name|CloseDatabaseAction
argument_list|()
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|QUIT
argument_list|,
operator|new
name|CloseAction
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|edit
operator|.
name|getItems
argument_list|()
operator|.
name|addAll
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|UNDO
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|UNDO
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|REDO
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|REDO
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
operator|new
name|SeparatorMenuItem
argument_list|()
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|CUT
argument_list|,
operator|new
name|EditAction
argument_list|(
name|Actions
operator|.
name|CUT
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|COPY
argument_list|,
operator|new
name|EditAction
argument_list|(
name|Actions
operator|.
name|COPY
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createSubMenu
argument_list|(
name|StandardActions
operator|.
name|COPY_MORE
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|COPY_TITLE
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|COPY_TITLE
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|COPY_KEY
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|COPY_KEY
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|COPY_CITE_KEY
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|COPY_CITE_KEY
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|COPY_KEY_AND_TITLE
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|COPY_KEY_AND_TITLE
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|COPY_KEY_AND_LINK
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|COPY_KEY_AND_LINK
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|COPY_CITATION_PREVIEW
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|COPY_CITATION_HTML
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|EXPORT_SELECTED_TO_CLIPBOARD
argument_list|,
operator|new
name|ExportToClipboardAction
argument_list|(
name|this
argument_list|,
name|dialogService
argument_list|)
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|PASTE
argument_list|,
operator|new
name|EditAction
argument_list|(
name|Actions
operator|.
name|PASTE
argument_list|)
argument_list|)
argument_list|,
operator|new
name|SeparatorMenuItem
argument_list|()
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|MANAGE_KEYWORDS
argument_list|,
operator|new
name|ManageKeywordsAction
argument_list|(
name|stateManager
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|SPECIALFIELDSENABLED
argument_list|)
condition|)
block|{
name|boolean
name|menuItemAdded
init|=
literal|false
decl_stmt|;
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|SHOWCOLUMN_RANKING
argument_list|)
condition|)
block|{
name|edit
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|SpecialFieldMenuItemFactory
operator|.
name|createSpecialFieldMenuForActiveDatabase
argument_list|(
name|SpecialField
operator|.
name|RANKING
argument_list|,
name|factory
argument_list|,
name|undoManager
argument_list|)
argument_list|)
expr_stmt|;
name|menuItemAdded
operator|=
literal|true
expr_stmt|;
block|}
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|SHOWCOLUMN_RELEVANCE
argument_list|)
condition|)
block|{
name|edit
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|SpecialFieldMenuItemFactory
operator|.
name|getSpecialFieldSingleItemForActiveDatabase
argument_list|(
name|SpecialField
operator|.
name|RELEVANCE
argument_list|,
name|factory
argument_list|)
argument_list|)
expr_stmt|;
name|menuItemAdded
operator|=
literal|true
expr_stmt|;
block|}
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|SHOWCOLUMN_QUALITY
argument_list|)
condition|)
block|{
name|edit
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|SpecialFieldMenuItemFactory
operator|.
name|getSpecialFieldSingleItemForActiveDatabase
argument_list|(
name|SpecialField
operator|.
name|QUALITY
argument_list|,
name|factory
argument_list|)
argument_list|)
expr_stmt|;
name|menuItemAdded
operator|=
literal|true
expr_stmt|;
block|}
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|SHOWCOLUMN_PRINTED
argument_list|)
condition|)
block|{
name|edit
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|SpecialFieldMenuItemFactory
operator|.
name|getSpecialFieldSingleItemForActiveDatabase
argument_list|(
name|SpecialField
operator|.
name|PRINTED
argument_list|,
name|factory
argument_list|)
argument_list|)
expr_stmt|;
name|menuItemAdded
operator|=
literal|true
expr_stmt|;
block|}
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|SHOWCOLUMN_PRIORITY
argument_list|)
condition|)
block|{
name|edit
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|SpecialFieldMenuItemFactory
operator|.
name|createSpecialFieldMenuForActiveDatabase
argument_list|(
name|SpecialField
operator|.
name|PRIORITY
argument_list|,
name|factory
argument_list|,
name|undoManager
argument_list|)
argument_list|)
expr_stmt|;
name|menuItemAdded
operator|=
literal|true
expr_stmt|;
block|}
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|SHOWCOLUMN_READ
argument_list|)
condition|)
block|{
name|edit
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|SpecialFieldMenuItemFactory
operator|.
name|createSpecialFieldMenuForActiveDatabase
argument_list|(
name|SpecialField
operator|.
name|READ_STATUS
argument_list|,
name|factory
argument_list|,
name|undoManager
argument_list|)
argument_list|)
expr_stmt|;
name|menuItemAdded
operator|=
literal|true
expr_stmt|;
block|}
if|if
condition|(
name|menuItemAdded
condition|)
block|{
name|edit
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
operator|new
name|SeparatorMenuItem
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
comment|//@formatter:off
name|library
operator|.
name|getItems
argument_list|()
operator|.
name|addAll
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|NEW_ENTRY
argument_list|,
operator|new
name|NewEntryAction
argument_list|(
name|this
argument_list|,
name|dialogService
argument_list|,
name|Globals
operator|.
name|prefs
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|DELETE_ENTRY
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|DELETE
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
operator|new
name|SeparatorMenuItem
argument_list|()
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|LIBRARY_PROPERTIES
argument_list|,
operator|new
name|LibraryPropertiesAction
argument_list|(
name|this
argument_list|,
name|dialogService
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|EDIT_PREAMBLE
argument_list|,
operator|new
name|PreambleEditor
argument_list|(
name|stateManager
argument_list|,
name|undoManager
argument_list|,
name|this
operator|.
name|getDialogService
argument_list|()
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|EDIT_STRINGS
argument_list|,
operator|new
name|BibtexStringEditorAction
argument_list|(
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|MANAGE_CITE_KEY_PATTERNS
argument_list|,
operator|new
name|BibtexKeyPatternAction
argument_list|(
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|MASS_SET_FIELDS
argument_list|,
operator|new
name|MassSetFieldsAction
argument_list|(
name|stateManager
argument_list|,
name|dialogService
argument_list|,
name|undoManager
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|Menu
name|lookupIdentifiers
init|=
name|factory
operator|.
name|createSubMenu
argument_list|(
name|StandardActions
operator|.
name|LOOKUP_DOC_IDENTIFIER
argument_list|)
decl_stmt|;
for|for
control|(
name|IdFetcher
argument_list|<
name|?
argument_list|>
name|fetcher
range|:
name|WebFetchers
operator|.
name|getIdFetchers
argument_list|(
name|Globals
operator|.
name|prefs
operator|.
name|getImportFormatPreferences
argument_list|()
argument_list|)
control|)
block|{
name|LookupIdentifierAction
argument_list|<
name|?
argument_list|>
name|identifierAction
init|=
operator|new
name|LookupIdentifierAction
argument_list|<>
argument_list|(
name|this
argument_list|,
name|fetcher
argument_list|,
name|stateManager
argument_list|,
name|undoManager
argument_list|)
decl_stmt|;
name|lookupIdentifiers
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|identifierAction
operator|.
name|getAction
argument_list|()
argument_list|,
name|identifierAction
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|quality
operator|.
name|getItems
argument_list|()
operator|.
name|addAll
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|FIND_DUPLICATES
argument_list|,
operator|new
name|DuplicateSearch
argument_list|(
name|this
argument_list|,
name|dialogService
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|MERGE_ENTRIES
argument_list|,
operator|new
name|MergeEntriesAction
argument_list|(
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|CHECK_INTEGRITY
argument_list|,
operator|new
name|IntegrityCheckAction
argument_list|(
name|this
argument_list|,
name|stateManager
argument_list|,
name|Globals
operator|.
name|TASK_EXECUTOR
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|CLEANUP_ENTRIES
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|CLEANUP
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
operator|new
name|SeparatorMenuItem
argument_list|()
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|SET_FILE_LINKS
argument_list|,
operator|new
name|AutoLinkFilesAction
argument_list|(
name|this
argument_list|,
name|prefs
argument_list|,
name|stateManager
argument_list|,
name|undoManager
argument_list|,
name|Globals
operator|.
name|TASK_EXECUTOR
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
comment|// PushToApplication
specifier|final
name|PushToApplicationAction
name|pushToApplicationAction
init|=
name|pushToApplicationsManager
operator|.
name|getPushToApplicationAction
argument_list|()
decl_stmt|;
specifier|final
name|MenuItem
name|pushToApplicationMenuItem
init|=
name|factory
operator|.
name|createMenuItem
argument_list|(
name|pushToApplicationAction
operator|.
name|getActionInformation
argument_list|()
argument_list|,
name|pushToApplicationAction
argument_list|)
decl_stmt|;
name|pushToApplicationsManager
operator|.
name|setMenuItem
argument_list|(
name|pushToApplicationMenuItem
argument_list|)
expr_stmt|;
name|tools
operator|.
name|getItems
argument_list|()
operator|.
name|addAll
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|PARSE_TEX
argument_list|,
operator|new
name|ParseTexAction
argument_list|(
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|NEW_SUB_LIBRARY_FROM_AUX
argument_list|,
operator|new
name|NewSubLibraryAction
argument_list|(
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|FIND_UNLINKED_FILES
argument_list|,
operator|new
name|FindUnlinkedFilesAction
argument_list|(
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|WRITE_XMP
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|WRITE_XMP
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|COPY_LINKED_FILES
argument_list|,
operator|new
name|CopyFilesAction
argument_list|(
name|stateManager
argument_list|,
name|this
operator|.
name|getDialogService
argument_list|()
argument_list|)
argument_list|)
argument_list|,
operator|new
name|SeparatorMenuItem
argument_list|()
argument_list|,
name|lookupIdentifiers
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|DOWNLOAD_FULL_TEXT
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|DOWNLOAD_FULL_TEXT
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
operator|new
name|SeparatorMenuItem
argument_list|()
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|GENERATE_CITE_KEYS
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|MAKE_KEY
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|REPLACE_ALL
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|REPLACE_ALL
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|SEND_AS_EMAIL
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|SEND_AS_EMAIL
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|pushToApplicationMenuItem
argument_list|,
name|factory
operator|.
name|createSubMenu
argument_list|(
name|StandardActions
operator|.
name|ABBREVIATE
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|ABBREVIATE_ISO
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|ABBREVIATE_ISO
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|ABBREVIATE_MEDLINE
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|ABBREVIATE_MEDLINE
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|UNABBREVIATE
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|UNABBREVIATE
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|SidePaneComponent
name|webSearch
init|=
name|sidePaneManager
operator|.
name|getComponent
argument_list|(
name|SidePaneType
operator|.
name|WEB_SEARCH
argument_list|)
decl_stmt|;
name|SidePaneComponent
name|groups
init|=
name|sidePaneManager
operator|.
name|getComponent
argument_list|(
name|SidePaneType
operator|.
name|GROUPS
argument_list|)
decl_stmt|;
name|SidePaneComponent
name|openOffice
init|=
name|sidePaneManager
operator|.
name|getComponent
argument_list|(
name|SidePaneType
operator|.
name|OPEN_OFFICE
argument_list|)
decl_stmt|;
name|view
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
operator|new
name|SeparatorMenuItem
argument_list|()
argument_list|)
expr_stmt|;
name|view
operator|.
name|setOnShowing
argument_list|(
name|event
lambda|->
block|{
name|view
operator|.
name|getItems
argument_list|()
operator|.
name|clear
argument_list|()
expr_stmt|;
name|view
operator|.
name|getItems
argument_list|()
operator|.
name|addAll
argument_list|(
name|factory
operator|.
name|createCheckMenuItem
argument_list|(
name|webSearch
operator|.
name|getToggleAction
argument_list|()
argument_list|,
name|webSearch
operator|.
name|getToggleCommand
argument_list|()
argument_list|,
name|sidePaneManager
operator|.
name|isComponentVisible
argument_list|(
name|SidePaneType
operator|.
name|WEB_SEARCH
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createCheckMenuItem
argument_list|(
name|groups
operator|.
name|getToggleAction
argument_list|()
argument_list|,
name|groups
operator|.
name|getToggleCommand
argument_list|()
argument_list|,
name|sidePaneManager
operator|.
name|isComponentVisible
argument_list|(
name|SidePaneType
operator|.
name|GROUPS
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createCheckMenuItem
argument_list|(
name|openOffice
operator|.
name|getToggleAction
argument_list|()
argument_list|,
name|openOffice
operator|.
name|getToggleCommand
argument_list|()
argument_list|,
name|sidePaneManager
operator|.
name|isComponentVisible
argument_list|(
name|SidePaneType
operator|.
name|OPEN_OFFICE
argument_list|)
argument_list|)
argument_list|,
operator|new
name|SeparatorMenuItem
argument_list|()
argument_list|,
name|factory
operator|.
name|createCheckMenuItem
argument_list|(
name|StandardActions
operator|.
name|TOGGLE_PREVIEW
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|TOGGLE_PREVIEW
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|,
name|Globals
operator|.
name|prefs
operator|.
name|getPreviewPreferences
argument_list|()
operator|.
name|isPreviewPanelEnabled
argument_list|()
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|NEXT_PREVIEW_STYLE
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|NEXT_PREVIEW_STYLE
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|PREVIOUS_PREVIEW_STYLE
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|PREVIOUS_PREVIEW_STYLE
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
operator|new
name|SeparatorMenuItem
argument_list|()
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|SHOW_PDF_VIEWER
argument_list|,
operator|new
name|ShowDocumentViewerAction
argument_list|()
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|EDIT_ENTRY
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|EDIT
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|OPEN_CONSOLE
argument_list|,
operator|new
name|OldDatabaseCommandWrapper
argument_list|(
name|Actions
operator|.
name|OPEN_CONSOLE
argument_list|,
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
argument_list|)
expr_stmt|;
name|options
operator|.
name|getItems
argument_list|()
operator|.
name|addAll
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|SHOW_PREFS
argument_list|,
operator|new
name|ShowPreferencesAction
argument_list|(
name|this
argument_list|,
name|Globals
operator|.
name|TASK_EXECUTOR
argument_list|)
argument_list|)
argument_list|,
operator|new
name|SeparatorMenuItem
argument_list|()
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|SETUP_GENERAL_FIELDS
argument_list|,
operator|new
name|SetupGeneralFieldsAction
argument_list|()
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|MANAGE_CUSTOM_IMPORTS
argument_list|,
operator|new
name|ManageCustomImportsAction
argument_list|()
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|MANAGE_CUSTOM_EXPORTS
argument_list|,
operator|new
name|ManageCustomExportsAction
argument_list|()
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|MANAGE_EXTERNAL_FILETYPES
argument_list|,
operator|new
name|EditExternalFileTypesAction
argument_list|()
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|MANAGE_JOURNALS
argument_list|,
operator|new
name|ManageJournalsAction
argument_list|()
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|CUSTOMIZE_KEYBINDING
argument_list|,
operator|new
name|CustomizeKeyBindingAction
argument_list|()
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|MANAGE_PROTECTED_TERMS
argument_list|,
operator|new
name|ManageProtectedTermsAction
argument_list|()
argument_list|)
argument_list|,
operator|new
name|SeparatorMenuItem
argument_list|()
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|MANAGE_CONTENT_SELECTORS
argument_list|,
operator|new
name|ManageContentSelectorAction
argument_list|(
name|this
argument_list|,
name|stateManager
argument_list|)
argument_list|)
comment|// TODO: Reenable customize entry types feature (https://github.com/JabRef/jabref/issues/4719)
comment|//factory.createMenuItem(StandardActions.CUSTOMIZE_ENTRY_TYPES, new CustomizeEntryAction(this)),
argument_list|)
expr_stmt|;
name|help
operator|.
name|getItems
argument_list|()
operator|.
name|addAll
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|HELP
argument_list|,
name|HelpAction
operator|.
name|getMainHelpPageCommand
argument_list|()
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|OPEN_FORUM
argument_list|,
operator|new
name|OpenBrowserAction
argument_list|(
literal|"http://discourse.jabref.org/"
argument_list|)
argument_list|)
argument_list|,
operator|new
name|SeparatorMenuItem
argument_list|()
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|ERROR_CONSOLE
argument_list|,
operator|new
name|ErrorConsoleAction
argument_list|()
argument_list|)
argument_list|,
operator|new
name|SeparatorMenuItem
argument_list|()
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|SEARCH_FOR_UPDATES
argument_list|,
operator|new
name|SearchForUpdateAction
argument_list|(
name|Globals
operator|.
name|BUILD_INFO
argument_list|,
name|prefs
operator|.
name|getVersionPreferences
argument_list|()
argument_list|,
name|dialogService
argument_list|,
name|Globals
operator|.
name|TASK_EXECUTOR
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createSubMenu
argument_list|(
name|StandardActions
operator|.
name|WEB_MENU
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|OPEN_WEBPAGE
argument_list|,
operator|new
name|OpenBrowserAction
argument_list|(
literal|"https://jabref.org/"
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|OPEN_BLOG
argument_list|,
operator|new
name|OpenBrowserAction
argument_list|(
literal|"https://blog.jabref.org/"
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|OPEN_FACEBOOK
argument_list|,
operator|new
name|OpenBrowserAction
argument_list|(
literal|"https://www.facebook.com/JabRef/"
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|OPEN_TWITTER
argument_list|,
operator|new
name|OpenBrowserAction
argument_list|(
literal|"https://twitter.com/jabref_org"
argument_list|)
argument_list|)
argument_list|,
operator|new
name|SeparatorMenuItem
argument_list|()
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|FORK_ME
argument_list|,
operator|new
name|OpenBrowserAction
argument_list|(
literal|"https://github.com/JabRef/jabref"
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|OPEN_DEV_VERSION_LINK
argument_list|,
operator|new
name|OpenBrowserAction
argument_list|(
literal|"https://builds.jabref.org/master/"
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|OPEN_CHANGELOG
argument_list|,
operator|new
name|OpenBrowserAction
argument_list|(
literal|"https://github.com/JabRef/jabref/blob/master/CHANGELOG.md"
argument_list|)
argument_list|)
argument_list|,
operator|new
name|SeparatorMenuItem
argument_list|()
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|DONATE
argument_list|,
operator|new
name|OpenBrowserAction
argument_list|(
literal|"https://donations.jabref.org"
argument_list|)
argument_list|)
argument_list|)
argument_list|,
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|ABOUT
argument_list|,
operator|new
name|AboutAction
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
comment|//@formatter:on
name|MenuBar
name|menu
init|=
operator|new
name|MenuBar
argument_list|()
decl_stmt|;
name|menu
operator|.
name|getStyleClass
argument_list|()
operator|.
name|add
argument_list|(
literal|"mainMenu"
argument_list|)
expr_stmt|;
name|menu
operator|.
name|getMenus
argument_list|()
operator|.
name|addAll
argument_list|(
name|file
argument_list|,
name|edit
argument_list|,
name|library
argument_list|,
name|quality
argument_list|,
name|tools
argument_list|,
name|view
argument_list|,
name|options
argument_list|,
name|help
argument_list|)
expr_stmt|;
name|menu
operator|.
name|setUseSystemMenuBar
argument_list|(
literal|true
argument_list|)
expr_stmt|;
return|return
name|menu
return|;
block|}
DECL|method|addParserResult (ParserResult pr, boolean focusPanel)
specifier|public
name|void
name|addParserResult
parameter_list|(
name|ParserResult
name|pr
parameter_list|,
name|boolean
name|focusPanel
parameter_list|)
block|{
if|if
condition|(
name|pr
operator|.
name|toOpenTab
argument_list|()
condition|)
block|{
comment|// Add the entries to the open tab.
name|BasePanel
name|panel
init|=
name|getCurrentBasePanel
argument_list|()
decl_stmt|;
if|if
condition|(
name|panel
operator|==
literal|null
condition|)
block|{
comment|// There is no open tab to add to, so we create a new tab:
name|addTab
argument_list|(
name|pr
operator|.
name|getDatabaseContext
argument_list|()
argument_list|,
name|focusPanel
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|List
argument_list|<
name|BibEntry
argument_list|>
name|entries
init|=
operator|new
name|ArrayList
argument_list|<>
argument_list|(
name|pr
operator|.
name|getDatabase
argument_list|()
operator|.
name|getEntries
argument_list|()
argument_list|)
decl_stmt|;
name|addImportedEntries
argument_list|(
name|panel
argument_list|,
name|entries
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
comment|// only add tab if DB is not already open
name|Optional
argument_list|<
name|BasePanel
argument_list|>
name|panel
init|=
name|getBasePanelList
argument_list|()
operator|.
name|stream
argument_list|()
operator|.
name|filter
argument_list|(
name|p
lambda|->
name|p
operator|.
name|getBibDatabaseContext
argument_list|()
operator|.
name|getDatabasePath
argument_list|()
operator|.
name|equals
argument_list|(
name|pr
operator|.
name|getFile
argument_list|()
argument_list|)
argument_list|)
operator|.
name|findFirst
argument_list|()
decl_stmt|;
if|if
condition|(
name|panel
operator|.
name|isPresent
argument_list|()
condition|)
block|{
name|tabbedPane
operator|.
name|getSelectionModel
argument_list|()
operator|.
name|select
argument_list|(
name|getTab
argument_list|(
name|panel
operator|.
name|get
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|addTab
argument_list|(
name|pr
operator|.
name|getDatabaseContext
argument_list|()
argument_list|,
name|focusPanel
argument_list|)
expr_stmt|;
block|}
block|}
block|}
comment|/**      * This method causes all open BasePanels to set up their tables anew. When called from PrefsDialog3, this updates      * to the new settings.      */
DECL|method|setupAllTables ()
specifier|public
name|void
name|setupAllTables
parameter_list|()
block|{
comment|// This action can be invoked without an open database, so
comment|// we have to check if we have one before trying to invoke
comment|// methods to execute changes in the preferences.
comment|// We want to notify all tabs about the changes to
comment|// avoid problems when changing the column set.
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|tabbedPane
operator|.
name|getTabs
argument_list|()
operator|.
name|size
argument_list|()
condition|;
name|i
operator|++
control|)
block|{
name|BasePanel
name|bf
init|=
name|getBasePanelAt
argument_list|(
name|i
argument_list|)
decl_stmt|;
comment|// Update tables:
if|if
condition|(
name|bf
operator|.
name|getDatabase
argument_list|()
operator|!=
literal|null
condition|)
block|{
name|DefaultTaskExecutor
operator|.
name|runInJavaFXThread
argument_list|(
name|bf
operator|::
name|setupMainPanel
argument_list|)
expr_stmt|;
block|}
block|}
block|}
DECL|method|collectDatabaseFilePaths ()
specifier|private
name|List
argument_list|<
name|String
argument_list|>
name|collectDatabaseFilePaths
parameter_list|()
block|{
name|List
argument_list|<
name|String
argument_list|>
name|dbPaths
init|=
operator|new
name|ArrayList
argument_list|<>
argument_list|(
name|getBasePanelCount
argument_list|()
argument_list|)
decl_stmt|;
for|for
control|(
name|BasePanel
name|basePanel
range|:
name|getBasePanelList
argument_list|()
control|)
block|{
try|try
block|{
comment|// db file exists
if|if
condition|(
name|basePanel
operator|.
name|getBibDatabaseContext
argument_list|()
operator|.
name|getDatabaseFile
argument_list|()
operator|.
name|isPresent
argument_list|()
condition|)
block|{
name|dbPaths
operator|.
name|add
argument_list|(
name|basePanel
operator|.
name|getBibDatabaseContext
argument_list|()
operator|.
name|getDatabaseFile
argument_list|()
operator|.
name|get
argument_list|()
operator|.
name|getCanonicalPath
argument_list|()
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|dbPaths
operator|.
name|add
argument_list|(
literal|""
argument_list|)
expr_stmt|;
block|}
block|}
catch|catch
parameter_list|(
name|IOException
name|ex
parameter_list|)
block|{
name|LOGGER
operator|.
name|error
argument_list|(
literal|"Invalid database file path: "
operator|+
name|ex
operator|.
name|getMessage
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
return|return
name|dbPaths
return|;
block|}
DECL|method|getUniquePathParts ()
specifier|private
name|List
argument_list|<
name|String
argument_list|>
name|getUniquePathParts
parameter_list|()
block|{
name|List
argument_list|<
name|String
argument_list|>
name|dbPaths
init|=
name|collectDatabaseFilePaths
argument_list|()
decl_stmt|;
return|return
name|FileUtil
operator|.
name|uniquePathSubstrings
argument_list|(
name|dbPaths
argument_list|)
return|;
block|}
DECL|method|updateAllTabTitles ()
specifier|public
name|void
name|updateAllTabTitles
parameter_list|()
block|{
name|List
argument_list|<
name|String
argument_list|>
name|paths
init|=
name|getUniquePathParts
argument_list|()
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|getBasePanelCount
argument_list|()
condition|;
name|i
operator|++
control|)
block|{
name|String
name|uniqPath
init|=
name|paths
operator|.
name|get
argument_list|(
name|i
argument_list|)
decl_stmt|;
name|Optional
argument_list|<
name|File
argument_list|>
name|file
init|=
name|getBasePanelAt
argument_list|(
name|i
argument_list|)
operator|.
name|getBibDatabaseContext
argument_list|()
operator|.
name|getDatabaseFile
argument_list|()
decl_stmt|;
if|if
condition|(
name|file
operator|.
name|isPresent
argument_list|()
condition|)
block|{
if|if
condition|(
operator|!
name|uniqPath
operator|.
name|equals
argument_list|(
name|file
operator|.
name|get
argument_list|()
operator|.
name|getName
argument_list|()
argument_list|)
operator|&&
name|uniqPath
operator|.
name|contains
argument_list|(
name|File
operator|.
name|separator
argument_list|)
condition|)
block|{
comment|// remove filename
name|uniqPath
operator|=
name|uniqPath
operator|.
name|substring
argument_list|(
literal|0
argument_list|,
name|uniqPath
operator|.
name|lastIndexOf
argument_list|(
name|File
operator|.
name|separator
argument_list|)
argument_list|)
expr_stmt|;
name|tabbedPane
operator|.
name|getTabs
argument_list|()
operator|.
name|get
argument_list|(
name|i
argument_list|)
operator|.
name|setText
argument_list|(
name|getBasePanelAt
argument_list|(
name|i
argument_list|)
operator|.
name|getTabTitle
argument_list|()
operator|+
literal|" \u2014 "
operator|+
name|uniqPath
argument_list|)
expr_stmt|;
block|}
else|else
block|{
comment|// set original filename (again)
name|tabbedPane
operator|.
name|getTabs
argument_list|()
operator|.
name|get
argument_list|(
name|i
argument_list|)
operator|.
name|setText
argument_list|(
name|getBasePanelAt
argument_list|(
name|i
argument_list|)
operator|.
name|getTabTitle
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
else|else
block|{
name|tabbedPane
operator|.
name|getTabs
argument_list|()
operator|.
name|get
argument_list|(
name|i
argument_list|)
operator|.
name|setText
argument_list|(
name|getBasePanelAt
argument_list|(
name|i
argument_list|)
operator|.
name|getTabTitle
argument_list|()
argument_list|)
expr_stmt|;
block|}
name|tabbedPane
operator|.
name|getTabs
argument_list|()
operator|.
name|get
argument_list|(
name|i
argument_list|)
operator|.
name|setTooltip
argument_list|(
operator|new
name|Tooltip
argument_list|(
name|file
operator|.
name|map
argument_list|(
name|File
operator|::
name|getAbsolutePath
argument_list|)
operator|.
name|orElse
argument_list|(
literal|null
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
DECL|method|addTab (BasePanel basePanel, boolean raisePanel)
specifier|public
name|void
name|addTab
parameter_list|(
name|BasePanel
name|basePanel
parameter_list|,
name|boolean
name|raisePanel
parameter_list|)
block|{
name|DefaultTaskExecutor
operator|.
name|runInJavaFXThread
argument_list|(
parameter_list|()
lambda|->
block|{
comment|// add tab
name|Tab
name|newTab
init|=
operator|new
name|Tab
argument_list|(
name|basePanel
operator|.
name|getTabTitle
argument_list|()
argument_list|,
name|basePanel
argument_list|)
decl_stmt|;
name|tabbedPane
operator|.
name|getTabs
argument_list|()
operator|.
name|add
argument_list|(
name|newTab
argument_list|)
expr_stmt|;
name|newTab
operator|.
name|setOnCloseRequest
argument_list|(
name|event
lambda|->
block|{
name|closeTab
argument_list|(
operator|(
name|BasePanel
operator|)
name|newTab
operator|.
name|getContent
argument_list|()
argument_list|)
expr_stmt|;
name|event
operator|.
name|consume
argument_list|()
expr_stmt|;
block|}
argument_list|)
expr_stmt|;
comment|// update all tab titles
name|updateAllTabTitles
argument_list|()
expr_stmt|;
if|if
condition|(
name|raisePanel
condition|)
block|{
name|tabbedPane
operator|.
name|getSelectionModel
argument_list|()
operator|.
name|select
argument_list|(
name|newTab
argument_list|)
expr_stmt|;
block|}
comment|// Register undo/redo listener
name|basePanel
operator|.
name|getUndoManager
argument_list|()
operator|.
name|registerListener
argument_list|(
operator|new
name|UndoRedoEventManager
argument_list|()
argument_list|)
expr_stmt|;
name|BibDatabaseContext
name|context
init|=
name|basePanel
operator|.
name|getBibDatabaseContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|readyForAutosave
argument_list|(
name|context
argument_list|)
condition|)
block|{
name|AutosaveManager
name|autosaver
init|=
name|AutosaveManager
operator|.
name|start
argument_list|(
name|context
argument_list|)
decl_stmt|;
name|autosaver
operator|.
name|registerListener
argument_list|(
operator|new
name|AutosaveUIManager
argument_list|(
name|basePanel
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|BackupManager
operator|.
name|start
argument_list|(
name|context
argument_list|)
expr_stmt|;
comment|// Track opening
name|trackOpenNewDatabase
argument_list|(
name|basePanel
argument_list|)
expr_stmt|;
block|}
argument_list|)
expr_stmt|;
block|}
DECL|method|trackOpenNewDatabase (BasePanel basePanel)
specifier|private
name|void
name|trackOpenNewDatabase
parameter_list|(
name|BasePanel
name|basePanel
parameter_list|)
block|{
name|Map
argument_list|<
name|String
argument_list|,
name|String
argument_list|>
name|properties
init|=
operator|new
name|HashMap
argument_list|<>
argument_list|()
decl_stmt|;
name|Map
argument_list|<
name|String
argument_list|,
name|Double
argument_list|>
name|measurements
init|=
operator|new
name|HashMap
argument_list|<>
argument_list|()
decl_stmt|;
name|measurements
operator|.
name|put
argument_list|(
literal|"NumberOfEntries"
argument_list|,
operator|(
name|double
operator|)
name|basePanel
operator|.
name|getBibDatabaseContext
argument_list|()
operator|.
name|getDatabase
argument_list|()
operator|.
name|getEntryCount
argument_list|()
argument_list|)
expr_stmt|;
name|Globals
operator|.
name|getTelemetryClient
argument_list|()
operator|.
name|ifPresent
argument_list|(
name|client
lambda|->
name|client
operator|.
name|trackEvent
argument_list|(
literal|"OpenNewDatabase"
argument_list|,
name|properties
argument_list|,
name|measurements
argument_list|)
argument_list|)
expr_stmt|;
block|}
DECL|method|addTab (BibDatabaseContext databaseContext, boolean raisePanel)
specifier|public
name|BasePanel
name|addTab
parameter_list|(
name|BibDatabaseContext
name|databaseContext
parameter_list|,
name|boolean
name|raisePanel
parameter_list|)
block|{
name|Objects
operator|.
name|requireNonNull
argument_list|(
name|databaseContext
argument_list|)
expr_stmt|;
name|BasePanel
name|bp
init|=
operator|new
name|BasePanel
argument_list|(
name|this
argument_list|,
name|BasePanelPreferences
operator|.
name|from
argument_list|(
name|Globals
operator|.
name|prefs
argument_list|)
argument_list|,
name|databaseContext
argument_list|,
name|ExternalFileTypes
operator|.
name|getInstance
argument_list|()
argument_list|)
decl_stmt|;
name|addTab
argument_list|(
name|bp
argument_list|,
name|raisePanel
argument_list|)
expr_stmt|;
return|return
name|bp
return|;
block|}
DECL|method|readyForAutosave (BibDatabaseContext context)
specifier|private
name|boolean
name|readyForAutosave
parameter_list|(
name|BibDatabaseContext
name|context
parameter_list|)
block|{
return|return
operator|(
operator|(
name|context
operator|.
name|getLocation
argument_list|()
operator|==
name|DatabaseLocation
operator|.
name|SHARED
operator|)
operator|||
operator|(
operator|(
name|context
operator|.
name|getLocation
argument_list|()
operator|==
name|DatabaseLocation
operator|.
name|LOCAL
operator|)
operator|&&
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|LOCAL_AUTO_SAVE
argument_list|)
operator|)
operator|)
operator|&&
name|context
operator|.
name|getDatabaseFile
argument_list|()
operator|.
name|isPresent
argument_list|()
return|;
block|}
comment|/**      * Opens the import inspection dialog to let the user decide which of the given entries to import.      *      * @param panel   The BasePanel to add to.      * @param entries The entries to add.      */
DECL|method|addImportedEntries (final BasePanel panel, final List<BibEntry> entries)
specifier|private
name|void
name|addImportedEntries
parameter_list|(
specifier|final
name|BasePanel
name|panel
parameter_list|,
specifier|final
name|List
argument_list|<
name|BibEntry
argument_list|>
name|entries
parameter_list|)
block|{
name|BackgroundTask
argument_list|<
name|List
argument_list|<
name|BibEntry
argument_list|>
argument_list|>
name|task
init|=
name|BackgroundTask
operator|.
name|wrap
argument_list|(
parameter_list|()
lambda|->
name|entries
argument_list|)
decl_stmt|;
name|ImportEntriesDialog
name|dialog
init|=
operator|new
name|ImportEntriesDialog
argument_list|(
name|panel
operator|.
name|getBibDatabaseContext
argument_list|()
argument_list|,
name|task
argument_list|)
decl_stmt|;
name|dialog
operator|.
name|setTitle
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Import"
argument_list|)
argument_list|)
expr_stmt|;
name|dialog
operator|.
name|showAndWait
argument_list|()
expr_stmt|;
block|}
DECL|method|getFileHistory ()
specifier|public
name|FileHistoryMenu
name|getFileHistory
parameter_list|()
block|{
return|return
name|fileHistory
return|;
block|}
comment|/**      * Set the visibility of the progress bar in the right end of the status line at the bottom of the frame.      */
DECL|method|setProgressBarVisible (final boolean visible)
specifier|public
name|void
name|setProgressBarVisible
parameter_list|(
specifier|final
name|boolean
name|visible
parameter_list|)
block|{
name|progressBar
operator|.
name|setVisible
argument_list|(
name|visible
argument_list|)
expr_stmt|;
block|}
comment|/**      * Sets the indeterminate status of the progress bar.      *<p>      * If not called on the event dispatch thread, this method uses SwingUtilities.invokeLater() to do the actual      * operation on the EDT.      */
DECL|method|setProgressBarIndeterminate (final boolean value)
specifier|public
name|void
name|setProgressBarIndeterminate
parameter_list|(
specifier|final
name|boolean
name|value
parameter_list|)
block|{
comment|// TODO: Reimplement
comment|/*         if (SwingUtilities.isEventDispatchThread()) {             progressBar.setIndeterminate(value);         } else {             SwingUtilities.invokeLater(() -> progressBar.setIndeterminate(value));         }         */
block|}
comment|/**      * Return a boolean, if the selected entry have file      *      * @param selectEntryList A selected entries list of the current base pane      * @return true, if the selected entry contains file. false, if multiple entries are selected or the selected entry      * doesn't contains file      */
DECL|method|isExistFile (List<BibEntry> selectEntryList)
specifier|private
name|boolean
name|isExistFile
parameter_list|(
name|List
argument_list|<
name|BibEntry
argument_list|>
name|selectEntryList
parameter_list|)
block|{
if|if
condition|(
name|selectEntryList
operator|.
name|size
argument_list|()
operator|==
literal|1
condition|)
block|{
name|BibEntry
name|selectedEntry
init|=
name|selectEntryList
operator|.
name|get
argument_list|(
literal|0
argument_list|)
decl_stmt|;
return|return
name|selectedEntry
operator|.
name|getField
argument_list|(
name|FieldName
operator|.
name|FILE
argument_list|)
operator|.
name|isPresent
argument_list|()
return|;
block|}
return|return
literal|false
return|;
block|}
comment|/**      * Return a boolean, if the selected entry have url or doi      *      * @param selectEntryList A selected entries list of the current base pane      * @return true, if the selected entry contains url or doi. false, if multiple entries are selected or the selected      * entry doesn't contains url or doi      */
DECL|method|isExistURLorDOI (List<BibEntry> selectEntryList)
specifier|private
name|boolean
name|isExistURLorDOI
parameter_list|(
name|List
argument_list|<
name|BibEntry
argument_list|>
name|selectEntryList
parameter_list|)
block|{
if|if
condition|(
name|selectEntryList
operator|.
name|size
argument_list|()
operator|==
literal|1
condition|)
block|{
name|BibEntry
name|selectedEntry
init|=
name|selectEntryList
operator|.
name|get
argument_list|(
literal|0
argument_list|)
decl_stmt|;
return|return
operator|(
name|selectedEntry
operator|.
name|getField
argument_list|(
name|FieldName
operator|.
name|URL
argument_list|)
operator|.
name|isPresent
argument_list|()
operator|||
name|selectedEntry
operator|.
name|getField
argument_list|(
name|FieldName
operator|.
name|DOI
argument_list|)
operator|.
name|isPresent
argument_list|()
operator|)
return|;
block|}
return|return
literal|false
return|;
block|}
DECL|method|showMessage (String message)
specifier|public
name|void
name|showMessage
parameter_list|(
name|String
name|message
parameter_list|)
block|{
name|JOptionPane
operator|.
name|showMessageDialog
argument_list|(
literal|null
argument_list|,
name|message
argument_list|)
expr_stmt|;
block|}
comment|/**      * Ask if the user really wants to close the given database      *      * @return true if the user choose to close the database      */
DECL|method|confirmClose (BasePanel panel)
specifier|private
name|boolean
name|confirmClose
parameter_list|(
name|BasePanel
name|panel
parameter_list|)
block|{
name|String
name|filename
init|=
name|panel
operator|.
name|getBibDatabaseContext
argument_list|()
operator|.
name|getDatabasePath
argument_list|()
operator|.
name|map
argument_list|(
name|Path
operator|::
name|toAbsolutePath
argument_list|)
operator|.
name|map
argument_list|(
name|Path
operator|::
name|toString
argument_list|)
operator|.
name|orElse
argument_list|(
name|GUIGlobals
operator|.
name|UNTITLED_TITLE
argument_list|)
decl_stmt|;
name|ButtonType
name|saveChanges
init|=
operator|new
name|ButtonType
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Save changes"
argument_list|)
argument_list|,
name|ButtonBar
operator|.
name|ButtonData
operator|.
name|YES
argument_list|)
decl_stmt|;
name|ButtonType
name|discardChanges
init|=
operator|new
name|ButtonType
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Discard changes"
argument_list|)
argument_list|,
name|ButtonBar
operator|.
name|ButtonData
operator|.
name|NO
argument_list|)
decl_stmt|;
name|ButtonType
name|cancel
init|=
operator|new
name|ButtonType
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Return to JabRef"
argument_list|)
argument_list|,
name|ButtonBar
operator|.
name|ButtonData
operator|.
name|CANCEL_CLOSE
argument_list|)
decl_stmt|;
name|Optional
argument_list|<
name|ButtonType
argument_list|>
name|response
init|=
name|dialogService
operator|.
name|showCustomButtonDialogAndWait
argument_list|(
name|Alert
operator|.
name|AlertType
operator|.
name|CONFIRMATION
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Save before closing"
argument_list|)
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Library '%0' has changed."
argument_list|,
name|filename
argument_list|)
argument_list|,
name|saveChanges
argument_list|,
name|discardChanges
argument_list|,
name|cancel
argument_list|)
decl_stmt|;
if|if
condition|(
name|response
operator|.
name|isPresent
argument_list|()
operator|&&
name|response
operator|.
name|get
argument_list|()
operator|.
name|equals
argument_list|(
name|saveChanges
argument_list|)
condition|)
block|{
comment|// The user wants to save.
try|try
block|{
name|SaveDatabaseAction
name|saveAction
init|=
operator|new
name|SaveDatabaseAction
argument_list|(
name|panel
argument_list|,
name|Globals
operator|.
name|prefs
argument_list|)
decl_stmt|;
if|if
condition|(
name|saveAction
operator|.
name|save
argument_list|()
condition|)
block|{
comment|// Saved, now exit.
return|return
literal|true
return|;
block|}
comment|// The action was either canceled or unsuccessful.
name|dialogService
operator|.
name|notify
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Unable to save library"
argument_list|)
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|Throwable
name|ex
parameter_list|)
block|{
name|LOGGER
operator|.
name|error
argument_list|(
literal|"A problem occurred when trying to save the file"
argument_list|,
name|ex
argument_list|)
expr_stmt|;
name|dialogService
operator|.
name|showErrorDialogAndWait
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Save library"
argument_list|)
argument_list|,
name|Localization
operator|.
name|lang
argument_list|(
literal|"Could not save file."
argument_list|)
argument_list|,
name|ex
argument_list|)
expr_stmt|;
block|}
comment|// Save was cancelled or an error occurred.
return|return
literal|false
return|;
block|}
return|return
operator|!
name|response
operator|.
name|isPresent
argument_list|()
operator|||
operator|!
name|response
operator|.
name|get
argument_list|()
operator|.
name|equals
argument_list|(
name|cancel
argument_list|)
return|;
block|}
DECL|method|closeTab (BasePanel panel)
specifier|private
name|void
name|closeTab
parameter_list|(
name|BasePanel
name|panel
parameter_list|)
block|{
comment|// empty tab without database
if|if
condition|(
name|panel
operator|==
literal|null
condition|)
block|{
return|return;
block|}
name|BibDatabaseContext
name|context
init|=
name|panel
operator|.
name|getBibDatabaseContext
argument_list|()
decl_stmt|;
if|if
condition|(
name|panel
operator|.
name|isModified
argument_list|()
operator|&&
operator|(
name|context
operator|.
name|getLocation
argument_list|()
operator|==
name|DatabaseLocation
operator|.
name|LOCAL
operator|)
condition|)
block|{
if|if
condition|(
name|confirmClose
argument_list|(
name|panel
argument_list|)
condition|)
block|{
name|removeTab
argument_list|(
name|panel
argument_list|)
expr_stmt|;
block|}
else|else
block|{
return|return;
block|}
block|}
elseif|else
if|if
condition|(
name|context
operator|.
name|getLocation
argument_list|()
operator|==
name|DatabaseLocation
operator|.
name|SHARED
condition|)
block|{
name|context
operator|.
name|convertToLocalDatabase
argument_list|()
expr_stmt|;
name|context
operator|.
name|getDBMSSynchronizer
argument_list|()
operator|.
name|closeSharedDatabase
argument_list|()
expr_stmt|;
name|context
operator|.
name|clearDBMSSynchronizer
argument_list|()
expr_stmt|;
name|removeTab
argument_list|(
name|panel
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|removeTab
argument_list|(
name|panel
argument_list|)
expr_stmt|;
block|}
name|AutosaveManager
operator|.
name|shutdown
argument_list|(
name|context
argument_list|)
expr_stmt|;
name|BackupManager
operator|.
name|shutdown
argument_list|(
name|context
argument_list|)
expr_stmt|;
block|}
DECL|method|removeTab (BasePanel panel)
specifier|private
name|void
name|removeTab
parameter_list|(
name|BasePanel
name|panel
parameter_list|)
block|{
name|DefaultTaskExecutor
operator|.
name|runInJavaFXThread
argument_list|(
parameter_list|()
lambda|->
block|{
name|panel
operator|.
name|cleanUp
argument_list|()
expr_stmt|;
name|tabbedPane
operator|.
name|getTabs
argument_list|()
operator|.
name|remove
argument_list|(
name|getTab
argument_list|(
name|panel
argument_list|)
argument_list|)
expr_stmt|;
name|setWindowTitle
argument_list|()
expr_stmt|;
name|dialogService
operator|.
name|notify
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Closed library"
argument_list|)
operator|+
literal|'.'
argument_list|)
expr_stmt|;
comment|// update tab titles
name|updateAllTabTitles
argument_list|()
expr_stmt|;
block|}
argument_list|)
expr_stmt|;
block|}
DECL|method|closeCurrentTab ()
specifier|public
name|void
name|closeCurrentTab
parameter_list|()
block|{
name|removeTab
argument_list|(
name|getCurrentBasePanel
argument_list|()
argument_list|)
expr_stmt|;
block|}
DECL|method|getOpenDatabaseAction ()
specifier|public
name|OpenDatabaseAction
name|getOpenDatabaseAction
parameter_list|()
block|{
return|return
operator|new
name|OpenDatabaseAction
argument_list|(
name|this
argument_list|)
return|;
block|}
DECL|method|getSidePaneManager ()
specifier|public
name|SidePaneManager
name|getSidePaneManager
parameter_list|()
block|{
return|return
name|sidePaneManager
return|;
block|}
DECL|method|getPushToApplicationsManager ()
specifier|public
name|PushToApplicationsManager
name|getPushToApplicationsManager
parameter_list|()
block|{
return|return
name|pushToApplicationsManager
return|;
block|}
DECL|method|getGlobalSearchBar ()
specifier|public
name|GlobalSearchBar
name|getGlobalSearchBar
parameter_list|()
block|{
return|return
name|globalSearchBar
return|;
block|}
DECL|method|getUndoManager ()
specifier|public
name|CountingUndoManager
name|getUndoManager
parameter_list|()
block|{
return|return
name|undoManager
return|;
block|}
DECL|method|getDialogService ()
specifier|public
name|DialogService
name|getDialogService
parameter_list|()
block|{
return|return
name|dialogService
return|;
block|}
comment|/**      * The action concerned with closing the window.      */
DECL|class|CloseAction
specifier|private
class|class
name|CloseAction
extends|extends
name|SimpleCommand
block|{
annotation|@
name|Override
DECL|method|execute ()
specifier|public
name|void
name|execute
parameter_list|()
block|{
name|quit
argument_list|()
expr_stmt|;
block|}
block|}
comment|/**      * Class for handling general actions; cut, copy and paste. The focused component is kept track of by      * Globals.focusListener, and we call the action stored under the relevant name in its action map.      */
DECL|class|EditAction
specifier|private
class|class
name|EditAction
extends|extends
name|SimpleCommand
block|{
DECL|field|command
specifier|private
specifier|final
name|Actions
name|command
decl_stmt|;
DECL|method|EditAction (Actions command)
specifier|public
name|EditAction
parameter_list|(
name|Actions
name|command
parameter_list|)
block|{
name|this
operator|.
name|command
operator|=
name|command
expr_stmt|;
block|}
annotation|@
name|Override
DECL|method|execute ()
specifier|public
name|void
name|execute
parameter_list|()
block|{
name|Node
name|focusOwner
init|=
name|mainStage
operator|.
name|getScene
argument_list|()
operator|.
name|getFocusOwner
argument_list|()
decl_stmt|;
if|if
condition|(
name|focusOwner
operator|!=
literal|null
condition|)
block|{
if|if
condition|(
name|focusOwner
operator|instanceof
name|TextInputControl
condition|)
block|{
comment|// Focus is on text field -> copy/paste/cut selected text
name|TextInputControl
name|textInput
init|=
operator|(
name|TextInputControl
operator|)
name|focusOwner
decl_stmt|;
switch|switch
condition|(
name|command
condition|)
block|{
case|case
name|COPY
case|:
name|textInput
operator|.
name|copy
argument_list|()
expr_stmt|;
break|break;
case|case
name|CUT
case|:
name|textInput
operator|.
name|cut
argument_list|()
expr_stmt|;
break|break;
case|case
name|PASTE
case|:
name|textInput
operator|.
name|paste
argument_list|()
expr_stmt|;
break|break;
default|default:
throw|throw
operator|new
name|IllegalStateException
argument_list|(
literal|"Only cut/copy/paste supported but got "
operator|+
name|command
argument_list|)
throw|;
block|}
block|}
else|else
block|{
comment|// Not sure what is selected -> copy/paste/cut selected entries
switch|switch
condition|(
name|command
condition|)
block|{
case|case
name|COPY
case|:
name|getCurrentBasePanel
argument_list|()
operator|.
name|copy
argument_list|()
expr_stmt|;
break|break;
case|case
name|CUT
case|:
name|getCurrentBasePanel
argument_list|()
operator|.
name|cut
argument_list|()
expr_stmt|;
break|break;
case|case
name|PASTE
case|:
name|getCurrentBasePanel
argument_list|()
operator|.
name|paste
argument_list|()
expr_stmt|;
break|break;
default|default:
throw|throw
operator|new
name|IllegalStateException
argument_list|(
literal|"Only cut/copy/paste supported but got "
operator|+
name|command
argument_list|)
throw|;
block|}
block|}
block|}
block|}
block|}
DECL|method|setDefaultTableFontSize ()
specifier|private
name|void
name|setDefaultTableFontSize
parameter_list|()
block|{
name|GUIGlobals
operator|.
name|setFont
argument_list|(
name|Globals
operator|.
name|prefs
operator|.
name|getIntDefault
argument_list|(
name|JabRefPreferences
operator|.
name|FONT_SIZE
argument_list|)
argument_list|)
expr_stmt|;
for|for
control|(
name|BasePanel
name|basePanel
range|:
name|getBasePanelList
argument_list|()
control|)
block|{
name|basePanel
operator|.
name|updateTableFont
argument_list|()
expr_stmt|;
block|}
name|dialogService
operator|.
name|notify
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Table font size is %0"
argument_list|,
name|String
operator|.
name|valueOf
argument_list|(
name|GUIGlobals
operator|.
name|currentFont
operator|.
name|getSize
argument_list|()
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
DECL|method|increaseTableFontSize ()
specifier|private
name|void
name|increaseTableFontSize
parameter_list|()
block|{
name|GUIGlobals
operator|.
name|setFont
argument_list|(
name|GUIGlobals
operator|.
name|currentFont
operator|.
name|getSize
argument_list|()
operator|+
literal|1
argument_list|)
expr_stmt|;
for|for
control|(
name|BasePanel
name|basePanel
range|:
name|getBasePanelList
argument_list|()
control|)
block|{
name|basePanel
operator|.
name|updateTableFont
argument_list|()
expr_stmt|;
block|}
name|dialogService
operator|.
name|notify
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Table font size is %0"
argument_list|,
name|String
operator|.
name|valueOf
argument_list|(
name|GUIGlobals
operator|.
name|currentFont
operator|.
name|getSize
argument_list|()
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
DECL|method|decreaseTableFontSize ()
specifier|private
name|void
name|decreaseTableFontSize
parameter_list|()
block|{
name|int
name|currentSize
init|=
name|GUIGlobals
operator|.
name|currentFont
operator|.
name|getSize
argument_list|()
decl_stmt|;
if|if
condition|(
name|currentSize
operator|<
literal|2
condition|)
block|{
return|return;
block|}
name|GUIGlobals
operator|.
name|setFont
argument_list|(
name|currentSize
operator|-
literal|1
argument_list|)
expr_stmt|;
for|for
control|(
name|BasePanel
name|basePanel
range|:
name|getBasePanelList
argument_list|()
control|)
block|{
name|basePanel
operator|.
name|updateTableFont
argument_list|()
expr_stmt|;
block|}
name|dialogService
operator|.
name|notify
argument_list|(
name|Localization
operator|.
name|lang
argument_list|(
literal|"Table font size is %0"
argument_list|,
name|String
operator|.
name|valueOf
argument_list|(
name|GUIGlobals
operator|.
name|currentFont
operator|.
name|getSize
argument_list|()
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
DECL|class|CloseDatabaseAction
specifier|private
class|class
name|CloseDatabaseAction
extends|extends
name|SimpleCommand
block|{
annotation|@
name|Override
DECL|method|execute ()
specifier|public
name|void
name|execute
parameter_list|()
block|{
name|closeTab
argument_list|(
name|getCurrentBasePanel
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
DECL|class|UndoRedoEventManager
specifier|private
class|class
name|UndoRedoEventManager
block|{
annotation|@
name|Subscribe
DECL|method|listen (UndoRedoEvent event)
specifier|public
name|void
name|listen
parameter_list|(
name|UndoRedoEvent
name|event
parameter_list|)
block|{
name|updateTexts
argument_list|(
name|event
argument_list|)
expr_stmt|;
name|JabRefFrame
operator|.
name|this
operator|.
name|getCurrentBasePanel
argument_list|()
operator|.
name|updateEntryEditorIfShowing
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Subscribe
DECL|method|listen (AddUndoableActionEvent event)
specifier|public
name|void
name|listen
parameter_list|(
name|AddUndoableActionEvent
name|event
parameter_list|)
block|{
name|updateTexts
argument_list|(
name|event
argument_list|)
expr_stmt|;
block|}
DECL|method|updateTexts (UndoChangeEvent event)
specifier|private
name|void
name|updateTexts
parameter_list|(
name|UndoChangeEvent
name|event
parameter_list|)
block|{
comment|/* TODO             SwingUtilities.invokeLater(() -> {                 undo.putValue(Action.SHORT_DESCRIPTION, event.getUndoDescription());                 undo.setEnabled(event.isCanUndo());                 redo.putValue(Action.SHORT_DESCRIPTION, event.getRedoDescription());                 redo.setEnabled(event.isCanRedo());             });             */
block|}
block|}
block|}
end_class

end_unit

