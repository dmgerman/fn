begin_unit|revision:0.9.5;language:Java;cregit-version:0.0.1
begin_package
DECL|package|org.jabref.gui.maintable
package|package
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|maintable
package|;
end_package

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Collections
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|List
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|control
operator|.
name|ContextMenu
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|control
operator|.
name|Menu
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|control
operator|.
name|SeparatorMenuItem
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|Globals
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|BasePanel
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|DialogService
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|actions
operator|.
name|ActionFactory
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|actions
operator|.
name|Actions
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|actions
operator|.
name|OldCommandWrapper
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|actions
operator|.
name|StandardActions
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|exporter
operator|.
name|ExportToClipboardAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|filelist
operator|.
name|AttachFileAction
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|keyboard
operator|.
name|KeyBindingRepository
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|menus
operator|.
name|ChangeEntryTypeMenu
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|mergeentries
operator|.
name|FetchAndMergeEntry
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|specialfields
operator|.
name|SpecialFieldMenuItemFactory
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|logic
operator|.
name|citationstyle
operator|.
name|CitationStyle
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|model
operator|.
name|database
operator|.
name|BibDatabaseContext
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|model
operator|.
name|entry
operator|.
name|BibEntry
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|model
operator|.
name|entry
operator|.
name|FieldName
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|model
operator|.
name|entry
operator|.
name|specialfields
operator|.
name|SpecialField
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|preferences
operator|.
name|JabRefPreferences
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|preferences
operator|.
name|PreviewPreferences
import|;
end_import

begin_class
DECL|class|RightClickMenu
specifier|public
class|class
name|RightClickMenu
block|{
DECL|method|create (BibEntryTableViewModel entry, KeyBindingRepository keyBindingRepository, BasePanel panel, KeyBindingRepository keyBindings, DialogService dialogService)
specifier|public
specifier|static
name|ContextMenu
name|create
parameter_list|(
name|BibEntryTableViewModel
name|entry
parameter_list|,
name|KeyBindingRepository
name|keyBindingRepository
parameter_list|,
name|BasePanel
name|panel
parameter_list|,
name|KeyBindingRepository
name|keyBindings
parameter_list|,
name|DialogService
name|dialogService
parameter_list|)
block|{
name|ContextMenu
name|contextMenu
init|=
operator|new
name|ContextMenu
argument_list|()
decl_stmt|;
name|ActionFactory
name|factory
init|=
operator|new
name|ActionFactory
argument_list|(
name|keyBindingRepository
argument_list|)
decl_stmt|;
name|contextMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|COPY
argument_list|,
operator|new
name|OldCommandWrapper
argument_list|(
name|Actions
operator|.
name|COPY
argument_list|,
name|panel
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|contextMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|createCopySubMenu
argument_list|(
name|panel
argument_list|,
name|factory
argument_list|,
name|dialogService
argument_list|)
argument_list|)
expr_stmt|;
name|contextMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|PASTE
argument_list|,
operator|new
name|OldCommandWrapper
argument_list|(
name|Actions
operator|.
name|PASTE
argument_list|,
name|panel
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|contextMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|CUT
argument_list|,
operator|new
name|OldCommandWrapper
argument_list|(
name|Actions
operator|.
name|CUT
argument_list|,
name|panel
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|contextMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|DELETE
argument_list|,
operator|new
name|OldCommandWrapper
argument_list|(
name|Actions
operator|.
name|DELETE
argument_list|,
name|panel
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|contextMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
operator|new
name|SeparatorMenuItem
argument_list|()
argument_list|)
expr_stmt|;
name|contextMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|SEND_AS_EMAIL
argument_list|,
operator|new
name|OldCommandWrapper
argument_list|(
name|Actions
operator|.
name|SEND_AS_EMAIL
argument_list|,
name|panel
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|contextMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
operator|new
name|SeparatorMenuItem
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|SPECIALFIELDSENABLED
argument_list|)
condition|)
block|{
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|SHOWCOLUMN_RANKING
argument_list|)
condition|)
block|{
name|contextMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|SpecialFieldMenuItemFactory
operator|.
name|createSpecialFieldMenu
argument_list|(
name|SpecialField
operator|.
name|RANKING
argument_list|,
name|factory
argument_list|,
name|panel
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|SHOWCOLUMN_RELEVANCE
argument_list|)
condition|)
block|{
name|contextMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|SpecialFieldMenuItemFactory
operator|.
name|getSpecialFieldSingleItem
argument_list|(
name|SpecialField
operator|.
name|RELEVANCE
argument_list|,
name|factory
argument_list|,
name|panel
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|SHOWCOLUMN_QUALITY
argument_list|)
condition|)
block|{
name|contextMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|SpecialFieldMenuItemFactory
operator|.
name|getSpecialFieldSingleItem
argument_list|(
name|SpecialField
operator|.
name|QUALITY
argument_list|,
name|factory
argument_list|,
name|panel
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|SHOWCOLUMN_PRINTED
argument_list|)
condition|)
block|{
name|contextMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|SpecialFieldMenuItemFactory
operator|.
name|getSpecialFieldSingleItem
argument_list|(
name|SpecialField
operator|.
name|PRINTED
argument_list|,
name|factory
argument_list|,
name|panel
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|SHOWCOLUMN_PRIORITY
argument_list|)
condition|)
block|{
name|contextMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|SpecialFieldMenuItemFactory
operator|.
name|createSpecialFieldMenu
argument_list|(
name|SpecialField
operator|.
name|PRIORITY
argument_list|,
name|factory
argument_list|,
name|panel
argument_list|)
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|Globals
operator|.
name|prefs
operator|.
name|getBoolean
argument_list|(
name|JabRefPreferences
operator|.
name|SHOWCOLUMN_READ
argument_list|)
condition|)
block|{
name|contextMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|SpecialFieldMenuItemFactory
operator|.
name|createSpecialFieldMenu
argument_list|(
name|SpecialField
operator|.
name|READ_STATUS
argument_list|,
name|factory
argument_list|,
name|panel
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
name|contextMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
operator|new
name|SeparatorMenuItem
argument_list|()
argument_list|)
expr_stmt|;
name|contextMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|OPEN_FOLDER
argument_list|,
name|getOpenFolderCommand
argument_list|(
name|panel
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|contextMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|OPEN_EXTERNAL_FILE
argument_list|,
name|getOpenExternalFileCommand
argument_list|(
name|panel
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|contextMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|OPEN_URL
argument_list|,
name|getOpenUrlCommand
argument_list|(
name|panel
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|contextMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
operator|new
name|SeparatorMenuItem
argument_list|()
argument_list|)
expr_stmt|;
name|contextMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
operator|new
name|ChangeEntryTypeMenu
argument_list|(
name|keyBindings
argument_list|)
operator|.
name|getChangeEntryTypeMenu
argument_list|(
name|entry
operator|.
name|getEntry
argument_list|()
argument_list|,
name|panel
operator|.
name|getBibDatabaseContext
argument_list|()
argument_list|,
name|panel
operator|.
name|getUndoManager
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
name|contextMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|MERGE_WITH_FETCHED_ENTRY
argument_list|,
name|getFetchEntryData
argument_list|(
name|panel
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|contextMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|ATTACH_FILE
argument_list|,
operator|new
name|AttachFileAction
argument_list|(
name|panel
argument_list|,
name|dialogService
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|contextMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|MERGE_ENTRIES
argument_list|,
name|mergeEntries
argument_list|(
name|panel
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|contextMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
operator|new
name|SeparatorMenuItem
argument_list|()
argument_list|)
expr_stmt|;
name|contextMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|ADD_TO_GROUP
argument_list|,
name|addToGroup
argument_list|(
name|panel
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|contextMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|REMOVE_FROM_GROUP
argument_list|,
name|removeFromGroup
argument_list|(
name|panel
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|contextMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|MOVE_TO_GROUP
argument_list|,
name|moveToGroup
argument_list|(
name|panel
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|contextMenu
return|;
block|}
DECL|method|moveToGroup (BasePanel panel)
specifier|private
specifier|static
name|OldCommandWrapper
name|moveToGroup
parameter_list|(
name|BasePanel
name|panel
parameter_list|)
block|{
name|OldCommandWrapper
name|command
init|=
operator|new
name|OldCommandWrapper
argument_list|(
name|Actions
operator|.
name|MOVE_TO_GROUP
argument_list|,
name|panel
argument_list|)
decl_stmt|;
name|command
operator|.
name|setExecutable
argument_list|(
name|areGroupsPresent
argument_list|(
name|panel
operator|.
name|getBibDatabaseContext
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|command
return|;
block|}
DECL|method|removeFromGroup (BasePanel panel)
specifier|private
specifier|static
name|OldCommandWrapper
name|removeFromGroup
parameter_list|(
name|BasePanel
name|panel
parameter_list|)
block|{
name|OldCommandWrapper
name|command
init|=
operator|new
name|OldCommandWrapper
argument_list|(
name|Actions
operator|.
name|REMOVE_FROM_GROUP
argument_list|,
name|panel
argument_list|)
decl_stmt|;
name|command
operator|.
name|setExecutable
argument_list|(
name|areGroupsPresent
argument_list|(
name|panel
operator|.
name|getBibDatabaseContext
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|command
return|;
block|}
DECL|method|addToGroup (BasePanel panel)
specifier|private
specifier|static
name|OldCommandWrapper
name|addToGroup
parameter_list|(
name|BasePanel
name|panel
parameter_list|)
block|{
name|OldCommandWrapper
name|command
init|=
operator|new
name|OldCommandWrapper
argument_list|(
name|Actions
operator|.
name|ADD_TO_GROUP
argument_list|,
name|panel
argument_list|)
decl_stmt|;
name|command
operator|.
name|setExecutable
argument_list|(
name|areGroupsPresent
argument_list|(
name|panel
operator|.
name|getBibDatabaseContext
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|command
return|;
block|}
DECL|method|mergeEntries (BasePanel panel)
specifier|private
specifier|static
name|OldCommandWrapper
name|mergeEntries
parameter_list|(
name|BasePanel
name|panel
parameter_list|)
block|{
name|OldCommandWrapper
name|command
init|=
operator|new
name|OldCommandWrapper
argument_list|(
name|Actions
operator|.
name|MERGE_ENTRIES
argument_list|,
name|panel
argument_list|)
decl_stmt|;
name|command
operator|.
name|setExecutable
argument_list|(
name|panel
operator|.
name|getMainTable
argument_list|()
operator|.
name|getSelectedEntries
argument_list|()
operator|.
name|size
argument_list|()
operator|==
literal|2
argument_list|)
expr_stmt|;
return|return
name|command
return|;
block|}
DECL|method|getFetchEntryData (BasePanel panel)
specifier|private
specifier|static
name|OldCommandWrapper
name|getFetchEntryData
parameter_list|(
name|BasePanel
name|panel
parameter_list|)
block|{
name|OldCommandWrapper
name|command
init|=
operator|new
name|OldCommandWrapper
argument_list|(
name|Actions
operator|.
name|MERGE_WITH_FETCHED_ENTRY
argument_list|,
name|panel
argument_list|)
decl_stmt|;
name|command
operator|.
name|setExecutable
argument_list|(
name|isAnyFieldSetForSelectedEntry
argument_list|(
name|FetchAndMergeEntry
operator|.
name|SUPPORTED_FIELDS
argument_list|,
name|panel
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|command
return|;
block|}
DECL|method|getOpenUrlCommand (BasePanel panel)
specifier|private
specifier|static
name|OldCommandWrapper
name|getOpenUrlCommand
parameter_list|(
name|BasePanel
name|panel
parameter_list|)
block|{
name|OldCommandWrapper
name|command
init|=
operator|new
name|OldCommandWrapper
argument_list|(
name|Actions
operator|.
name|OPEN_URL
argument_list|,
name|panel
argument_list|)
decl_stmt|;
name|command
operator|.
name|setExecutable
argument_list|(
name|isFieldSetForSelectedEntry
argument_list|(
name|FieldName
operator|.
name|URL
argument_list|,
name|panel
argument_list|)
operator|||
name|isFieldSetForSelectedEntry
argument_list|(
name|FieldName
operator|.
name|DOI
argument_list|,
name|panel
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|command
return|;
block|}
DECL|method|getOpenExternalFileCommand (BasePanel panel)
specifier|private
specifier|static
name|OldCommandWrapper
name|getOpenExternalFileCommand
parameter_list|(
name|BasePanel
name|panel
parameter_list|)
block|{
name|OldCommandWrapper
name|command
init|=
operator|new
name|OldCommandWrapper
argument_list|(
name|Actions
operator|.
name|OPEN_EXTERNAL_FILE
argument_list|,
name|panel
argument_list|)
decl_stmt|;
name|command
operator|.
name|setExecutable
argument_list|(
name|isFieldSetForSelectedEntry
argument_list|(
name|FieldName
operator|.
name|FILE
argument_list|,
name|panel
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|command
return|;
block|}
DECL|method|getOpenFolderCommand (BasePanel panel)
specifier|private
specifier|static
name|OldCommandWrapper
name|getOpenFolderCommand
parameter_list|(
name|BasePanel
name|panel
parameter_list|)
block|{
name|OldCommandWrapper
name|command
init|=
operator|new
name|OldCommandWrapper
argument_list|(
name|Actions
operator|.
name|OPEN_FOLDER
argument_list|,
name|panel
argument_list|)
decl_stmt|;
name|command
operator|.
name|setExecutable
argument_list|(
name|isFieldSetForSelectedEntry
argument_list|(
name|FieldName
operator|.
name|FILE
argument_list|,
name|panel
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|command
return|;
block|}
DECL|method|createCopySubMenu (BasePanel panel, ActionFactory factory, DialogService dialogService)
specifier|private
specifier|static
name|Menu
name|createCopySubMenu
parameter_list|(
name|BasePanel
name|panel
parameter_list|,
name|ActionFactory
name|factory
parameter_list|,
name|DialogService
name|dialogService
parameter_list|)
block|{
name|Menu
name|copySpecialMenu
init|=
name|factory
operator|.
name|createMenu
argument_list|(
name|StandardActions
operator|.
name|COPY_MORE
argument_list|)
decl_stmt|;
name|copySpecialMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|COPY_TITLE
argument_list|,
operator|new
name|OldCommandWrapper
argument_list|(
name|Actions
operator|.
name|COPY_TITLE
argument_list|,
name|panel
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|copySpecialMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|COPY_KEY
argument_list|,
operator|new
name|OldCommandWrapper
argument_list|(
name|Actions
operator|.
name|COPY_KEY
argument_list|,
name|panel
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|copySpecialMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|COPY_CITE_KEY
argument_list|,
operator|new
name|OldCommandWrapper
argument_list|(
name|Actions
operator|.
name|COPY_CITE_KEY
argument_list|,
name|panel
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|copySpecialMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|COPY_KEY_AND_TITLE
argument_list|,
operator|new
name|OldCommandWrapper
argument_list|(
name|Actions
operator|.
name|COPY_KEY_AND_TITLE
argument_list|,
name|panel
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|copySpecialMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|COPY_KEY_AND_LINK
argument_list|,
operator|new
name|OldCommandWrapper
argument_list|(
name|Actions
operator|.
name|COPY_KEY_AND_LINK
argument_list|,
name|panel
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
comment|// the submenu will behave dependent on what style is currently selected (citation/preview)
name|PreviewPreferences
name|previewPreferences
init|=
name|Globals
operator|.
name|prefs
operator|.
name|getPreviewPreferences
argument_list|()
decl_stmt|;
name|String
name|style
init|=
name|previewPreferences
operator|.
name|getPreviewCycle
argument_list|()
operator|.
name|get
argument_list|(
name|previewPreferences
operator|.
name|getPreviewCyclePosition
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
name|CitationStyle
operator|.
name|isCitationStyleFile
argument_list|(
name|style
argument_list|)
condition|)
block|{
name|copySpecialMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|COPY_CITATION_HTML
argument_list|,
operator|new
name|OldCommandWrapper
argument_list|(
name|Actions
operator|.
name|COPY_CITATION_HTML
argument_list|,
name|panel
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|Menu
name|copyCitationMenu
init|=
name|factory
operator|.
name|createMenu
argument_list|(
name|StandardActions
operator|.
name|COPY_CITATION_MORE
argument_list|)
decl_stmt|;
name|copyCitationMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|COPY_CITATION_TEXT
argument_list|,
operator|new
name|OldCommandWrapper
argument_list|(
name|Actions
operator|.
name|COPY_CITATION_TEXT
argument_list|,
name|panel
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|copyCitationMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|COPY_CITATION_RTF
argument_list|,
operator|new
name|OldCommandWrapper
argument_list|(
name|Actions
operator|.
name|COPY_CITATION_RTF
argument_list|,
name|panel
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|copyCitationMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|COPY_CITATION_ASCII_DOC
argument_list|,
operator|new
name|OldCommandWrapper
argument_list|(
name|Actions
operator|.
name|COPY_CITATION_ASCII_DOC
argument_list|,
name|panel
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|copyCitationMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|COPY_CITATION_XSLFO
argument_list|,
operator|new
name|OldCommandWrapper
argument_list|(
name|Actions
operator|.
name|COPY_CITATION_XSLFO
argument_list|,
name|panel
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|copySpecialMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|copyCitationMenu
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|copySpecialMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|COPY_CITATION_PREVIEW
argument_list|,
operator|new
name|OldCommandWrapper
argument_list|(
name|Actions
operator|.
name|COPY_CITATION_HTML
argument_list|,
name|panel
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
block|}
name|copySpecialMenu
operator|.
name|getItems
argument_list|()
operator|.
name|add
argument_list|(
name|factory
operator|.
name|createMenuItem
argument_list|(
name|StandardActions
operator|.
name|EXPORT_TO_CLIPBOARD
argument_list|,
operator|new
name|ExportToClipboardAction
argument_list|(
name|panel
argument_list|,
name|dialogService
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|copySpecialMenu
return|;
block|}
DECL|method|areGroupsPresent (BibDatabaseContext database)
specifier|private
specifier|static
name|boolean
name|areGroupsPresent
parameter_list|(
name|BibDatabaseContext
name|database
parameter_list|)
block|{
return|return
name|database
operator|.
name|getMetaData
argument_list|()
operator|.
name|getGroups
argument_list|()
operator|.
name|isPresent
argument_list|()
return|;
block|}
DECL|method|isFieldSetForSelectedEntry (String field, BasePanel panel)
specifier|private
specifier|static
name|boolean
name|isFieldSetForSelectedEntry
parameter_list|(
name|String
name|field
parameter_list|,
name|BasePanel
name|panel
parameter_list|)
block|{
return|return
name|isAnyFieldSetForSelectedEntry
argument_list|(
name|Collections
operator|.
name|singletonList
argument_list|(
name|field
argument_list|)
argument_list|,
name|panel
argument_list|)
return|;
block|}
DECL|method|isAnyFieldSetForSelectedEntry (List<String> fields, BasePanel panel)
specifier|private
specifier|static
name|boolean
name|isAnyFieldSetForSelectedEntry
parameter_list|(
name|List
argument_list|<
name|String
argument_list|>
name|fields
parameter_list|,
name|BasePanel
name|panel
parameter_list|)
block|{
if|if
condition|(
name|panel
operator|.
name|getMainTable
argument_list|()
operator|.
name|getSelectedEntries
argument_list|()
operator|.
name|size
argument_list|()
operator|==
literal|1
condition|)
block|{
name|BibEntry
name|entry
init|=
name|panel
operator|.
name|getMainTable
argument_list|()
operator|.
name|getSelectedEntries
argument_list|()
operator|.
name|get
argument_list|(
literal|0
argument_list|)
decl_stmt|;
return|return
operator|!
name|Collections
operator|.
name|disjoint
argument_list|(
name|fields
argument_list|,
name|entry
operator|.
name|getFieldNames
argument_list|()
argument_list|)
return|;
block|}
return|return
literal|false
return|;
block|}
block|}
end_class

end_unit

