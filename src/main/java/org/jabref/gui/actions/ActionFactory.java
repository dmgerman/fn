begin_unit|revision:0.9.5;language:Java;cregit-version:0.0.1
begin_package
DECL|package|org.jabref.gui.actions
package|package
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|actions
package|;
end_package

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Objects
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|Node
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|control
operator|.
name|Button
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|control
operator|.
name|ButtonBase
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|control
operator|.
name|CheckMenuItem
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|control
operator|.
name|Menu
import|;
end_import

begin_import
import|import
name|javafx
operator|.
name|scene
operator|.
name|control
operator|.
name|MenuItem
import|;
end_import

begin_import
import|import
name|org
operator|.
name|jabref
operator|.
name|gui
operator|.
name|keyboard
operator|.
name|KeyBindingRepository
import|;
end_import

begin_import
import|import
name|de
operator|.
name|saxsys
operator|.
name|mvvmfx
operator|.
name|utils
operator|.
name|commands
operator|.
name|Command
import|;
end_import

begin_import
import|import
name|org
operator|.
name|controlsfx
operator|.
name|control
operator|.
name|action
operator|.
name|ActionUtils
import|;
end_import

begin_comment
comment|/**  * Helper class to create and style controls according to an {@link Action}.  */
end_comment

begin_class
DECL|class|ActionFactory
specifier|public
class|class
name|ActionFactory
block|{
DECL|field|keyBindingRepository
specifier|private
specifier|final
name|KeyBindingRepository
name|keyBindingRepository
decl_stmt|;
DECL|method|ActionFactory (KeyBindingRepository keyBindingRepository)
specifier|public
name|ActionFactory
parameter_list|(
name|KeyBindingRepository
name|keyBindingRepository
parameter_list|)
block|{
name|this
operator|.
name|keyBindingRepository
operator|=
name|Objects
operator|.
name|requireNonNull
argument_list|(
name|keyBindingRepository
argument_list|)
expr_stmt|;
block|}
comment|/**      * For some reason the graphic is not set correctly by the {@link ActionUtils} class, so we have to fix this by hand      */
DECL|method|setGraphic (MenuItem node, Action action)
specifier|private
specifier|static
name|void
name|setGraphic
parameter_list|(
name|MenuItem
name|node
parameter_list|,
name|Action
name|action
parameter_list|)
block|{
name|node
operator|.
name|graphicProperty
argument_list|()
operator|.
name|unbind
argument_list|()
expr_stmt|;
name|action
operator|.
name|getIcon
argument_list|()
operator|.
name|ifPresent
argument_list|(
name|icon
lambda|->
name|node
operator|.
name|setGraphic
argument_list|(
name|icon
operator|.
name|getGraphicNode
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
block|}
DECL|method|configureMenuItem (Action action, Command command, MenuItem menuItem)
specifier|public
name|MenuItem
name|configureMenuItem
parameter_list|(
name|Action
name|action
parameter_list|,
name|Command
name|command
parameter_list|,
name|MenuItem
name|menuItem
parameter_list|)
block|{
return|return
name|ActionUtils
operator|.
name|configureMenuItem
argument_list|(
operator|new
name|JabRefAction
argument_list|(
name|action
argument_list|,
name|command
argument_list|,
name|keyBindingRepository
argument_list|)
argument_list|,
name|menuItem
argument_list|)
return|;
block|}
DECL|method|createMenuItem (Action action, Command command)
specifier|public
name|MenuItem
name|createMenuItem
parameter_list|(
name|Action
name|action
parameter_list|,
name|Command
name|command
parameter_list|)
block|{
name|MenuItem
name|menuItem
init|=
name|ActionUtils
operator|.
name|createMenuItem
argument_list|(
operator|new
name|JabRefAction
argument_list|(
name|action
argument_list|,
name|command
argument_list|,
name|keyBindingRepository
argument_list|)
argument_list|)
decl_stmt|;
name|setGraphic
argument_list|(
name|menuItem
argument_list|,
name|action
argument_list|)
expr_stmt|;
return|return
name|menuItem
return|;
block|}
DECL|method|createCheckMenuItem (Action action, Command command, boolean selected)
specifier|public
name|CheckMenuItem
name|createCheckMenuItem
parameter_list|(
name|Action
name|action
parameter_list|,
name|Command
name|command
parameter_list|,
name|boolean
name|selected
parameter_list|)
block|{
name|CheckMenuItem
name|checkMenuItem
init|=
name|ActionUtils
operator|.
name|createCheckMenuItem
argument_list|(
operator|new
name|JabRefAction
argument_list|(
name|action
argument_list|,
name|command
argument_list|,
name|keyBindingRepository
argument_list|)
argument_list|)
decl_stmt|;
name|checkMenuItem
operator|.
name|setSelected
argument_list|(
name|selected
argument_list|)
expr_stmt|;
name|setGraphic
argument_list|(
name|checkMenuItem
argument_list|,
name|action
argument_list|)
expr_stmt|;
return|return
name|checkMenuItem
return|;
block|}
DECL|method|createMenu (Action action)
specifier|public
name|Menu
name|createMenu
parameter_list|(
name|Action
name|action
parameter_list|)
block|{
name|Menu
name|menu
init|=
name|ActionUtils
operator|.
name|createMenu
argument_list|(
operator|new
name|JabRefAction
argument_list|(
name|action
argument_list|,
name|keyBindingRepository
argument_list|)
argument_list|)
decl_stmt|;
comment|// For some reason the graphic is not set correctly, so let's fix this
name|setGraphic
argument_list|(
name|menu
argument_list|,
name|action
argument_list|)
expr_stmt|;
return|return
name|menu
return|;
block|}
DECL|method|createSubMenu (Action action, MenuItem... children)
specifier|public
name|Menu
name|createSubMenu
parameter_list|(
name|Action
name|action
parameter_list|,
name|MenuItem
modifier|...
name|children
parameter_list|)
block|{
name|Menu
name|menu
init|=
name|createMenu
argument_list|(
name|action
argument_list|)
decl_stmt|;
name|menu
operator|.
name|getItems
argument_list|()
operator|.
name|addAll
argument_list|(
name|children
argument_list|)
expr_stmt|;
return|return
name|menu
return|;
block|}
DECL|method|createIconButton (Action action, Command command)
specifier|public
name|Button
name|createIconButton
parameter_list|(
name|Action
name|action
parameter_list|,
name|Command
name|command
parameter_list|)
block|{
name|Button
name|button
init|=
name|ActionUtils
operator|.
name|createButton
argument_list|(
operator|new
name|JabRefAction
argument_list|(
name|action
argument_list|,
name|command
argument_list|,
name|keyBindingRepository
argument_list|)
argument_list|,
name|ActionUtils
operator|.
name|ActionTextBehavior
operator|.
name|HIDE
argument_list|)
decl_stmt|;
name|button
operator|.
name|getStyleClass
argument_list|()
operator|.
name|setAll
argument_list|(
literal|"icon-button"
argument_list|)
expr_stmt|;
comment|// For some reason the graphic is not set correctly, so let's fix this
name|button
operator|.
name|graphicProperty
argument_list|()
operator|.
name|unbind
argument_list|()
expr_stmt|;
name|action
operator|.
name|getIcon
argument_list|()
operator|.
name|ifPresent
argument_list|(
name|icon
lambda|->
name|button
operator|.
name|setGraphic
argument_list|(
name|icon
operator|.
name|getGraphicNode
argument_list|()
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|button
return|;
block|}
DECL|method|configureIconButton (Action action, Command command, ButtonBase button)
specifier|public
name|ButtonBase
name|configureIconButton
parameter_list|(
name|Action
name|action
parameter_list|,
name|Command
name|command
parameter_list|,
name|ButtonBase
name|button
parameter_list|)
block|{
name|ActionUtils
operator|.
name|configureButton
argument_list|(
operator|new
name|JabRefAction
argument_list|(
name|action
argument_list|,
name|command
argument_list|,
name|keyBindingRepository
argument_list|)
argument_list|,
name|button
argument_list|,
name|ActionUtils
operator|.
name|ActionTextBehavior
operator|.
name|HIDE
argument_list|)
expr_stmt|;
name|button
operator|.
name|getStyleClass
argument_list|()
operator|.
name|add
argument_list|(
literal|"icon-button"
argument_list|)
expr_stmt|;
comment|// For some reason the graphic is not set correctly, so let's fix this
name|button
operator|.
name|graphicProperty
argument_list|()
operator|.
name|unbind
argument_list|()
expr_stmt|;
name|action
operator|.
name|getIcon
argument_list|()
operator|.
name|ifPresent
argument_list|(
name|icon
lambda|->
block|{
comment|// ToDO: Find a way to reuse JabRefIconView
name|Node
name|graphicNode
init|=
name|icon
operator|.
name|getGraphicNode
argument_list|()
decl_stmt|;
name|graphicNode
operator|.
name|setStyle
argument_list|(
name|String
operator|.
name|format
argument_list|(
literal|"-fx-font-family: %s; -fx-font-size: %s;"
argument_list|,
name|icon
operator|.
name|fontFamily
argument_list|()
argument_list|,
literal|"1em"
argument_list|)
argument_list|)
expr_stmt|;
name|button
operator|.
name|setGraphic
argument_list|(
name|graphicNode
argument_list|)
expr_stmt|;
block|}
argument_list|)
expr_stmt|;
return|return
name|button
return|;
block|}
block|}
end_class

end_unit

