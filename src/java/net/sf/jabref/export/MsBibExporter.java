begin_unit|revision:0.9.5;language:Java;cregit-version:0.0.1
begin_package
DECL|package|net.sf.jabref.export
package|package
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|export
package|;
end_package

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|Globals
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|BibtexDatabase
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|BibtexEntry
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Set
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Iterator
import|;
end_import

begin_comment
comment|/**  * Exporter for the MS Office 2007 XML bibliography format  * By S. M. Mahbub Murshed  */
end_comment

begin_class
DECL|class|MsBibExporter
specifier|public
class|class
name|MsBibExporter
extends|extends
name|ExportFormat
block|{
DECL|method|MsBibExporter ()
specifier|public
name|MsBibExporter
parameter_list|()
block|{
comment|// We call the superclass contructor to define the format name and the
comment|// default file extension (is it .xml?):
name|super
argument_list|(
name|Globals
operator|.
name|lang
argument_list|(
literal|"MSBib"
argument_list|)
argument_list|,
literal|"msbib"
argument_list|,
literal|null
argument_list|,
literal|null
argument_list|,
literal|".xml"
argument_list|)
expr_stmt|;
block|}
DECL|method|performExport (final BibtexDatabase database, final String file, final String encoding, Set entries)
specifier|public
name|void
name|performExport
parameter_list|(
specifier|final
name|BibtexDatabase
name|database
parameter_list|,
specifier|final
name|String
name|file
parameter_list|,
specifier|final
name|String
name|encoding
parameter_list|,
name|Set
name|entries
parameter_list|)
throws|throws
name|Exception
block|{
comment|/*              We need to override the performExport method, which is where the entries are             exported to the file.              database is the database to export.             file is the name of the file to export to.             encoding is the character encoding to use. If the MSBib format specifies a given             encoding, I think the best choice is to ignore this argument.             entries is the set of bibtex entry IDs to export. I have added some example code below                 to show how to get the entries.          */
name|System
operator|.
name|out
operator|.
name|println
argument_list|(
literal|"Hello world MsBibExporter"
argument_list|)
expr_stmt|;
comment|//If entries==null, the entire database should be exported:
if|if
condition|(
name|entries
operator|==
literal|null
condition|)
name|entries
operator|=
name|database
operator|.
name|getKeySet
argument_list|()
expr_stmt|;
comment|// Accessing the entries:
for|for
control|(
name|Iterator
name|iterator
init|=
name|entries
operator|.
name|iterator
argument_list|()
init|;
name|iterator
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|String
name|id
init|=
operator|(
name|String
operator|)
name|iterator
operator|.
name|next
argument_list|()
decl_stmt|;
name|BibtexEntry
name|entry
init|=
operator|(
name|BibtexEntry
operator|)
name|database
operator|.
name|getEntryById
argument_list|(
name|id
argument_list|)
decl_stmt|;
comment|// Do whatever with the entry here
block|}
block|}
block|}
end_class

end_unit

