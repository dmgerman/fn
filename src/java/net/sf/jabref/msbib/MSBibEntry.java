begin_unit|revision:0.9.5;language:Java;cregit-version:0.0.1
begin_comment
comment|/*  Copyright (C) 2003-2011 JabRef contributors.     This program is free software; you can redistribute it and/or modify     it under the terms of the GNU General Public License as published by     the Free Software Foundation; either version 2 of the License, or     (at your option) any later version.      This program is distributed in the hope that it will be useful,     but WITHOUT ANY WARRANTY; without even the implied warranty of     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the     GNU General Public License for more details.      You should have received a copy of the GNU General Public License along     with this program; if not, write to the Free Software Foundation, Inc.,     51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA. */
end_comment

begin_package
DECL|package|net.sf.jabref.msbib
package|package
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|msbib
package|;
end_package

begin_import
import|import
name|java
operator|.
name|io
operator|.
name|StringWriter
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|HashMap
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Iterator
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|LinkedList
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|List
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|regex
operator|.
name|Matcher
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|regex
operator|.
name|Pattern
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|xml
operator|.
name|parsers
operator|.
name|DocumentBuilder
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|xml
operator|.
name|parsers
operator|.
name|DocumentBuilderFactory
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|xml
operator|.
name|transform
operator|.
name|OutputKeys
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|xml
operator|.
name|transform
operator|.
name|Transformer
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|xml
operator|.
name|transform
operator|.
name|TransformerFactory
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|xml
operator|.
name|transform
operator|.
name|dom
operator|.
name|DOMSource
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|xml
operator|.
name|transform
operator|.
name|stream
operator|.
name|StreamResult
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|BibtexEntry
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|BibtexEntryType
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|BibtexFields
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|export
operator|.
name|layout
operator|.
name|LayoutFormatter
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|export
operator|.
name|layout
operator|.
name|format
operator|.
name|XMLChars
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|mods
operator|.
name|PageNumbers
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|mods
operator|.
name|PersonName
import|;
end_import

begin_import
import|import
name|org
operator|.
name|w3c
operator|.
name|dom
operator|.
name|Document
import|;
end_import

begin_import
import|import
name|org
operator|.
name|w3c
operator|.
name|dom
operator|.
name|Element
import|;
end_import

begin_import
import|import
name|org
operator|.
name|w3c
operator|.
name|dom
operator|.
name|Node
import|;
end_import

begin_import
import|import
name|org
operator|.
name|w3c
operator|.
name|dom
operator|.
name|NodeList
import|;
end_import

begin_comment
comment|/**  * @author S M Mahbub Murshed  * @email udvranto@yahoo.com  *  * @version 2.0.0  * @see http://mahbub.wordpress.com/2007/03/24/details-of-microsoft-office-2007-bibliographic-format-compared-to-bibtex/  * @see http://mahbub.wordpress.com/2007/03/22/deciphering-microsoft-office-2007-bibliography-format/  *   * Date: May 15, 2007; May 03, 2007  *   * History  * May 03, 2007 - Added export functionality  * May 15, 2007 - Added import functionality  * May 16, 2007 - Changed all interger entries to strings,  * 				  except LCID which must be an integer.  * 				  To avoid exception during integer parsing  *				  the exception is caught and LCID is set to zero.  * Jan 06, 2012 - Changed the XML element ConferenceName to present  * 				  the Booktitle instead of the organization field content  */
end_comment

begin_class
DECL|class|MSBibEntry
specifier|public
class|class
name|MSBibEntry
block|{
DECL|field|sourceType
specifier|protected
name|String
name|sourceType
init|=
literal|"Misc"
decl_stmt|;
DECL|field|bibTexEntry
specifier|protected
name|String
name|bibTexEntry
init|=
literal|null
decl_stmt|;
DECL|field|tag
specifier|protected
name|String
name|tag
init|=
literal|null
decl_stmt|;
DECL|field|GUID
specifier|protected
name|String
name|GUID
init|=
literal|null
decl_stmt|;
DECL|field|LCID
specifier|protected
name|int
name|LCID
init|=
operator|-
literal|1
decl_stmt|;
DECL|field|authors
specifier|protected
name|List
argument_list|<
name|PersonName
argument_list|>
name|authors
init|=
literal|null
decl_stmt|;
DECL|field|bookAuthors
specifier|protected
name|List
argument_list|<
name|PersonName
argument_list|>
name|bookAuthors
init|=
literal|null
decl_stmt|;
DECL|field|editors
specifier|protected
name|List
argument_list|<
name|PersonName
argument_list|>
name|editors
init|=
literal|null
decl_stmt|;
DECL|field|translators
specifier|protected
name|List
argument_list|<
name|PersonName
argument_list|>
name|translators
init|=
literal|null
decl_stmt|;
DECL|field|producerNames
specifier|protected
name|List
argument_list|<
name|PersonName
argument_list|>
name|producerNames
init|=
literal|null
decl_stmt|;
DECL|field|composers
specifier|protected
name|List
argument_list|<
name|PersonName
argument_list|>
name|composers
init|=
literal|null
decl_stmt|;
DECL|field|conductors
specifier|protected
name|List
argument_list|<
name|PersonName
argument_list|>
name|conductors
init|=
literal|null
decl_stmt|;
DECL|field|performers
specifier|protected
name|List
argument_list|<
name|PersonName
argument_list|>
name|performers
init|=
literal|null
decl_stmt|;
DECL|field|writers
specifier|protected
name|List
argument_list|<
name|PersonName
argument_list|>
name|writers
init|=
literal|null
decl_stmt|;
DECL|field|directors
specifier|protected
name|List
argument_list|<
name|PersonName
argument_list|>
name|directors
init|=
literal|null
decl_stmt|;
DECL|field|compilers
specifier|protected
name|List
argument_list|<
name|PersonName
argument_list|>
name|compilers
init|=
literal|null
decl_stmt|;
DECL|field|interviewers
specifier|protected
name|List
argument_list|<
name|PersonName
argument_list|>
name|interviewers
init|=
literal|null
decl_stmt|;
DECL|field|interviewees
specifier|protected
name|List
argument_list|<
name|PersonName
argument_list|>
name|interviewees
init|=
literal|null
decl_stmt|;
DECL|field|inventors
specifier|protected
name|List
argument_list|<
name|PersonName
argument_list|>
name|inventors
init|=
literal|null
decl_stmt|;
DECL|field|counsels
specifier|protected
name|List
argument_list|<
name|PersonName
argument_list|>
name|counsels
init|=
literal|null
decl_stmt|;
DECL|field|title
specifier|protected
name|String
name|title
init|=
literal|null
decl_stmt|;
DECL|field|year
specifier|protected
name|String
name|year
init|=
literal|null
decl_stmt|;
DECL|field|month
specifier|protected
name|String
name|month
init|=
literal|null
decl_stmt|;
DECL|field|day
specifier|protected
name|String
name|day
init|=
literal|null
decl_stmt|;
DECL|field|shortTitle
specifier|protected
name|String
name|shortTitle
init|=
literal|null
decl_stmt|;
DECL|field|comments
specifier|protected
name|String
name|comments
init|=
literal|null
decl_stmt|;
DECL|field|pages
specifier|protected
name|PageNumbers
name|pages
init|=
literal|null
decl_stmt|;
DECL|field|volume
specifier|protected
name|String
name|volume
init|=
literal|null
decl_stmt|;
DECL|field|numberOfVolumes
specifier|protected
name|String
name|numberOfVolumes
init|=
literal|null
decl_stmt|;
DECL|field|edition
specifier|protected
name|String
name|edition
init|=
literal|null
decl_stmt|;
DECL|field|standardNumber
specifier|protected
name|String
name|standardNumber
init|=
literal|null
decl_stmt|;
DECL|field|publisher
specifier|protected
name|String
name|publisher
init|=
literal|null
decl_stmt|;
DECL|field|address
specifier|protected
name|String
name|address
init|=
literal|null
decl_stmt|;
DECL|field|bookTitle
specifier|protected
name|String
name|bookTitle
init|=
literal|null
decl_stmt|;
DECL|field|chapterNumber
specifier|protected
name|String
name|chapterNumber
init|=
literal|null
decl_stmt|;
DECL|field|journalName
specifier|protected
name|String
name|journalName
init|=
literal|null
decl_stmt|;
DECL|field|issue
specifier|protected
name|String
name|issue
init|=
literal|null
decl_stmt|;
DECL|field|periodicalTitle
specifier|protected
name|String
name|periodicalTitle
init|=
literal|null
decl_stmt|;
DECL|field|conferenceName
specifier|protected
name|String
name|conferenceName
init|=
literal|null
decl_stmt|;
DECL|field|department
specifier|protected
name|String
name|department
init|=
literal|null
decl_stmt|;
DECL|field|institution
specifier|protected
name|String
name|institution
init|=
literal|null
decl_stmt|;
DECL|field|thesisType
specifier|protected
name|String
name|thesisType
init|=
literal|null
decl_stmt|;
DECL|field|internetSiteTitle
specifier|protected
name|String
name|internetSiteTitle
init|=
literal|null
decl_stmt|;
DECL|field|dateAccessed
specifier|protected
name|String
name|dateAccessed
init|=
literal|null
decl_stmt|;
DECL|field|url
specifier|protected
name|String
name|url
init|=
literal|null
decl_stmt|;
DECL|field|productionCompany
specifier|protected
name|String
name|productionCompany
init|=
literal|null
decl_stmt|;
DECL|field|publicationTitle
specifier|protected
name|String
name|publicationTitle
init|=
literal|null
decl_stmt|;
DECL|field|medium
specifier|protected
name|String
name|medium
init|=
literal|null
decl_stmt|;
DECL|field|albumTitle
specifier|protected
name|String
name|albumTitle
init|=
literal|null
decl_stmt|;
DECL|field|recordingNumber
specifier|protected
name|String
name|recordingNumber
init|=
literal|null
decl_stmt|;
DECL|field|theater
specifier|protected
name|String
name|theater
init|=
literal|null
decl_stmt|;
DECL|field|distributor
specifier|protected
name|String
name|distributor
init|=
literal|null
decl_stmt|;
DECL|field|broadcastTitle
specifier|protected
name|String
name|broadcastTitle
init|=
literal|null
decl_stmt|;
DECL|field|broadcaster
specifier|protected
name|String
name|broadcaster
init|=
literal|null
decl_stmt|;
DECL|field|station
specifier|protected
name|String
name|station
init|=
literal|null
decl_stmt|;
DECL|field|type
specifier|protected
name|String
name|type
init|=
literal|null
decl_stmt|;
DECL|field|patentNumber
specifier|protected
name|String
name|patentNumber
init|=
literal|null
decl_stmt|;
DECL|field|court
specifier|protected
name|String
name|court
init|=
literal|null
decl_stmt|;
DECL|field|reporter
specifier|protected
name|String
name|reporter
init|=
literal|null
decl_stmt|;
DECL|field|caseNumber
specifier|protected
name|String
name|caseNumber
init|=
literal|null
decl_stmt|;
DECL|field|abbreviatedCaseNumber
specifier|protected
name|String
name|abbreviatedCaseNumber
init|=
literal|null
decl_stmt|;
DECL|field|bibTex_Series
specifier|protected
name|String
name|bibTex_Series
init|=
literal|null
decl_stmt|;
DECL|field|bibTex_Abstract
specifier|protected
name|String
name|bibTex_Abstract
init|=
literal|null
decl_stmt|;
DECL|field|bibTex_KeyWords
specifier|protected
name|String
name|bibTex_KeyWords
init|=
literal|null
decl_stmt|;
DECL|field|bibTex_CrossRef
specifier|protected
name|String
name|bibTex_CrossRef
init|=
literal|null
decl_stmt|;
DECL|field|bibTex_HowPublished
specifier|protected
name|String
name|bibTex_HowPublished
init|=
literal|null
decl_stmt|;
DECL|field|bibTex_Affiliation
specifier|protected
name|String
name|bibTex_Affiliation
init|=
literal|null
decl_stmt|;
DECL|field|bibTex_Contents
specifier|protected
name|String
name|bibTex_Contents
init|=
literal|null
decl_stmt|;
DECL|field|bibTex_Copyright
specifier|protected
name|String
name|bibTex_Copyright
init|=
literal|null
decl_stmt|;
DECL|field|bibTex_Price
specifier|protected
name|String
name|bibTex_Price
init|=
literal|null
decl_stmt|;
DECL|field|bibTex_Size
specifier|protected
name|String
name|bibTex_Size
init|=
literal|null
decl_stmt|;
comment|/* SM 2010.10 intype, paper support */
DECL|field|bibTex_InType
specifier|protected
name|String
name|bibTex_InType
init|=
literal|null
decl_stmt|;
DECL|field|bibTex_Paper
specifier|protected
name|String
name|bibTex_Paper
init|=
literal|null
decl_stmt|;
DECL|field|BIBTEX
specifier|private
specifier|final
name|String
name|BIBTEX
init|=
literal|"BIBTEX_"
decl_stmt|;
DECL|field|MSBIB
specifier|private
specifier|final
name|String
name|MSBIB
init|=
literal|"msbib-"
decl_stmt|;
DECL|field|bcol
specifier|private
specifier|final
name|String
name|bcol
init|=
literal|"b:"
decl_stmt|;
DECL|field|FORMATXML
specifier|private
specifier|final
name|boolean
name|FORMATXML
init|=
literal|false
decl_stmt|;
DECL|method|MSBibEntry ()
specifier|public
name|MSBibEntry
parameter_list|()
block|{ 	}
DECL|method|MSBibEntry (BibtexEntry bibtex)
specifier|public
name|MSBibEntry
parameter_list|(
name|BibtexEntry
name|bibtex
parameter_list|)
block|{
name|this
argument_list|()
expr_stmt|;
name|populateFromBibtex
argument_list|(
name|bibtex
argument_list|)
expr_stmt|;
block|}
DECL|method|MSBibEntry (Element entry, String _bcol)
specifier|public
name|MSBibEntry
parameter_list|(
name|Element
name|entry
parameter_list|,
name|String
name|_bcol
parameter_list|)
block|{
name|this
argument_list|()
expr_stmt|;
name|populateFromXml
argument_list|(
name|entry
argument_list|,
name|_bcol
argument_list|)
expr_stmt|;
block|}
DECL|method|getFromXml (String name, Element entry)
specifier|protected
name|String
name|getFromXml
parameter_list|(
name|String
name|name
parameter_list|,
name|Element
name|entry
parameter_list|)
block|{
name|String
name|value
init|=
literal|null
decl_stmt|;
name|NodeList
name|nodeLst
init|=
name|entry
operator|.
name|getElementsByTagName
argument_list|(
name|name
argument_list|)
decl_stmt|;
if|if
condition|(
name|nodeLst
operator|.
name|getLength
argument_list|()
operator|>
literal|0
condition|)
name|value
operator|=
name|nodeLst
operator|.
name|item
argument_list|(
literal|0
argument_list|)
operator|.
name|getTextContent
argument_list|()
expr_stmt|;
return|return
name|value
return|;
block|}
DECL|method|populateFromXml (Element entry, String _bcol)
specifier|protected
name|void
name|populateFromXml
parameter_list|(
name|Element
name|entry
parameter_list|,
name|String
name|_bcol
parameter_list|)
block|{
name|String
name|temp
init|=
literal|null
decl_stmt|;
name|sourceType
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"SourceType"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|tag
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"Tag"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|temp
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"LCID"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
if|if
condition|(
name|temp
operator|!=
literal|null
condition|)
block|{
try|try
block|{
name|LCID
operator|=
name|Integer
operator|.
name|parseInt
argument_list|(
name|temp
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|Exception
name|e
parameter_list|)
block|{
name|LCID
operator|=
operator|-
literal|1
expr_stmt|;
block|}
block|}
name|title
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"Title"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|year
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"Year"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|month
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"Month"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|day
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"Day"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|shortTitle
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"ShortTitle"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|comments
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"Comments"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|temp
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"Pages"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
if|if
condition|(
name|temp
operator|!=
literal|null
condition|)
name|pages
operator|=
operator|new
name|PageNumbers
argument_list|(
name|temp
argument_list|)
expr_stmt|;
name|volume
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"Volume"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|numberOfVolumes
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"NumberVolumes"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|edition
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"Edition"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|standardNumber
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"StandardNumber"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|publisher
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"Publisher"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|String
name|city
init|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"City"
argument_list|,
name|entry
argument_list|)
decl_stmt|;
name|String
name|state
init|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"StateProvince"
argument_list|,
name|entry
argument_list|)
decl_stmt|;
name|String
name|country
init|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"CountryRegion"
argument_list|,
name|entry
argument_list|)
decl_stmt|;
name|address
operator|=
literal|""
expr_stmt|;
if|if
condition|(
name|city
operator|!=
literal|null
condition|)
name|address
operator|+=
name|city
operator|+
literal|", "
expr_stmt|;
if|if
condition|(
name|state
operator|!=
literal|null
condition|)
name|address
operator|+=
name|state
operator|+
literal|" "
expr_stmt|;
if|if
condition|(
name|country
operator|!=
literal|null
condition|)
name|address
operator|+=
name|country
expr_stmt|;
name|address
operator|=
name|address
operator|.
name|trim
argument_list|()
expr_stmt|;
if|if
condition|(
name|address
operator|.
name|equals
argument_list|(
literal|""
argument_list|)
operator|||
name|address
operator|.
name|equals
argument_list|(
literal|","
argument_list|)
condition|)
name|address
operator|=
literal|null
expr_stmt|;
name|bookTitle
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"BookTitle"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|chapterNumber
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"ChapterNumber"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|journalName
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"JournalName"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|issue
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"Issue"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|periodicalTitle
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"PeriodicalTitle"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|conferenceName
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"ConferenceName"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|department
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"Department"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|institution
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"Institution"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|thesisType
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"ThesisType"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|internetSiteTitle
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"InternetSiteTitle"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|String
name|month
init|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"MonthAccessed"
argument_list|,
name|entry
argument_list|)
decl_stmt|;
name|String
name|day
init|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"DayAccessed"
argument_list|,
name|entry
argument_list|)
decl_stmt|;
name|String
name|year
init|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"YearAccessed"
argument_list|,
name|entry
argument_list|)
decl_stmt|;
name|dateAccessed
operator|=
literal|""
expr_stmt|;
if|if
condition|(
name|month
operator|!=
literal|null
condition|)
name|dateAccessed
operator|+=
name|month
operator|+
literal|" "
expr_stmt|;
if|if
condition|(
name|day
operator|!=
literal|null
condition|)
name|dateAccessed
operator|+=
name|day
operator|+
literal|", "
expr_stmt|;
if|if
condition|(
name|year
operator|!=
literal|null
condition|)
name|dateAccessed
operator|+=
name|year
expr_stmt|;
name|dateAccessed
operator|=
name|dateAccessed
operator|.
name|trim
argument_list|()
expr_stmt|;
if|if
condition|(
name|dateAccessed
operator|.
name|equals
argument_list|(
literal|""
argument_list|)
operator|||
name|dateAccessed
operator|.
name|equals
argument_list|(
literal|","
argument_list|)
condition|)
name|dateAccessed
operator|=
literal|null
expr_stmt|;
name|url
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"URL"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|productionCompany
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"ProductionCompany"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|publicationTitle
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"PublicationTitle"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|medium
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"Medium"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|albumTitle
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"AlbumTitle"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|recordingNumber
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"RecordingNumber"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|theater
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"Theater"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|distributor
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"Distributor"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|broadcastTitle
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"BroadcastTitle"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|broadcaster
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"Broadcaster"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|station
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"Station"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|type
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"Type"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|patentNumber
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"PatentNumber"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|court
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"Court"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|reporter
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"Reporter"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|caseNumber
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"CaseNumber"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|abbreviatedCaseNumber
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
literal|"AbbreviatedCaseNumber"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|bibTex_Series
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
name|BIBTEX
operator|+
literal|"Series"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|bibTex_Abstract
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
name|BIBTEX
operator|+
literal|"Abstract"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|bibTex_KeyWords
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
name|BIBTEX
operator|+
literal|"KeyWords"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|bibTex_CrossRef
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
name|BIBTEX
operator|+
literal|"CrossRef"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|bibTex_HowPublished
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
name|BIBTEX
operator|+
literal|"HowPublished"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|bibTex_Affiliation
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
name|BIBTEX
operator|+
literal|"Affiliation"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|bibTex_Contents
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
name|BIBTEX
operator|+
literal|"Contents"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|bibTex_Copyright
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
name|BIBTEX
operator|+
literal|"Copyright"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|bibTex_Price
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
name|BIBTEX
operator|+
literal|"Price"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|bibTex_Size
operator|=
name|getFromXml
argument_list|(
name|_bcol
operator|+
name|BIBTEX
operator|+
literal|"Size"
argument_list|,
name|entry
argument_list|)
expr_stmt|;
name|NodeList
name|nodeLst
init|=
name|entry
operator|.
name|getElementsByTagName
argument_list|(
name|_bcol
operator|+
literal|"Author"
argument_list|)
decl_stmt|;
if|if
condition|(
name|nodeLst
operator|.
name|getLength
argument_list|()
operator|>
literal|0
condition|)
name|getAuthors
argument_list|(
call|(
name|Element
call|)
argument_list|(
name|nodeLst
operator|.
name|item
argument_list|(
literal|0
argument_list|)
argument_list|)
argument_list|,
name|_bcol
argument_list|)
expr_stmt|;
block|}
DECL|method|populateFromBibtex (BibtexEntry bibtex)
specifier|protected
name|void
name|populateFromBibtex
parameter_list|(
name|BibtexEntry
name|bibtex
parameter_list|)
block|{
comment|// date = getDate(bibtex);
name|sourceType
operator|=
name|getMSBibSourceType
argument_list|(
name|bibtex
argument_list|)
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"bibtexkey"
argument_list|)
operator|!=
literal|null
condition|)
name|tag
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"bibtexkey"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"language"
argument_list|)
operator|!=
literal|null
condition|)
name|LCID
operator|=
name|getLCID
argument_list|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"language"
argument_list|)
operator|.
name|toString
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"title"
argument_list|)
operator|!=
literal|null
condition|)
name|title
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"title"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"year"
argument_list|)
operator|!=
literal|null
condition|)
name|year
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"year"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"month"
argument_list|)
operator|!=
literal|null
condition|)
name|month
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"month"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"day"
argument_list|)
operator|!=
literal|null
condition|)
name|day
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"day"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"shorttitle"
argument_list|)
operator|!=
literal|null
condition|)
name|shortTitle
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"shorttitle"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"note"
argument_list|)
operator|!=
literal|null
condition|)
name|comments
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"note"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"pages"
argument_list|)
operator|!=
literal|null
condition|)
name|pages
operator|=
operator|new
name|PageNumbers
argument_list|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"pages"
argument_list|)
operator|.
name|toString
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"volume"
argument_list|)
operator|!=
literal|null
condition|)
name|volume
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"volume"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"numberofvolume"
argument_list|)
operator|!=
literal|null
condition|)
name|numberOfVolumes
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"numberofvolume"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"edition"
argument_list|)
operator|!=
literal|null
condition|)
name|edition
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"edition"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
name|standardNumber
operator|=
operator|new
name|String
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"isbn"
argument_list|)
operator|!=
literal|null
condition|)
comment|/* SM: 2010.10: lower case */
name|standardNumber
operator|+=
literal|" ISBN: "
operator|+
name|bibtex
operator|.
name|getField
argument_list|(
literal|"isbn"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
comment|/* SM: 2010.10: lower case */
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"issn"
argument_list|)
operator|!=
literal|null
condition|)
comment|/* SM: 2010.10: lower case */
name|standardNumber
operator|+=
literal|" ISSN: "
operator|+
name|bibtex
operator|.
name|getField
argument_list|(
literal|"issn"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
comment|/* SM: 2010.10: lower case */
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"lccn"
argument_list|)
operator|!=
literal|null
condition|)
comment|/* SM: 2010.10: lower case */
name|standardNumber
operator|+=
literal|" LCCN: "
operator|+
name|bibtex
operator|.
name|getField
argument_list|(
literal|"lccn"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
comment|/* SM: 2010.10: lower case */
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"mrnumber"
argument_list|)
operator|!=
literal|null
condition|)
name|standardNumber
operator|+=
literal|" MRN: "
operator|+
name|bibtex
operator|.
name|getField
argument_list|(
literal|"mrnumber"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
comment|/* SM: 2010.10 begin DOI support */
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"doi"
argument_list|)
operator|!=
literal|null
condition|)
name|standardNumber
operator|+=
literal|" DOI: "
operator|+
name|bibtex
operator|.
name|getField
argument_list|(
literal|"doi"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
comment|/* SM: 2010.10 end DOI support */
if|if
condition|(
name|standardNumber
operator|.
name|equals
argument_list|(
literal|""
argument_list|)
condition|)
name|standardNumber
operator|=
literal|null
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"publisher"
argument_list|)
operator|!=
literal|null
condition|)
name|publisher
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"publisher"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"address"
argument_list|)
operator|!=
literal|null
condition|)
name|address
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"address"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"booktitle"
argument_list|)
operator|!=
literal|null
condition|)
name|bookTitle
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"booktitle"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"chapter"
argument_list|)
operator|!=
literal|null
condition|)
name|chapterNumber
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"chapter"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"journal"
argument_list|)
operator|!=
literal|null
condition|)
name|journalName
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"journal"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"number"
argument_list|)
operator|!=
literal|null
condition|)
name|issue
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"number"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"periodical"
argument_list|)
operator|!=
literal|null
condition|)
name|periodicalTitle
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"periodical"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"booktitle"
argument_list|)
operator|!=
literal|null
condition|)
name|conferenceName
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"booktitle"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"school"
argument_list|)
operator|!=
literal|null
condition|)
name|department
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"school"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"institution"
argument_list|)
operator|!=
literal|null
condition|)
name|institution
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"institution"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
comment|/* SM: 2010.10 Modified for default source types */
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"type"
argument_list|)
operator|!=
literal|null
condition|)
name|thesisType
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"type"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
else|else
block|{
if|if
condition|(
name|bibtex
operator|.
name|getType
argument_list|()
operator|.
name|getName
argument_list|()
operator|.
name|equalsIgnoreCase
argument_list|(
literal|"techreport"
argument_list|)
condition|)
name|thesisType
operator|=
literal|"Tech. rep."
expr_stmt|;
elseif|else
if|if
condition|(
name|bibtex
operator|.
name|getType
argument_list|()
operator|.
name|getName
argument_list|()
operator|.
name|equalsIgnoreCase
argument_list|(
literal|"mastersthesis"
argument_list|)
condition|)
name|thesisType
operator|=
literal|"Master's thesis"
expr_stmt|;
elseif|else
if|if
condition|(
name|bibtex
operator|.
name|getType
argument_list|()
operator|.
name|getName
argument_list|()
operator|.
name|equalsIgnoreCase
argument_list|(
literal|"phdthesis"
argument_list|)
condition|)
name|thesisType
operator|=
literal|"Ph.D. dissertation"
expr_stmt|;
elseif|else
if|if
condition|(
name|bibtex
operator|.
name|getType
argument_list|()
operator|.
name|getName
argument_list|()
operator|.
name|equalsIgnoreCase
argument_list|(
literal|"unpublished"
argument_list|)
condition|)
name|thesisType
operator|=
literal|"unpublished"
expr_stmt|;
comment|//else if (bibtex.getType().getName().equalsIgnoreCase("manual"))
comment|//	thesisType = "manual";
block|}
if|if
condition|(
operator|(
name|sourceType
operator|.
name|equals
argument_list|(
literal|"InternetSite"
argument_list|)
operator|||
name|sourceType
operator|.
name|equals
argument_list|(
literal|"DocumentFromInternetSite"
argument_list|)
operator|)
operator|&&
name|bibtex
operator|.
name|getField
argument_list|(
literal|"title"
argument_list|)
operator|!=
literal|null
condition|)
name|internetSiteTitle
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"title"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"accessed"
argument_list|)
operator|!=
literal|null
condition|)
name|dateAccessed
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"accessed"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"url"
argument_list|)
operator|!=
literal|null
condition|)
comment|/* SM: 2010.10: lower case */
name|url
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"url"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
comment|/* SM: 2010.10: lower case */
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"productioncompany"
argument_list|)
operator|!=
literal|null
condition|)
name|productionCompany
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"productioncompany"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
operator|(
name|sourceType
operator|.
name|equals
argument_list|(
literal|"ElectronicSource"
argument_list|)
operator|||
name|sourceType
operator|.
name|equals
argument_list|(
literal|"Art"
argument_list|)
operator|||
name|sourceType
operator|.
name|equals
argument_list|(
literal|"Misc"
argument_list|)
operator|)
operator|&&
name|bibtex
operator|.
name|getField
argument_list|(
literal|"title"
argument_list|)
operator|!=
literal|null
condition|)
name|publicationTitle
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"title"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"medium"
argument_list|)
operator|!=
literal|null
condition|)
name|medium
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"medium"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|sourceType
operator|.
name|equals
argument_list|(
literal|"SoundRecording"
argument_list|)
operator|&&
name|bibtex
operator|.
name|getField
argument_list|(
literal|"title"
argument_list|)
operator|!=
literal|null
condition|)
name|albumTitle
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"title"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"recordingnumber"
argument_list|)
operator|!=
literal|null
condition|)
name|recordingNumber
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"recordingnumber"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"theater"
argument_list|)
operator|!=
literal|null
condition|)
name|theater
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"theater"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"distributor"
argument_list|)
operator|!=
literal|null
condition|)
name|distributor
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"distributor"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|sourceType
operator|.
name|equals
argument_list|(
literal|"Interview"
argument_list|)
operator|&&
name|bibtex
operator|.
name|getField
argument_list|(
literal|"title"
argument_list|)
operator|!=
literal|null
condition|)
name|broadcastTitle
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"title"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"broadcaster"
argument_list|)
operator|!=
literal|null
condition|)
name|broadcaster
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"broadcaster"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"station"
argument_list|)
operator|!=
literal|null
condition|)
name|station
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"station"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"type"
argument_list|)
operator|!=
literal|null
condition|)
name|type
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"type"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"patentnumber"
argument_list|)
operator|!=
literal|null
condition|)
name|patentNumber
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"patentnumber"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"court"
argument_list|)
operator|!=
literal|null
condition|)
name|court
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"court"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"reporter"
argument_list|)
operator|!=
literal|null
condition|)
name|reporter
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"reporter"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"casenumber"
argument_list|)
operator|!=
literal|null
condition|)
name|caseNumber
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"casenumber"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"abbreviatedcasenumber"
argument_list|)
operator|!=
literal|null
condition|)
name|abbreviatedCaseNumber
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
name|MSBIB
operator|+
literal|"abbreviatedcasenumber"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"series"
argument_list|)
operator|!=
literal|null
condition|)
name|bibTex_Series
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"series"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"abstract"
argument_list|)
operator|!=
literal|null
condition|)
name|bibTex_Abstract
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"abstract"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"keywords"
argument_list|)
operator|!=
literal|null
condition|)
name|bibTex_KeyWords
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"keywords"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"crossref"
argument_list|)
operator|!=
literal|null
condition|)
name|bibTex_CrossRef
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"crossref"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"howpublished"
argument_list|)
operator|!=
literal|null
condition|)
name|bibTex_HowPublished
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"howpublished"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"affiliation"
argument_list|)
operator|!=
literal|null
condition|)
name|bibTex_Affiliation
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"affiliation"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"contents"
argument_list|)
operator|!=
literal|null
condition|)
name|bibTex_Contents
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"contents"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"copyright"
argument_list|)
operator|!=
literal|null
condition|)
name|bibTex_Copyright
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"copyright"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"price"
argument_list|)
operator|!=
literal|null
condition|)
name|bibTex_Price
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"price"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"size"
argument_list|)
operator|!=
literal|null
condition|)
name|bibTex_Size
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"size"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
comment|/* SM: 2010.10 end intype, paper support */
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"intype"
argument_list|)
operator|!=
literal|null
condition|)
name|bibTex_InType
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"intype"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"paper"
argument_list|)
operator|!=
literal|null
condition|)
name|bibTex_Paper
operator|=
name|bibtex
operator|.
name|getField
argument_list|(
literal|"paper"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"author"
argument_list|)
operator|!=
literal|null
condition|)
name|authors
operator|=
name|getAuthors
argument_list|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"author"
argument_list|)
operator|.
name|toString
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"editor"
argument_list|)
operator|!=
literal|null
condition|)
name|editors
operator|=
name|getAuthors
argument_list|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"editor"
argument_list|)
operator|.
name|toString
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|FORMATXML
condition|)
block|{
name|title
operator|=
name|format
argument_list|(
name|title
argument_list|)
expr_stmt|;
comment|// shortTitle = format(shortTitle);
comment|// publisher = format(publisher);
comment|// conferenceName = format(conferenceName);
comment|// department = format(department);
comment|// institution = format(institution);
comment|// internetSiteTitle = format(internetSiteTitle);
comment|// publicationTitle = format(publicationTitle);
comment|// albumTitle = format(albumTitle);
comment|// theater = format(theater);
comment|// distributor = format(distributor);
comment|// broadcastTitle = format(broadcastTitle);
comment|// broadcaster = format(broadcaster);
comment|// station = format(station);
comment|// court = format(court);
comment|// reporter = format(reporter);
comment|// bibTex_Series = format(bibTex_Series);
name|bibTex_Abstract
operator|=
name|format
argument_list|(
name|bibTex_Abstract
argument_list|)
expr_stmt|;
block|}
block|}
DECL|method|format (String value)
specifier|private
name|String
name|format
parameter_list|(
name|String
name|value
parameter_list|)
block|{
if|if
condition|(
name|value
operator|==
literal|null
condition|)
return|return
literal|null
return|;
name|String
name|result
init|=
literal|null
decl_stmt|;
name|LayoutFormatter
name|chars
init|=
operator|new
name|XMLChars
argument_list|()
decl_stmt|;
name|result
operator|=
name|chars
operator|.
name|format
argument_list|(
name|value
argument_list|)
expr_stmt|;
return|return
name|result
return|;
block|}
comment|// http://www.microsoft.com/globaldev/reference/lcid-all.mspx
DECL|method|getLCID (String language)
specifier|protected
name|int
name|getLCID
parameter_list|(
name|String
name|language
parameter_list|)
block|{
name|int
name|iLCID
init|=
literal|0
decl_stmt|;
comment|// TODO: add lanaguage to LCID mapping
return|return
name|iLCID
return|;
block|}
comment|// http://www.microsoft.com/globaldev/reference/lcid-all.mspx
DECL|method|getLanguage (int LCID)
specifier|protected
name|String
name|getLanguage
parameter_list|(
name|int
name|LCID
parameter_list|)
block|{
name|String
name|language
init|=
literal|"english"
decl_stmt|;
comment|// TODO: add lanaguage to LCID mapping
return|return
name|language
return|;
block|}
DECL|method|getSpecificAuthors (String type, Element authors, String _bcol)
specifier|protected
name|List
argument_list|<
name|PersonName
argument_list|>
name|getSpecificAuthors
parameter_list|(
name|String
name|type
parameter_list|,
name|Element
name|authors
parameter_list|,
name|String
name|_bcol
parameter_list|)
block|{
name|List
argument_list|<
name|PersonName
argument_list|>
name|result
init|=
literal|null
decl_stmt|;
name|NodeList
name|nodeLst
init|=
name|authors
operator|.
name|getElementsByTagName
argument_list|(
name|_bcol
operator|+
name|type
argument_list|)
decl_stmt|;
if|if
condition|(
name|nodeLst
operator|.
name|getLength
argument_list|()
operator|<=
literal|0
condition|)
return|return
name|result
return|;
name|nodeLst
operator|=
operator|(
call|(
name|Element
call|)
argument_list|(
name|nodeLst
operator|.
name|item
argument_list|(
literal|0
argument_list|)
argument_list|)
operator|)
operator|.
name|getElementsByTagName
argument_list|(
name|_bcol
operator|+
literal|"NameList"
argument_list|)
expr_stmt|;
if|if
condition|(
name|nodeLst
operator|.
name|getLength
argument_list|()
operator|<=
literal|0
condition|)
return|return
name|result
return|;
name|NodeList
name|person
init|=
operator|(
call|(
name|Element
call|)
argument_list|(
name|nodeLst
operator|.
name|item
argument_list|(
literal|0
argument_list|)
argument_list|)
operator|)
operator|.
name|getElementsByTagName
argument_list|(
name|_bcol
operator|+
literal|"Person"
argument_list|)
decl_stmt|;
if|if
condition|(
name|person
operator|.
name|getLength
argument_list|()
operator|<=
literal|0
condition|)
return|return
name|result
return|;
name|result
operator|=
operator|new
name|LinkedList
argument_list|<
name|PersonName
argument_list|>
argument_list|()
expr_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|person
operator|.
name|getLength
argument_list|()
condition|;
name|i
operator|++
control|)
block|{
name|NodeList
name|firstName
init|=
operator|(
call|(
name|Element
call|)
argument_list|(
name|person
operator|.
name|item
argument_list|(
name|i
argument_list|)
argument_list|)
operator|)
operator|.
name|getElementsByTagName
argument_list|(
name|_bcol
operator|+
literal|"First"
argument_list|)
decl_stmt|;
name|NodeList
name|lastName
init|=
operator|(
call|(
name|Element
call|)
argument_list|(
name|person
operator|.
name|item
argument_list|(
name|i
argument_list|)
argument_list|)
operator|)
operator|.
name|getElementsByTagName
argument_list|(
name|_bcol
operator|+
literal|"Last"
argument_list|)
decl_stmt|;
name|NodeList
name|middleName
init|=
operator|(
call|(
name|Element
call|)
argument_list|(
name|person
operator|.
name|item
argument_list|(
name|i
argument_list|)
argument_list|)
operator|)
operator|.
name|getElementsByTagName
argument_list|(
name|_bcol
operator|+
literal|"Middle"
argument_list|)
decl_stmt|;
name|PersonName
name|name
init|=
operator|new
name|PersonName
argument_list|()
decl_stmt|;
if|if
condition|(
name|firstName
operator|.
name|getLength
argument_list|()
operator|>
literal|0
condition|)
name|name
operator|.
name|setFirstname
argument_list|(
name|firstName
operator|.
name|item
argument_list|(
literal|0
argument_list|)
operator|.
name|getTextContent
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|middleName
operator|.
name|getLength
argument_list|()
operator|>
literal|0
condition|)
name|name
operator|.
name|setMiddlename
argument_list|(
name|middleName
operator|.
name|item
argument_list|(
literal|0
argument_list|)
operator|.
name|getTextContent
argument_list|()
argument_list|)
expr_stmt|;
if|if
condition|(
name|lastName
operator|.
name|getLength
argument_list|()
operator|>
literal|0
condition|)
name|name
operator|.
name|setSurname
argument_list|(
name|lastName
operator|.
name|item
argument_list|(
literal|0
argument_list|)
operator|.
name|getTextContent
argument_list|()
argument_list|)
expr_stmt|;
name|result
operator|.
name|add
argument_list|(
name|name
argument_list|)
expr_stmt|;
block|}
return|return
name|result
return|;
block|}
DECL|method|getAuthors (Element authorsElem, String _bcol)
specifier|protected
name|void
name|getAuthors
parameter_list|(
name|Element
name|authorsElem
parameter_list|,
name|String
name|_bcol
parameter_list|)
block|{
name|authors
operator|=
name|getSpecificAuthors
argument_list|(
literal|"Author"
argument_list|,
name|authorsElem
argument_list|,
name|_bcol
argument_list|)
expr_stmt|;
name|bookAuthors
operator|=
name|getSpecificAuthors
argument_list|(
literal|"BookAuthor"
argument_list|,
name|authorsElem
argument_list|,
name|_bcol
argument_list|)
expr_stmt|;
name|editors
operator|=
name|getSpecificAuthors
argument_list|(
literal|"Editor"
argument_list|,
name|authorsElem
argument_list|,
name|_bcol
argument_list|)
expr_stmt|;
name|translators
operator|=
name|getSpecificAuthors
argument_list|(
literal|"Translator"
argument_list|,
name|authorsElem
argument_list|,
name|_bcol
argument_list|)
expr_stmt|;
name|producerNames
operator|=
name|getSpecificAuthors
argument_list|(
literal|"ProducerName"
argument_list|,
name|authorsElem
argument_list|,
name|_bcol
argument_list|)
expr_stmt|;
name|composers
operator|=
name|getSpecificAuthors
argument_list|(
literal|"Composer"
argument_list|,
name|authorsElem
argument_list|,
name|_bcol
argument_list|)
expr_stmt|;
name|conductors
operator|=
name|getSpecificAuthors
argument_list|(
literal|"Conductor"
argument_list|,
name|authorsElem
argument_list|,
name|_bcol
argument_list|)
expr_stmt|;
name|performers
operator|=
name|getSpecificAuthors
argument_list|(
literal|"Performer"
argument_list|,
name|authorsElem
argument_list|,
name|_bcol
argument_list|)
expr_stmt|;
name|writers
operator|=
name|getSpecificAuthors
argument_list|(
literal|"Writer"
argument_list|,
name|authorsElem
argument_list|,
name|_bcol
argument_list|)
expr_stmt|;
name|directors
operator|=
name|getSpecificAuthors
argument_list|(
literal|"Director"
argument_list|,
name|authorsElem
argument_list|,
name|_bcol
argument_list|)
expr_stmt|;
name|compilers
operator|=
name|getSpecificAuthors
argument_list|(
literal|"Compiler"
argument_list|,
name|authorsElem
argument_list|,
name|_bcol
argument_list|)
expr_stmt|;
name|interviewers
operator|=
name|getSpecificAuthors
argument_list|(
literal|"Interviewer"
argument_list|,
name|authorsElem
argument_list|,
name|_bcol
argument_list|)
expr_stmt|;
name|interviewees
operator|=
name|getSpecificAuthors
argument_list|(
literal|"Interviewee"
argument_list|,
name|authorsElem
argument_list|,
name|_bcol
argument_list|)
expr_stmt|;
name|inventors
operator|=
name|getSpecificAuthors
argument_list|(
literal|"Inventor"
argument_list|,
name|authorsElem
argument_list|,
name|_bcol
argument_list|)
expr_stmt|;
name|counsels
operator|=
name|getSpecificAuthors
argument_list|(
literal|"Counsel"
argument_list|,
name|authorsElem
argument_list|,
name|_bcol
argument_list|)
expr_stmt|;
block|}
DECL|method|getAuthors (String authors)
specifier|protected
name|List
argument_list|<
name|PersonName
argument_list|>
name|getAuthors
parameter_list|(
name|String
name|authors
parameter_list|)
block|{
name|List
argument_list|<
name|PersonName
argument_list|>
name|result
init|=
operator|new
name|LinkedList
argument_list|<
name|PersonName
argument_list|>
argument_list|()
decl_stmt|;
if|if
condition|(
name|authors
operator|.
name|indexOf
argument_list|(
literal|" and "
argument_list|)
operator|==
operator|-
literal|1
condition|)
block|{
name|result
operator|.
name|add
argument_list|(
operator|new
name|PersonName
argument_list|(
name|authors
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|String
index|[]
name|names
init|=
name|authors
operator|.
name|split
argument_list|(
literal|" and "
argument_list|)
decl_stmt|;
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|names
operator|.
name|length
condition|;
name|i
operator|++
control|)
block|{
name|result
operator|.
name|add
argument_list|(
operator|new
name|PersonName
argument_list|(
name|names
index|[
name|i
index|]
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
return|return
name|result
return|;
block|}
comment|/* construct a MSBib date object */
DECL|method|getDate (BibtexEntry bibtex)
specifier|protected
name|String
name|getDate
parameter_list|(
name|BibtexEntry
name|bibtex
parameter_list|)
block|{
name|String
name|result
init|=
literal|""
decl_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"year"
argument_list|)
operator|!=
literal|null
condition|)
name|result
operator|+=
operator|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"year"
argument_list|)
operator|.
name|toString
argument_list|()
operator|)
expr_stmt|;
if|if
condition|(
name|bibtex
operator|.
name|getField
argument_list|(
literal|"month"
argument_list|)
operator|!=
literal|null
condition|)
name|result
operator|+=
literal|"-"
operator|+
name|bibtex
operator|.
name|getField
argument_list|(
literal|"month"
argument_list|)
operator|.
name|toString
argument_list|()
expr_stmt|;
return|return
name|result
return|;
block|}
DECL|method|getMSBibSourceType (BibtexEntry bibtex)
specifier|protected
name|String
name|getMSBibSourceType
parameter_list|(
name|BibtexEntry
name|bibtex
parameter_list|)
block|{
name|String
name|bibtexType
init|=
name|bibtex
operator|.
name|getType
argument_list|()
operator|.
name|getName
argument_list|()
decl_stmt|;
name|String
name|result
init|=
literal|"Misc"
decl_stmt|;
if|if
condition|(
name|bibtexType
operator|.
name|equalsIgnoreCase
argument_list|(
literal|"book"
argument_list|)
condition|)
name|result
operator|=
literal|"Book"
expr_stmt|;
elseif|else
if|if
condition|(
name|bibtexType
operator|.
name|equalsIgnoreCase
argument_list|(
literal|"inbook"
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"BookSection"
expr_stmt|;
name|bibTexEntry
operator|=
literal|"inbook"
expr_stmt|;
block|}
comment|/* SM 2010.10: generalized */
elseif|else
if|if
condition|(
name|bibtexType
operator|.
name|equalsIgnoreCase
argument_list|(
literal|"booklet"
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"BookSection"
expr_stmt|;
name|bibTexEntry
operator|=
literal|"booklet"
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|bibtexType
operator|.
name|equalsIgnoreCase
argument_list|(
literal|"incollection"
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"BookSection"
expr_stmt|;
name|bibTexEntry
operator|=
literal|"incollection"
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|bibtexType
operator|.
name|equalsIgnoreCase
argument_list|(
literal|"article"
argument_list|)
condition|)
name|result
operator|=
literal|"JournalArticle"
expr_stmt|;
elseif|else
if|if
condition|(
name|bibtexType
operator|.
name|equalsIgnoreCase
argument_list|(
literal|"inproceedings"
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"ConferenceProceedings"
expr_stmt|;
name|bibTexEntry
operator|=
literal|"inproceedings"
expr_stmt|;
block|}
comment|/* SM 2010.10: generalized */
elseif|else
if|if
condition|(
name|bibtexType
operator|.
name|equalsIgnoreCase
argument_list|(
literal|"conference"
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"ConferenceProceedings"
expr_stmt|;
name|bibTexEntry
operator|=
literal|"conference"
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|bibtexType
operator|.
name|equalsIgnoreCase
argument_list|(
literal|"proceedings"
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"ConferenceProceedings"
expr_stmt|;
name|bibTexEntry
operator|=
literal|"proceedings"
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|bibtexType
operator|.
name|equalsIgnoreCase
argument_list|(
literal|"collection"
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"ConferenceProceedings"
expr_stmt|;
name|bibTexEntry
operator|=
literal|"collection"
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|bibtexType
operator|.
name|equalsIgnoreCase
argument_list|(
literal|"techreport"
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"Report"
expr_stmt|;
name|bibTexEntry
operator|=
literal|"techreport"
expr_stmt|;
block|}
comment|/* SM 2010.10: generalized */
elseif|else
if|if
condition|(
name|bibtexType
operator|.
name|equalsIgnoreCase
argument_list|(
literal|"manual"
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"Report"
expr_stmt|;
name|bibTexEntry
operator|=
literal|"manual"
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|bibtexType
operator|.
name|equalsIgnoreCase
argument_list|(
literal|"mastersthesis"
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"Report"
expr_stmt|;
name|bibTexEntry
operator|=
literal|"mastersthesis"
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|bibtexType
operator|.
name|equalsIgnoreCase
argument_list|(
literal|"phdthesis"
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"Report"
expr_stmt|;
name|bibTexEntry
operator|=
literal|"phdthesis"
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|bibtexType
operator|.
name|equalsIgnoreCase
argument_list|(
literal|"unpublished"
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"Report"
expr_stmt|;
name|bibTexEntry
operator|=
literal|"unpublished"
expr_stmt|;
block|}
elseif|else
if|if
condition|(
name|bibtexType
operator|.
name|equalsIgnoreCase
argument_list|(
literal|"patent"
argument_list|)
condition|)
name|result
operator|=
literal|"Patent"
expr_stmt|;
elseif|else
if|if
condition|(
name|bibtexType
operator|.
name|equalsIgnoreCase
argument_list|(
literal|"misc"
argument_list|)
condition|)
name|result
operator|=
literal|"Misc"
expr_stmt|;
comment|/*SM: 2010.10 - bibtex @electronic */
elseif|else
if|if
condition|(
name|bibtexType
operator|.
name|equalsIgnoreCase
argument_list|(
literal|"electronic"
argument_list|)
condition|)
block|{
name|result
operator|=
literal|"Misc"
expr_stmt|;
name|bibTexEntry
operator|=
literal|"electronic"
expr_stmt|;
block|}
return|return
name|result
return|;
block|}
DECL|method|getDOMrepresentation ()
specifier|public
name|Node
name|getDOMrepresentation
parameter_list|()
block|{
name|Node
name|result
init|=
literal|null
decl_stmt|;
try|try
block|{
name|DocumentBuilder
name|d
init|=
name|DocumentBuilderFactory
operator|.
name|newInstance
argument_list|()
operator|.
name|newDocumentBuilder
argument_list|()
decl_stmt|;
name|result
operator|=
name|getDOMrepresentation
argument_list|(
name|d
operator|.
name|newDocument
argument_list|()
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|Exception
name|e
parameter_list|)
block|{
throw|throw
operator|new
name|Error
argument_list|(
name|e
argument_list|)
throw|;
block|}
return|return
name|result
return|;
block|}
DECL|method|addField (Document d,Element parent, String name, String value)
specifier|public
name|void
name|addField
parameter_list|(
name|Document
name|d
parameter_list|,
name|Element
name|parent
parameter_list|,
name|String
name|name
parameter_list|,
name|String
name|value
parameter_list|)
block|{
if|if
condition|(
name|value
operator|==
literal|null
condition|)
return|return;
name|Element
name|elem
init|=
name|d
operator|.
name|createElement
argument_list|(
name|bcol
operator|+
name|name
argument_list|)
decl_stmt|;
comment|// elem.appendChild(d.createTextNode(healXML(value)));
comment|//		Text txt = d.createTextNode(value);
comment|//		if(!txt.getTextContent().equals(value))
comment|//			System.out.println("Values dont match!");
comment|//			// throw new Exception("Values dont match!");
comment|//		elem.appendChild(txt);
name|elem
operator|.
name|appendChild
argument_list|(
name|d
operator|.
name|createTextNode
argument_list|(
name|stripNonValidXMLCharacters
argument_list|(
name|value
argument_list|)
argument_list|)
argument_list|)
expr_stmt|;
name|parent
operator|.
name|appendChild
argument_list|(
name|elem
argument_list|)
expr_stmt|;
block|}
DECL|method|addAuthor (Document d, Element allAuthors, String entryName, List<PersonName> authorsLst)
specifier|public
name|void
name|addAuthor
parameter_list|(
name|Document
name|d
parameter_list|,
name|Element
name|allAuthors
parameter_list|,
name|String
name|entryName
parameter_list|,
name|List
argument_list|<
name|PersonName
argument_list|>
name|authorsLst
parameter_list|)
block|{
if|if
condition|(
name|authorsLst
operator|==
literal|null
condition|)
return|return;
name|Element
name|authorTop
init|=
name|d
operator|.
name|createElement
argument_list|(
name|bcol
operator|+
name|entryName
argument_list|)
decl_stmt|;
name|Element
name|nameList
init|=
name|d
operator|.
name|createElement
argument_list|(
name|bcol
operator|+
literal|"NameList"
argument_list|)
decl_stmt|;
for|for
control|(
name|Iterator
argument_list|<
name|PersonName
argument_list|>
name|iter
init|=
name|authorsLst
operator|.
name|iterator
argument_list|()
init|;
name|iter
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|PersonName
name|name
init|=
name|iter
operator|.
name|next
argument_list|()
decl_stmt|;
name|Element
name|person
init|=
name|d
operator|.
name|createElement
argument_list|(
name|bcol
operator|+
literal|"Person"
argument_list|)
decl_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|person
argument_list|,
literal|"Last"
argument_list|,
name|name
operator|.
name|getSurname
argument_list|()
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|person
argument_list|,
literal|"Middle"
argument_list|,
name|name
operator|.
name|getMiddlename
argument_list|()
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|person
argument_list|,
literal|"First"
argument_list|,
name|name
operator|.
name|getFirstname
argument_list|()
argument_list|)
expr_stmt|;
name|nameList
operator|.
name|appendChild
argument_list|(
name|person
argument_list|)
expr_stmt|;
block|}
name|authorTop
operator|.
name|appendChild
argument_list|(
name|nameList
argument_list|)
expr_stmt|;
name|allAuthors
operator|.
name|appendChild
argument_list|(
name|authorTop
argument_list|)
expr_stmt|;
block|}
DECL|method|addAdrress (Document d,Element parent, String address)
specifier|public
name|void
name|addAdrress
parameter_list|(
name|Document
name|d
parameter_list|,
name|Element
name|parent
parameter_list|,
name|String
name|address
parameter_list|)
block|{
if|if
condition|(
name|address
operator|==
literal|null
condition|)
return|return;
comment|// US address parser
comment|// See documentation here http://regexlib.com/REDetails.aspx?regexp_id=472
comment|// Pattern p = Pattern.compile("^(?n:(((?<address1>(\\d{1,5}(\\ 1\\/[234])?(\\x20[A-Z]([a-z])+)+ )|(P\\.O\\.\\ Box\\ \\d{1,5}))\\s{1,2}(?i:(?<address2>(((APT|B LDG|DEPT|FL|HNGR|LOT|PIER|RM|S(LIP|PC|T(E|OP))|TRLR|UNIT)\\x20\\w{1,5})|(BSMT|FRNT|LBBY|LOWR|OFC|PH|REAR|SIDE|UPPR)\\.?)\\s{1,2})?))?)(?<city>[A-Z]([a-z])+(\\.?)(\\x20[A-Z]([a-z])+){0,2})([,\\x20]+?)(?<state>A[LKSZRAP]|C[AOT]|D[EC]|F[LM]|G[AU]|HI|I[ADL N]|K[SY]|LA|M[ADEHINOPST]|N[CDEHJMVY]|O[HKR]|P[ARW]|RI|S[CD] |T[NX]|UT|V[AIT]|W[AIVY])([,\\x20]+?)(?<zipcode>(?!0{5})\\d{5}(-\\d {4})?)((([,\\x20]+?)(?<country>[A-Z]([a-z])+(\\.?)(\\x20[A-Z]([a-z])+){0,2}))?))$");
comment|// the pattern above is for C#, may not work with java. Never tested though.
comment|// reduced subset, supports only "CITY , STATE, COUNTRY"
comment|// \b(\w+)\s?[,]?\s?(\w+)\s?[,]?\s?(\w+)\b
comment|// WORD SPACE , SPACE WORD SPACE , SPACE WORD
comment|// tested using http://www.javaregex.com/test.html
name|Pattern
name|p
init|=
name|Pattern
operator|.
name|compile
argument_list|(
literal|"\\b(\\w+)\\s*[,]?\\s*(\\w+)\\s*[,]?\\s*(\\w+)\\b"
argument_list|)
decl_stmt|;
name|Matcher
name|m
init|=
name|p
operator|.
name|matcher
argument_list|(
name|address
argument_list|)
decl_stmt|;
if|if
condition|(
name|m
operator|.
name|matches
argument_list|()
operator|&&
name|m
operator|.
name|groupCount
argument_list|()
operator|>
literal|3
condition|)
block|{
name|addField
argument_list|(
name|d
argument_list|,
name|parent
argument_list|,
literal|"City"
argument_list|,
name|m
operator|.
name|group
argument_list|(
literal|1
argument_list|)
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|parent
argument_list|,
literal|"StateProvince"
argument_list|,
name|m
operator|.
name|group
argument_list|(
literal|2
argument_list|)
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|parent
argument_list|,
literal|"CountryRegion"
argument_list|,
name|m
operator|.
name|group
argument_list|(
literal|3
argument_list|)
argument_list|)
expr_stmt|;
block|}
else|else
comment|/* SM: 2010.10 generalized */
name|addField
argument_list|(
name|d
argument_list|,
name|parent
argument_list|,
literal|"City"
argument_list|,
name|address
argument_list|)
expr_stmt|;
block|}
DECL|method|addDate (Document d,Element parent, String date, String extra)
specifier|public
name|void
name|addDate
parameter_list|(
name|Document
name|d
parameter_list|,
name|Element
name|parent
parameter_list|,
name|String
name|date
parameter_list|,
name|String
name|extra
parameter_list|)
block|{
if|if
condition|(
name|date
operator|==
literal|null
condition|)
return|return;
comment|// Allows 20.3-2007|||20/3-  2007 etc.
comment|// (\d{1,2})\s?[.,-/]\s?(\d{1,2})\s?[.,-/]\s?(\d{2,4})
comment|// 1-2 DIGITS SPACE SEPERATOR SPACE 1-2 DIGITS SPACE SEPERATOR SPACE 2-4 DIGITS
comment|// tested using http://www.javaregex.com/test.html
name|Pattern
name|p
init|=
name|Pattern
operator|.
name|compile
argument_list|(
literal|"(\\d{1,2})\\s*[.,-/]\\s*(\\d{1,2})\\s*[.,-/]\\s*(\\d{2,4})"
argument_list|)
decl_stmt|;
name|Matcher
name|m
init|=
name|p
operator|.
name|matcher
argument_list|(
name|date
argument_list|)
decl_stmt|;
if|if
condition|(
name|m
operator|.
name|matches
argument_list|()
operator|&&
name|m
operator|.
name|groupCount
argument_list|()
operator|>
literal|3
condition|)
block|{
name|addField
argument_list|(
name|d
argument_list|,
name|parent
argument_list|,
literal|"Month"
operator|+
name|extra
argument_list|,
name|m
operator|.
name|group
argument_list|(
literal|1
argument_list|)
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|parent
argument_list|,
literal|"Day"
operator|+
name|extra
argument_list|,
name|m
operator|.
name|group
argument_list|(
literal|2
argument_list|)
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|parent
argument_list|,
literal|"Year"
operator|+
name|extra
argument_list|,
name|m
operator|.
name|group
argument_list|(
literal|3
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
DECL|method|getDOMrepresentation (Document d)
specifier|public
name|Element
name|getDOMrepresentation
parameter_list|(
name|Document
name|d
parameter_list|)
block|{
try|try
block|{
name|Element
name|msbibEntry
init|=
name|d
operator|.
name|createElement
argument_list|(
name|bcol
operator|+
literal|"Source"
argument_list|)
decl_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"SourceType"
argument_list|,
name|sourceType
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
name|BIBTEX
operator|+
literal|"Entry"
argument_list|,
name|bibTexEntry
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"Tag"
argument_list|,
name|tag
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"GUID"
argument_list|,
name|GUID
argument_list|)
expr_stmt|;
if|if
condition|(
name|LCID
operator|>=
literal|0
condition|)
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"LCID"
argument_list|,
name|Integer
operator|.
name|toString
argument_list|(
name|LCID
argument_list|)
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"Title"
argument_list|,
name|title
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"Year"
argument_list|,
name|year
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"ShortTitle"
argument_list|,
name|shortTitle
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"Comments"
argument_list|,
name|comments
argument_list|)
expr_stmt|;
name|Element
name|allAuthors
init|=
name|d
operator|.
name|createElement
argument_list|(
name|bcol
operator|+
literal|"Author"
argument_list|)
decl_stmt|;
name|addAuthor
argument_list|(
name|d
argument_list|,
name|allAuthors
argument_list|,
literal|"Author"
argument_list|,
name|authors
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|d
argument_list|,
name|allAuthors
argument_list|,
literal|"BookAuthor"
argument_list|,
name|bookAuthors
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|d
argument_list|,
name|allAuthors
argument_list|,
literal|"Editor"
argument_list|,
name|editors
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|d
argument_list|,
name|allAuthors
argument_list|,
literal|"Translator"
argument_list|,
name|translators
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|d
argument_list|,
name|allAuthors
argument_list|,
literal|"ProducerName"
argument_list|,
name|producerNames
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|d
argument_list|,
name|allAuthors
argument_list|,
literal|"Composer"
argument_list|,
name|composers
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|d
argument_list|,
name|allAuthors
argument_list|,
literal|"Conductor"
argument_list|,
name|conductors
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|d
argument_list|,
name|allAuthors
argument_list|,
literal|"Performer"
argument_list|,
name|performers
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|d
argument_list|,
name|allAuthors
argument_list|,
literal|"Writer"
argument_list|,
name|writers
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|d
argument_list|,
name|allAuthors
argument_list|,
literal|"Director"
argument_list|,
name|directors
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|d
argument_list|,
name|allAuthors
argument_list|,
literal|"Compiler"
argument_list|,
name|compilers
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|d
argument_list|,
name|allAuthors
argument_list|,
literal|"Interviewer"
argument_list|,
name|interviewers
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|d
argument_list|,
name|allAuthors
argument_list|,
literal|"Interviewee"
argument_list|,
name|interviewees
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|d
argument_list|,
name|allAuthors
argument_list|,
literal|"Inventor"
argument_list|,
name|inventors
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|d
argument_list|,
name|allAuthors
argument_list|,
literal|"Counsel"
argument_list|,
name|counsels
argument_list|)
expr_stmt|;
name|msbibEntry
operator|.
name|appendChild
argument_list|(
name|allAuthors
argument_list|)
expr_stmt|;
if|if
condition|(
name|pages
operator|!=
literal|null
condition|)
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"Pages"
argument_list|,
name|pages
operator|.
name|toString
argument_list|(
literal|"-"
argument_list|)
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"Volume"
argument_list|,
name|volume
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"NumberVolumes"
argument_list|,
name|numberOfVolumes
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"Edition"
argument_list|,
name|edition
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"StandardNumber"
argument_list|,
name|standardNumber
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"Publisher"
argument_list|,
name|publisher
argument_list|)
expr_stmt|;
name|addAdrress
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
name|address
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"BookTitle"
argument_list|,
name|bookTitle
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"ChapterNumber"
argument_list|,
name|chapterNumber
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"JournalName"
argument_list|,
name|journalName
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"Issue"
argument_list|,
name|issue
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"PeriodicalTitle"
argument_list|,
name|periodicalTitle
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"ConferenceName"
argument_list|,
name|conferenceName
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"Department"
argument_list|,
name|department
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"Institution"
argument_list|,
name|institution
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"ThesisType"
argument_list|,
name|thesisType
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"InternetSiteTitle"
argument_list|,
name|internetSiteTitle
argument_list|)
expr_stmt|;
name|addDate
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
name|dateAccessed
argument_list|,
literal|"Accessed"
argument_list|)
expr_stmt|;
comment|/* SM 2010.10 added month export */
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"Month"
argument_list|,
name|month
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"URL"
argument_list|,
name|url
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"ProductionCompany"
argument_list|,
name|productionCompany
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"PublicationTitle"
argument_list|,
name|publicationTitle
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"Medium"
argument_list|,
name|medium
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"AlbumTitle"
argument_list|,
name|albumTitle
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"RecordingNumber"
argument_list|,
name|recordingNumber
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"Theater"
argument_list|,
name|theater
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"Distributor"
argument_list|,
name|distributor
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"BroadcastTitle"
argument_list|,
name|broadcastTitle
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"Broadcaster"
argument_list|,
name|broadcaster
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"Station"
argument_list|,
name|station
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"Type"
argument_list|,
name|type
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"PatentNumber"
argument_list|,
name|patentNumber
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"Court"
argument_list|,
name|court
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"Reporter"
argument_list|,
name|reporter
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"CaseNumber"
argument_list|,
name|caseNumber
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
literal|"AbbreviatedCaseNumber"
argument_list|,
name|abbreviatedCaseNumber
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
name|BIBTEX
operator|+
literal|"Series"
argument_list|,
name|bibTex_Series
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
name|BIBTEX
operator|+
literal|"Abstract"
argument_list|,
name|bibTex_Abstract
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
name|BIBTEX
operator|+
literal|"KeyWords"
argument_list|,
name|bibTex_KeyWords
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
name|BIBTEX
operator|+
literal|"CrossRef"
argument_list|,
name|bibTex_CrossRef
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
name|BIBTEX
operator|+
literal|"HowPublished"
argument_list|,
name|bibTex_HowPublished
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
name|BIBTEX
operator|+
literal|"Affiliation"
argument_list|,
name|bibTex_Affiliation
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
name|BIBTEX
operator|+
literal|"Contents"
argument_list|,
name|bibTex_Contents
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
name|BIBTEX
operator|+
literal|"Copyright"
argument_list|,
name|bibTex_Copyright
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
name|BIBTEX
operator|+
literal|"Price"
argument_list|,
name|bibTex_Price
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
name|BIBTEX
operator|+
literal|"Size"
argument_list|,
name|bibTex_Size
argument_list|)
expr_stmt|;
comment|/* SM: 2010.10 end intype, paper support */
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
name|BIBTEX
operator|+
literal|"InType"
argument_list|,
name|bibTex_InType
argument_list|)
expr_stmt|;
name|addField
argument_list|(
name|d
argument_list|,
name|msbibEntry
argument_list|,
name|BIBTEX
operator|+
literal|"Paper"
argument_list|,
name|bibTex_Paper
argument_list|)
expr_stmt|;
return|return
name|msbibEntry
return|;
block|}
catch|catch
parameter_list|(
name|Exception
name|e
parameter_list|)
block|{
name|System
operator|.
name|out
operator|.
name|println
argument_list|(
literal|"Exception caught..."
operator|+
name|e
argument_list|)
expr_stmt|;
name|e
operator|.
name|printStackTrace
argument_list|()
expr_stmt|;
throw|throw
operator|new
name|Error
argument_list|(
name|e
argument_list|)
throw|;
block|}
comment|// return null;
block|}
DECL|method|parseSingleStandardNumber (String type,String bibtype, String standardNum, HashMap<String, String> hm)
specifier|protected
name|void
name|parseSingleStandardNumber
parameter_list|(
name|String
name|type
parameter_list|,
name|String
name|bibtype
parameter_list|,
name|String
name|standardNum
parameter_list|,
name|HashMap
argument_list|<
name|String
argument_list|,
name|String
argument_list|>
name|hm
parameter_list|)
block|{
comment|// tested using http://www.javaregex.com/test.html
name|Pattern
name|p
init|=
name|Pattern
operator|.
name|compile
argument_list|(
literal|":"
operator|+
name|type
operator|+
literal|":(.[^:]+)"
argument_list|)
decl_stmt|;
name|Matcher
name|m
init|=
name|p
operator|.
name|matcher
argument_list|(
name|standardNum
argument_list|)
decl_stmt|;
if|if
condition|(
name|m
operator|.
name|matches
argument_list|()
condition|)
name|hm
operator|.
name|put
argument_list|(
name|bibtype
argument_list|,
name|m
operator|.
name|group
argument_list|(
literal|1
argument_list|)
argument_list|)
expr_stmt|;
block|}
DECL|method|parseStandardNumber (String standardNum, HashMap<String, String> hm)
specifier|protected
name|void
name|parseStandardNumber
parameter_list|(
name|String
name|standardNum
parameter_list|,
name|HashMap
argument_list|<
name|String
argument_list|,
name|String
argument_list|>
name|hm
parameter_list|)
block|{
if|if
condition|(
name|standardNumber
operator|==
literal|null
condition|)
return|return;
name|parseSingleStandardNumber
argument_list|(
literal|"ISBN"
argument_list|,
literal|"isbn"
argument_list|,
name|standardNum
argument_list|,
name|hm
argument_list|)
expr_stmt|;
comment|/* SM: 2010.10: lower case */
name|parseSingleStandardNumber
argument_list|(
literal|"ISSN"
argument_list|,
literal|"issn"
argument_list|,
name|standardNum
argument_list|,
name|hm
argument_list|)
expr_stmt|;
comment|/* SM: 2010.10: lower case */
name|parseSingleStandardNumber
argument_list|(
literal|"LCCN"
argument_list|,
literal|"lccn"
argument_list|,
name|standardNum
argument_list|,
name|hm
argument_list|)
expr_stmt|;
comment|/* SM: 2010.10: lower case */
name|parseSingleStandardNumber
argument_list|(
literal|"MRN"
argument_list|,
literal|"mrnumber"
argument_list|,
name|standardNum
argument_list|,
name|hm
argument_list|)
expr_stmt|;
comment|/* SM: 2010.10 begin DOI support */
name|parseSingleStandardNumber
argument_list|(
literal|"DOI"
argument_list|,
literal|"doi"
argument_list|,
name|standardNum
argument_list|,
name|hm
argument_list|)
expr_stmt|;
comment|/* SM: 2010.10 end DOI support */
block|}
DECL|method|addAuthor (HashMap<String, String> hm, String type, List<PersonName> authorsLst)
specifier|public
name|void
name|addAuthor
parameter_list|(
name|HashMap
argument_list|<
name|String
argument_list|,
name|String
argument_list|>
name|hm
parameter_list|,
name|String
name|type
parameter_list|,
name|List
argument_list|<
name|PersonName
argument_list|>
name|authorsLst
parameter_list|)
block|{
if|if
condition|(
name|authorsLst
operator|==
literal|null
condition|)
return|return;
name|String
name|allAuthors
init|=
literal|""
decl_stmt|;
name|boolean
name|First
init|=
literal|true
decl_stmt|;
for|for
control|(
name|Iterator
argument_list|<
name|PersonName
argument_list|>
name|iter
init|=
name|authorsLst
operator|.
name|iterator
argument_list|()
init|;
name|iter
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|PersonName
name|name
init|=
name|iter
operator|.
name|next
argument_list|()
decl_stmt|;
if|if
condition|(
operator|!
name|First
condition|)
name|allAuthors
operator|+=
literal|" and "
expr_stmt|;
name|allAuthors
operator|+=
name|name
operator|.
name|getFullname
argument_list|()
expr_stmt|;
name|First
operator|=
literal|false
expr_stmt|;
block|}
name|hm
operator|.
name|put
argument_list|(
name|type
argument_list|,
name|allAuthors
argument_list|)
expr_stmt|;
block|}
comment|//	public String mapMSBibToBibtexTypeString(String msbib) {
comment|//		String bibtex = "other";
comment|//		if(msbib.equals("Book"))
comment|//			bibtex = "book";
comment|//		else if(msbib.equals("BookSection"))
comment|//			bibtex = "inbook";
comment|//		else if(msbib.equals("JournalArticle"))
comment|//			bibtex = "article";
comment|//		else if(msbib.equals("ArticleInAPeriodical"))
comment|//			bibtex = "article";
comment|//		else if(msbib.equals("ConferenceProceedings"))
comment|//			bibtex = "conference";
comment|//		else if(msbib.equals("Report"))
comment|//			bibtex = "techreport";
comment|//		else if(msbib.equals("InternetSite"))
comment|//			bibtex = "other";
comment|//		else if(msbib.equals("DocumentFromInternetSite"))
comment|//			bibtex = "other";
comment|//		else if(msbib.equals("DocumentFromInternetSite"))
comment|//			bibtex = "other";
comment|//		else if(msbib.equals("ElectronicSource"))
comment|//			bibtex = "other";
comment|//		else if(msbib.equals("Art"))
comment|//			bibtex = "other";
comment|//		else if(msbib.equals("SoundRecording"))
comment|//			bibtex = "other";
comment|//		else if(msbib.equals("Performance"))
comment|//			bibtex = "other";
comment|//		else if(msbib.equals("Film"))
comment|//			bibtex = "other";
comment|//		else if(msbib.equals("Interview"))
comment|//			bibtex = "other";
comment|//		else if(msbib.equals("Patent"))
comment|//			bibtex = "other";
comment|//		else if(msbib.equals("Case"))
comment|//			bibtex = "other";
comment|//		else if(msbib.equals("Misc"))
comment|//			bibtex = "misc";
comment|//		else
comment|//			bibtex = "misc";
comment|//
comment|//		return bibtex;
comment|//	}
DECL|method|mapMSBibToBibtexType (String msbib)
specifier|public
name|BibtexEntryType
name|mapMSBibToBibtexType
parameter_list|(
name|String
name|msbib
parameter_list|)
block|{
name|BibtexEntryType
name|bibtex
init|=
name|BibtexEntryType
operator|.
name|OTHER
decl_stmt|;
if|if
condition|(
name|msbib
operator|.
name|equals
argument_list|(
literal|"Book"
argument_list|)
condition|)
name|bibtex
operator|=
name|BibtexEntryType
operator|.
name|BOOK
expr_stmt|;
elseif|else
if|if
condition|(
name|msbib
operator|.
name|equals
argument_list|(
literal|"BookSection"
argument_list|)
condition|)
name|bibtex
operator|=
name|BibtexEntryType
operator|.
name|INBOOK
expr_stmt|;
elseif|else
if|if
condition|(
name|msbib
operator|.
name|equals
argument_list|(
literal|"JournalArticle"
argument_list|)
condition|)
name|bibtex
operator|=
name|BibtexEntryType
operator|.
name|ARTICLE
expr_stmt|;
elseif|else
if|if
condition|(
name|msbib
operator|.
name|equals
argument_list|(
literal|"ArticleInAPeriodical"
argument_list|)
condition|)
name|bibtex
operator|=
name|BibtexEntryType
operator|.
name|ARTICLE
expr_stmt|;
elseif|else
if|if
condition|(
name|msbib
operator|.
name|equals
argument_list|(
literal|"ConferenceProceedings"
argument_list|)
condition|)
name|bibtex
operator|=
name|BibtexEntryType
operator|.
name|CONFERENCE
expr_stmt|;
elseif|else
if|if
condition|(
name|msbib
operator|.
name|equals
argument_list|(
literal|"Report"
argument_list|)
condition|)
name|bibtex
operator|=
name|BibtexEntryType
operator|.
name|TECHREPORT
expr_stmt|;
elseif|else
if|if
condition|(
name|msbib
operator|.
name|equals
argument_list|(
literal|"InternetSite"
argument_list|)
condition|)
name|bibtex
operator|=
name|BibtexEntryType
operator|.
name|OTHER
expr_stmt|;
elseif|else
if|if
condition|(
name|msbib
operator|.
name|equals
argument_list|(
literal|"DocumentFromInternetSite"
argument_list|)
condition|)
name|bibtex
operator|=
name|BibtexEntryType
operator|.
name|OTHER
expr_stmt|;
elseif|else
if|if
condition|(
name|msbib
operator|.
name|equals
argument_list|(
literal|"DocumentFromInternetSite"
argument_list|)
condition|)
name|bibtex
operator|=
name|BibtexEntryType
operator|.
name|OTHER
expr_stmt|;
elseif|else
if|if
condition|(
name|msbib
operator|.
name|equals
argument_list|(
literal|"ElectronicSource"
argument_list|)
condition|)
name|bibtex
operator|=
name|BibtexEntryType
operator|.
name|OTHER
expr_stmt|;
elseif|else
if|if
condition|(
name|msbib
operator|.
name|equals
argument_list|(
literal|"Art"
argument_list|)
condition|)
name|bibtex
operator|=
name|BibtexEntryType
operator|.
name|OTHER
expr_stmt|;
elseif|else
if|if
condition|(
name|msbib
operator|.
name|equals
argument_list|(
literal|"SoundRecording"
argument_list|)
condition|)
name|bibtex
operator|=
name|BibtexEntryType
operator|.
name|OTHER
expr_stmt|;
elseif|else
if|if
condition|(
name|msbib
operator|.
name|equals
argument_list|(
literal|"Performance"
argument_list|)
condition|)
name|bibtex
operator|=
name|BibtexEntryType
operator|.
name|OTHER
expr_stmt|;
elseif|else
if|if
condition|(
name|msbib
operator|.
name|equals
argument_list|(
literal|"Film"
argument_list|)
condition|)
name|bibtex
operator|=
name|BibtexEntryType
operator|.
name|OTHER
expr_stmt|;
elseif|else
if|if
condition|(
name|msbib
operator|.
name|equals
argument_list|(
literal|"Interview"
argument_list|)
condition|)
name|bibtex
operator|=
name|BibtexEntryType
operator|.
name|OTHER
expr_stmt|;
elseif|else
if|if
condition|(
name|msbib
operator|.
name|equals
argument_list|(
literal|"Patent"
argument_list|)
condition|)
name|bibtex
operator|=
name|BibtexEntryType
operator|.
name|OTHER
expr_stmt|;
elseif|else
if|if
condition|(
name|msbib
operator|.
name|equals
argument_list|(
literal|"Case"
argument_list|)
condition|)
name|bibtex
operator|=
name|BibtexEntryType
operator|.
name|OTHER
expr_stmt|;
elseif|else
if|if
condition|(
name|msbib
operator|.
name|equals
argument_list|(
literal|"Misc"
argument_list|)
condition|)
name|bibtex
operator|=
name|BibtexEntryType
operator|.
name|MISC
expr_stmt|;
else|else
name|bibtex
operator|=
name|BibtexEntryType
operator|.
name|MISC
expr_stmt|;
return|return
name|bibtex
return|;
block|}
DECL|method|getBibtexRepresentation ()
specifier|public
name|BibtexEntry
name|getBibtexRepresentation
parameter_list|()
block|{
comment|//		BibtexEntry entry = new BibtexEntry(BibtexFields.DEFAULT_BIBTEXENTRY_ID,
comment|//				Globals.getEntryType(mapMSBibToBibtexTypeString(sourceType)));
comment|//		BibtexEntry entry = new BibtexEntry(BibtexFields.DEFAULT_BIBTEXENTRY_ID,
comment|//				mapMSBibToBibtexType(sourceType));
name|BibtexEntry
name|entry
init|=
literal|null
decl_stmt|;
if|if
condition|(
name|tag
operator|==
literal|null
condition|)
name|entry
operator|=
operator|new
name|BibtexEntry
argument_list|(
name|BibtexFields
operator|.
name|DEFAULT_BIBTEXENTRY_ID
argument_list|,
name|mapMSBibToBibtexType
argument_list|(
name|sourceType
argument_list|)
argument_list|)
expr_stmt|;
else|else
name|entry
operator|=
operator|new
name|BibtexEntry
argument_list|(
name|tag
argument_list|,
name|mapMSBibToBibtexType
argument_list|(
name|sourceType
argument_list|)
argument_list|)
expr_stmt|;
comment|// id assumes an existing database so don't
comment|// Todo: add check for BibTexEntry types
comment|//		BibtexEntry entry = new BibtexEntry();
comment|//		if(sourceType.equals("Book"))
comment|//			entry.setType(BibtexEntryType.BOOK);
comment|//		else if(sourceType.equals("BookSection"))
comment|//			entry.setType(BibtexEntryType.INBOOK);
comment|//		else if(sourceType.equals("JournalArticle"))
comment|//			entry.setType(BibtexEntryType.ARTICLE);
comment|//		else if(sourceType.equals("ArticleInAPeriodical"))
comment|//			entry.setType(BibtexEntryType.ARTICLE);
comment|//		else if(sourceType.equals("ConferenceProceedings"))
comment|//			entry.setType(BibtexEntryType.CONFERENCE);
comment|//		else if(sourceType.equals("Report"))
comment|//			entry.setType(BibtexEntryType.TECHREPORT);
comment|//		else if(sourceType.equals("InternetSite"))
comment|//			entry.setType(BibtexEntryType.OTHER);
comment|//		else if(sourceType.equals("DocumentFromInternetSite"))
comment|//			entry.setType(BibtexEntryType.OTHER);
comment|//		else if(sourceType.equals("DocumentFromInternetSite"))
comment|//			entry.setType(BibtexEntryType.OTHER);
comment|//		else if(sourceType.equals("ElectronicSource"))
comment|//			entry.setType(BibtexEntryType.OTHER);
comment|//		else if(sourceType.equals("Art"))
comment|//			entry.setType(BibtexEntryType.OTHER);
comment|//		else if(sourceType.equals("SoundRecording"))
comment|//			entry.setType(BibtexEntryType.OTHER);
comment|//		else if(sourceType.equals("Performance"))
comment|//			entry.setType(BibtexEntryType.OTHER);
comment|//		else if(sourceType.equals("Film"))
comment|//			entry.setType(BibtexEntryType.OTHER);
comment|//		else if(sourceType.equals("Interview"))
comment|//			entry.setType(BibtexEntryType.OTHER);
comment|//		else if(sourceType.equals("Patent"))
comment|//			entry.setType(BibtexEntryType.OTHER);
comment|//		else if(sourceType.equals("Case"))
comment|//			entry.setType(BibtexEntryType.OTHER);
comment|//		else if(sourceType.equals("Misc"))
comment|//			entry.setType(BibtexEntryType.MISC);
comment|//		else
comment|//			entry.setType(BibtexEntryType.MISC);
name|HashMap
argument_list|<
name|String
argument_list|,
name|String
argument_list|>
name|hm
init|=
operator|new
name|HashMap
argument_list|<
name|String
argument_list|,
name|String
argument_list|>
argument_list|()
decl_stmt|;
if|if
condition|(
name|tag
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"bibtexkey"
argument_list|,
name|tag
argument_list|)
expr_stmt|;
comment|//		if(GUID != null)
comment|//			hm.put("GUID",GUID);
if|if
condition|(
name|LCID
operator|>=
literal|0
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"language"
argument_list|,
name|getLanguage
argument_list|(
name|LCID
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|title
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"title"
argument_list|,
name|title
argument_list|)
expr_stmt|;
if|if
condition|(
name|year
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"year"
argument_list|,
name|year
argument_list|)
expr_stmt|;
if|if
condition|(
name|shortTitle
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"shorttitle"
argument_list|,
name|shortTitle
argument_list|)
expr_stmt|;
if|if
condition|(
name|comments
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"note"
argument_list|,
name|comments
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
literal|"author"
argument_list|,
name|authors
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
name|MSBIB
operator|+
literal|"bookauthor"
argument_list|,
name|bookAuthors
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
literal|"editor"
argument_list|,
name|editors
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
name|MSBIB
operator|+
literal|"translator"
argument_list|,
name|translators
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
name|MSBIB
operator|+
literal|"producername"
argument_list|,
name|producerNames
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
name|MSBIB
operator|+
literal|"composer"
argument_list|,
name|composers
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
name|MSBIB
operator|+
literal|"conductor"
argument_list|,
name|conductors
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
name|MSBIB
operator|+
literal|"performer"
argument_list|,
name|performers
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
name|MSBIB
operator|+
literal|"writer"
argument_list|,
name|writers
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
name|MSBIB
operator|+
literal|"director"
argument_list|,
name|directors
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
name|MSBIB
operator|+
literal|"compiler"
argument_list|,
name|compilers
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
name|MSBIB
operator|+
literal|"interviewer"
argument_list|,
name|interviewers
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
name|MSBIB
operator|+
literal|"interviewee"
argument_list|,
name|interviewees
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
name|MSBIB
operator|+
literal|"inventor"
argument_list|,
name|inventors
argument_list|)
expr_stmt|;
name|addAuthor
argument_list|(
name|hm
argument_list|,
name|MSBIB
operator|+
literal|"counsel"
argument_list|,
name|counsels
argument_list|)
expr_stmt|;
if|if
condition|(
name|pages
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"pages"
argument_list|,
name|pages
operator|.
name|toString
argument_list|(
literal|"--"
argument_list|)
argument_list|)
expr_stmt|;
if|if
condition|(
name|volume
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"volume"
argument_list|,
name|volume
argument_list|)
expr_stmt|;
if|if
condition|(
name|numberOfVolumes
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"numberofvolume"
argument_list|,
name|numberOfVolumes
argument_list|)
expr_stmt|;
if|if
condition|(
name|edition
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"edition"
argument_list|,
name|edition
argument_list|)
expr_stmt|;
if|if
condition|(
name|edition
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"edition"
argument_list|,
name|edition
argument_list|)
expr_stmt|;
name|parseStandardNumber
argument_list|(
name|standardNumber
argument_list|,
name|hm
argument_list|)
expr_stmt|;
if|if
condition|(
name|publisher
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"publisher"
argument_list|,
name|publisher
argument_list|)
expr_stmt|;
if|if
condition|(
name|publisher
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"publisher"
argument_list|,
name|publisher
argument_list|)
expr_stmt|;
if|if
condition|(
name|address
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"address"
argument_list|,
name|address
argument_list|)
expr_stmt|;
if|if
condition|(
name|bookTitle
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"booktitle"
argument_list|,
name|bookTitle
argument_list|)
expr_stmt|;
if|if
condition|(
name|chapterNumber
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"chapter"
argument_list|,
name|chapterNumber
argument_list|)
expr_stmt|;
if|if
condition|(
name|journalName
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"journal"
argument_list|,
name|journalName
argument_list|)
expr_stmt|;
if|if
condition|(
name|issue
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"number"
argument_list|,
name|issue
argument_list|)
expr_stmt|;
if|if
condition|(
name|month
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"month"
argument_list|,
name|month
argument_list|)
expr_stmt|;
if|if
condition|(
name|periodicalTitle
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"organization"
argument_list|,
name|periodicalTitle
argument_list|)
expr_stmt|;
if|if
condition|(
name|conferenceName
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"organization"
argument_list|,
name|conferenceName
argument_list|)
expr_stmt|;
if|if
condition|(
name|department
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"school"
argument_list|,
name|department
argument_list|)
expr_stmt|;
if|if
condition|(
name|institution
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"institution"
argument_list|,
name|institution
argument_list|)
expr_stmt|;
comment|//		if(thesisType !=null )
comment|//			hm.put("type",thesisType);
comment|//		if(internetSiteTitle !=null )
comment|//			hm.put("title",internetSiteTitle);
if|if
condition|(
name|dateAccessed
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"accessed"
argument_list|,
name|dateAccessed
argument_list|)
expr_stmt|;
if|if
condition|(
name|url
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"url"
argument_list|,
name|url
argument_list|)
expr_stmt|;
if|if
condition|(
name|productionCompany
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"productioncompany"
argument_list|,
name|productionCompany
argument_list|)
expr_stmt|;
comment|//		if(publicationTitle !=null )
comment|//			hm.put("title",publicationTitle);
if|if
condition|(
name|medium
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"medium"
argument_list|,
name|medium
argument_list|)
expr_stmt|;
comment|//		if(albumTitle !=null )
comment|//			hm.put("title",albumTitle);
if|if
condition|(
name|recordingNumber
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"recordingnumber"
argument_list|,
name|recordingNumber
argument_list|)
expr_stmt|;
if|if
condition|(
name|theater
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"theater"
argument_list|,
name|theater
argument_list|)
expr_stmt|;
if|if
condition|(
name|distributor
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"distributor"
argument_list|,
name|distributor
argument_list|)
expr_stmt|;
comment|//		if(broadcastTitle !=null )
comment|//			hm.put("title",broadcastTitle);
if|if
condition|(
name|broadcaster
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"broadcaster"
argument_list|,
name|broadcaster
argument_list|)
expr_stmt|;
if|if
condition|(
name|station
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"station"
argument_list|,
name|station
argument_list|)
expr_stmt|;
if|if
condition|(
name|type
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"type"
argument_list|,
name|type
argument_list|)
expr_stmt|;
if|if
condition|(
name|patentNumber
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"patentnumber"
argument_list|,
name|patentNumber
argument_list|)
expr_stmt|;
if|if
condition|(
name|court
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"court"
argument_list|,
name|court
argument_list|)
expr_stmt|;
if|if
condition|(
name|reporter
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"reporter"
argument_list|,
name|reporter
argument_list|)
expr_stmt|;
if|if
condition|(
name|caseNumber
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"casenumber"
argument_list|,
name|caseNumber
argument_list|)
expr_stmt|;
if|if
condition|(
name|abbreviatedCaseNumber
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
name|MSBIB
operator|+
literal|"abbreviatedcasenumber"
argument_list|,
name|abbreviatedCaseNumber
argument_list|)
expr_stmt|;
if|if
condition|(
name|bibTex_Series
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"series"
argument_list|,
name|bibTex_Series
argument_list|)
expr_stmt|;
if|if
condition|(
name|bibTex_Abstract
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"abstract"
argument_list|,
name|bibTex_Abstract
argument_list|)
expr_stmt|;
if|if
condition|(
name|bibTex_KeyWords
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"keywords"
argument_list|,
name|bibTex_KeyWords
argument_list|)
expr_stmt|;
if|if
condition|(
name|bibTex_CrossRef
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"crossref"
argument_list|,
name|bibTex_CrossRef
argument_list|)
expr_stmt|;
if|if
condition|(
name|bibTex_HowPublished
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"howpublished"
argument_list|,
name|bibTex_HowPublished
argument_list|)
expr_stmt|;
if|if
condition|(
name|bibTex_Affiliation
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"affiliation"
argument_list|,
name|bibTex_Affiliation
argument_list|)
expr_stmt|;
if|if
condition|(
name|bibTex_Contents
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"contents"
argument_list|,
name|bibTex_Contents
argument_list|)
expr_stmt|;
if|if
condition|(
name|bibTex_Copyright
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"copyright"
argument_list|,
name|bibTex_Copyright
argument_list|)
expr_stmt|;
if|if
condition|(
name|bibTex_Price
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"price"
argument_list|,
name|bibTex_Price
argument_list|)
expr_stmt|;
if|if
condition|(
name|bibTex_Size
operator|!=
literal|null
condition|)
name|hm
operator|.
name|put
argument_list|(
literal|"size"
argument_list|,
name|bibTex_Size
argument_list|)
expr_stmt|;
name|entry
operator|.
name|setField
argument_list|(
name|hm
argument_list|)
expr_stmt|;
return|return
name|entry
return|;
block|}
comment|/** 	 * This method ensures that the output String has only      * valid XML unicode characters as specified by the      * XML 1.0 standard. For reference, please see      *<a href="http://www.w3.org/TR/2000/REC-xml-20001006#NT-Char">the      * standard</a>. This method will return an empty      * String if the input is null or empty.      *       * URL: http://cse-mjmcl.cse.bris.ac.uk/blog/2007/02/14/1171465494443.html      *      * @param in The String whose non-valid characters we want to remove.      * @return The in String, stripped of non-valid characters.      */
DECL|method|stripNonValidXMLCharacters (String in)
specifier|public
name|String
name|stripNonValidXMLCharacters
parameter_list|(
name|String
name|in
parameter_list|)
block|{
name|StringBuffer
name|out
init|=
operator|new
name|StringBuffer
argument_list|()
decl_stmt|;
comment|// Used to hold the output.
name|char
name|current
decl_stmt|;
comment|// Used to reference the current character.
if|if
condition|(
name|in
operator|==
literal|null
operator|||
operator|(
literal|""
operator|.
name|equals
argument_list|(
name|in
argument_list|)
operator|)
condition|)
return|return
literal|""
return|;
comment|// vacancy test.
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|in
operator|.
name|length
argument_list|()
condition|;
name|i
operator|++
control|)
block|{
name|current
operator|=
name|in
operator|.
name|charAt
argument_list|(
name|i
argument_list|)
expr_stmt|;
comment|// NOTE: No IndexOutOfBoundsException caught here; it should not happen.
if|if
condition|(
operator|(
name|current
operator|==
literal|0x9
operator|)
operator|||
operator|(
name|current
operator|==
literal|0xA
operator|)
operator|||
operator|(
name|current
operator|==
literal|0xD
operator|)
operator|||
operator|(
operator|(
name|current
operator|>=
literal|0x20
operator|)
operator|&&
operator|(
name|current
operator|<=
literal|0xD7FF
operator|)
operator|)
operator|||
operator|(
operator|(
name|current
operator|>=
literal|0xE000
operator|)
operator|&&
operator|(
name|current
operator|<=
literal|0xFFFD
operator|)
operator|)
operator|||
operator|(
operator|(
name|current
operator|>=
literal|0x10000
operator|)
operator|&&
operator|(
name|current
operator|<=
literal|0x10FFFF
operator|)
operator|)
condition|)
name|out
operator|.
name|append
argument_list|(
name|current
argument_list|)
expr_stmt|;
block|}
return|return
name|out
operator|.
name|toString
argument_list|()
return|;
block|}
comment|/* 	 * render as XML 	 *  	 * TODO This is untested. 	 */
DECL|method|toString ()
specifier|public
name|String
name|toString
parameter_list|()
block|{
name|StringWriter
name|sresult
init|=
operator|new
name|StringWriter
argument_list|()
decl_stmt|;
try|try
block|{
name|DOMSource
name|source
init|=
operator|new
name|DOMSource
argument_list|(
name|getDOMrepresentation
argument_list|()
argument_list|)
decl_stmt|;
name|StreamResult
name|result
init|=
operator|new
name|StreamResult
argument_list|(
name|sresult
argument_list|)
decl_stmt|;
name|Transformer
name|trans
init|=
name|TransformerFactory
operator|.
name|newInstance
argument_list|()
operator|.
name|newTransformer
argument_list|()
decl_stmt|;
name|trans
operator|.
name|setOutputProperty
argument_list|(
name|OutputKeys
operator|.
name|INDENT
argument_list|,
literal|"yes"
argument_list|)
expr_stmt|;
name|trans
operator|.
name|transform
argument_list|(
name|source
argument_list|,
name|result
argument_list|)
expr_stmt|;
block|}
catch|catch
parameter_list|(
name|Exception
name|e
parameter_list|)
block|{
throw|throw
operator|new
name|Error
argument_list|(
name|e
argument_list|)
throw|;
block|}
return|return
name|sresult
operator|.
name|toString
argument_list|()
return|;
block|}
block|}
end_class

end_unit

