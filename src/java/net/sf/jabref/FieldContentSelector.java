begin_unit|revision:0.9.5;language:Java;cregit-version:0.0.1
begin_comment
comment|/* Copyright (C) 2003 Morten O. Alver, Nizar N. Batada  All programs in this directory and subdirectories are published under the GNU General Public License as described below.  This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA  Further information about the GNU GPL is available at: http://www.gnu.org/copyleft/gpl.ja.html  */
end_comment

begin_package
DECL|package|net.sf.jabref
package|package
name|net
operator|.
name|sf
operator|.
name|jabref
package|;
end_package

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Vector
import|;
end_import

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|*
import|;
end_import

begin_import
import|import
name|java
operator|.
name|awt
operator|.
name|*
import|;
end_import

begin_import
import|import
name|java
operator|.
name|awt
operator|.
name|event
operator|.
name|*
import|;
end_import

begin_class
DECL|class|FieldContentSelector
class|class
name|FieldContentSelector
extends|extends
name|JComponent
implements|implements
name|ItemListener
block|{
DECL|field|DELIMITER
specifier|final
name|String
name|DELIMITER
init|=
literal|" "
decl_stmt|;
DECL|field|editor
name|FieldEditor
name|editor
decl_stmt|;
DECL|field|list
name|JComboBox
name|list
init|=
operator|new
name|JComboBox
argument_list|()
decl_stmt|;
DECL|field|manage
name|JButton
name|manage
decl_stmt|;
DECL|field|gbl
name|GridBagLayout
name|gbl
init|=
operator|new
name|GridBagLayout
argument_list|()
decl_stmt|;
DECL|field|con
name|GridBagConstraints
name|con
init|=
operator|new
name|GridBagConstraints
argument_list|()
decl_stmt|;
DECL|field|parent
name|EntryEditor
name|parent
decl_stmt|;
DECL|field|metaData
name|MetaData
name|metaData
decl_stmt|;
DECL|method|FieldContentSelector (EntryEditor parent, FieldEditor editor_, MetaData data)
specifier|public
name|FieldContentSelector
parameter_list|(
name|EntryEditor
name|parent
parameter_list|,
name|FieldEditor
name|editor_
parameter_list|,
name|MetaData
name|data
parameter_list|)
block|{
name|setLayout
argument_list|(
name|gbl
argument_list|)
expr_stmt|;
name|this
operator|.
name|editor
operator|=
name|editor_
expr_stmt|;
name|this
operator|.
name|parent
operator|=
name|parent
expr_stmt|;
name|metaData
operator|=
name|data
expr_stmt|;
specifier|final
name|MetaData
name|metaData
init|=
name|data
decl_stmt|;
specifier|final
name|JabRefFrame
name|frame
init|=
name|parent
operator|.
name|frame
decl_stmt|;
name|updateList
argument_list|()
expr_stmt|;
comment|//else
comment|//    list = new JComboBox(items.toArray());
name|list
operator|.
name|setBackground
argument_list|(
name|GUIGlobals
operator|.
name|lightGray
argument_list|)
expr_stmt|;
name|con
operator|.
name|gridwidth
operator|=
name|GridBagConstraints
operator|.
name|REMAINDER
expr_stmt|;
name|con
operator|.
name|fill
operator|=
name|GridBagConstraints
operator|.
name|HORIZONTAL
expr_stmt|;
name|gbl
operator|.
name|setConstraints
argument_list|(
name|list
argument_list|,
name|con
argument_list|)
expr_stmt|;
name|list
operator|.
name|addItemListener
argument_list|(
name|this
argument_list|)
expr_stmt|;
name|add
argument_list|(
name|list
argument_list|)
expr_stmt|;
name|manage
operator|=
operator|new
name|JButton
argument_list|(
name|Globals
operator|.
name|lang
argument_list|(
literal|"Manage"
argument_list|)
argument_list|)
expr_stmt|;
name|manage
operator|.
name|setBackground
argument_list|(
name|GUIGlobals
operator|.
name|lightGray
argument_list|)
expr_stmt|;
name|gbl
operator|.
name|setConstraints
argument_list|(
name|manage
argument_list|,
name|con
argument_list|)
expr_stmt|;
name|add
argument_list|(
name|manage
argument_list|)
expr_stmt|;
name|manage
operator|.
name|addActionListener
argument_list|(
operator|new
name|ActionListener
argument_list|()
block|{
specifier|public
name|void
name|actionPerformed
parameter_list|(
name|ActionEvent
name|e
parameter_list|)
block|{
name|ContentSelectorDialog
name|csd
init|=
operator|new
name|ContentSelectorDialog
argument_list|(
name|frame
argument_list|,
literal|true
argument_list|,
name|metaData
argument_list|,
name|editor
operator|.
name|getFieldName
argument_list|()
argument_list|)
decl_stmt|;
name|Util
operator|.
name|placeDialog
argument_list|(
name|csd
argument_list|,
name|frame
argument_list|)
expr_stmt|;
name|csd
operator|.
name|show
argument_list|()
expr_stmt|;
name|updateList
argument_list|()
expr_stmt|;
block|}
block|}
argument_list|)
expr_stmt|;
block|}
DECL|method|updateList ()
specifier|private
name|void
name|updateList
parameter_list|()
block|{
name|list
operator|.
name|removeAllItems
argument_list|()
expr_stmt|;
name|list
operator|.
name|addItem
argument_list|(
name|Globals
operator|.
name|lang
argument_list|(
literal|"<select>"
argument_list|)
argument_list|)
expr_stmt|;
name|Vector
name|items
init|=
name|metaData
operator|.
name|getData
argument_list|(
name|Globals
operator|.
name|SELECTOR_META_PREFIX
operator|+
name|editor
operator|.
name|getFieldName
argument_list|()
argument_list|)
decl_stmt|;
if|if
condition|(
operator|(
name|items
operator|!=
literal|null
operator|)
operator|&&
operator|(
name|items
operator|.
name|size
argument_list|()
operator|>
literal|0
operator|)
condition|)
block|{
for|for
control|(
name|int
name|i
init|=
literal|0
init|;
name|i
operator|<
name|items
operator|.
name|size
argument_list|()
condition|;
name|i
operator|++
control|)
name|list
operator|.
name|addItem
argument_list|(
name|items
operator|.
name|elementAt
argument_list|(
name|i
argument_list|)
argument_list|)
expr_stmt|;
comment|//list = new JComboBox();
block|}
block|}
DECL|method|itemStateChanged (ItemEvent e)
specifier|public
name|void
name|itemStateChanged
parameter_list|(
name|ItemEvent
name|e
parameter_list|)
block|{
if|if
condition|(
name|e
operator|.
name|getStateChange
argument_list|()
operator|==
name|ItemEvent
operator|.
name|DESELECTED
condition|)
return|return;
comment|// We get an uninteresting DESELECTED event as well.
if|if
condition|(
name|list
operator|.
name|getSelectedIndex
argument_list|()
operator|==
literal|0
condition|)
return|return;
comment|// The first element is only for show.
name|String
name|chosen
init|=
operator|(
name|String
operator|)
name|list
operator|.
name|getSelectedItem
argument_list|()
decl_stmt|;
name|editor
operator|.
name|setText
argument_list|(
name|editor
operator|.
name|getText
argument_list|()
operator|+
name|chosen
operator|+
name|DELIMITER
argument_list|)
expr_stmt|;
name|parent
operator|.
name|storeFieldAction
operator|.
name|actionPerformed
argument_list|(
operator|new
name|ActionEvent
argument_list|(
name|editor
argument_list|,
literal|0
argument_list|,
literal|""
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
end_class

end_unit

