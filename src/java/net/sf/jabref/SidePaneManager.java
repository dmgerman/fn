begin_unit|revision:0.9.5;language:Java;cregit-version:0.0.1
begin_comment
comment|/* Copyright (C) 2003  Nizar N. Batada, Morten O. Alver  All programs in this directory and subdirectories are published under the GNU General Public License as described below.  This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA  Further information about the GNU GPL is available at: http://www.gnu.org/copyleft/gpl.ja.html  */
end_comment

begin_package
DECL|package|net.sf.jabref
package|package
name|net
operator|.
name|sf
operator|.
name|jabref
package|;
end_package

begin_import
import|import
name|javax
operator|.
name|swing
operator|.
name|*
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|LinkedHashMap
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Vector
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|groups
operator|.
name|GroupSelector
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Iterator
import|;
end_import

begin_class
DECL|class|SidePaneManager
specifier|public
class|class
name|SidePaneManager
block|{
DECL|field|frame
name|JabRefFrame
name|frame
decl_stmt|;
DECL|field|panel
name|BasePanel
name|panel
decl_stmt|;
DECL|field|sidep
name|SidePane
name|sidep
decl_stmt|;
DECL|field|prefs
name|JabRefPreferences
name|prefs
decl_stmt|;
DECL|field|metaData
name|MetaData
name|metaData
decl_stmt|;
DECL|field|components
name|LinkedHashMap
name|components
init|=
operator|new
name|LinkedHashMap
argument_list|()
decl_stmt|;
DECL|field|visible
name|Vector
name|visible
init|=
operator|new
name|Vector
argument_list|()
decl_stmt|;
DECL|field|visibleComponents
specifier|private
name|int
name|visibleComponents
init|=
literal|0
decl_stmt|;
DECL|method|SidePaneManager (JabRefFrame frame, BasePanel panel, JabRefPreferences prefs, MetaData metaData)
specifier|public
name|SidePaneManager
parameter_list|(
name|JabRefFrame
name|frame
parameter_list|,
name|BasePanel
name|panel
parameter_list|,
name|JabRefPreferences
name|prefs
parameter_list|,
name|MetaData
name|metaData
parameter_list|)
block|{
name|this
operator|.
name|prefs
operator|=
name|prefs
expr_stmt|;
name|this
operator|.
name|panel
operator|=
name|panel
expr_stmt|;
name|this
operator|.
name|metaData
operator|=
name|metaData
expr_stmt|;
name|this
operator|.
name|frame
operator|=
name|frame
expr_stmt|;
name|sidep
operator|=
operator|new
name|SidePane
argument_list|(
name|panel
argument_list|)
expr_stmt|;
block|}
DECL|method|populatePanel ()
specifier|public
name|void
name|populatePanel
parameter_list|()
block|{
comment|// Groups
if|if
condition|(
name|metaData
operator|.
name|getData
argument_list|(
literal|"groups"
argument_list|)
operator|!=
literal|null
condition|)
block|{
name|panel
operator|.
name|groupSelector
operator|=
operator|new
name|GroupSelector
argument_list|(
name|frame
argument_list|,
name|panel
argument_list|,
name|metaData
operator|.
name|getData
argument_list|(
literal|"groups"
argument_list|)
argument_list|,
name|this
argument_list|,
name|prefs
argument_list|)
expr_stmt|;
name|register
argument_list|(
literal|"groups"
argument_list|,
name|panel
operator|.
name|groupSelector
argument_list|)
expr_stmt|;
if|if
condition|(
name|prefs
operator|.
name|getBoolean
argument_list|(
literal|"groupSelectorVisible"
argument_list|)
condition|)
name|ensureVisible
argument_list|(
literal|"groups"
argument_list|)
expr_stmt|;
block|}
else|else
block|{
name|Vector
name|v
init|=
operator|new
name|Vector
argument_list|()
decl_stmt|;
name|metaData
operator|.
name|putData
argument_list|(
literal|"groups"
argument_list|,
name|v
argument_list|)
expr_stmt|;
name|panel
operator|.
name|groupSelector
operator|=
operator|new
name|GroupSelector
argument_list|(
name|frame
argument_list|,
name|panel
argument_list|,
name|v
argument_list|,
name|this
argument_list|,
name|prefs
argument_list|)
expr_stmt|;
name|register
argument_list|(
literal|"groups"
argument_list|,
name|panel
operator|.
name|groupSelector
argument_list|)
expr_stmt|;
block|}
if|if
condition|(
name|components
operator|.
name|size
argument_list|()
operator|>
literal|0
condition|)
block|{
name|panel
operator|.
name|setLeftComponent
argument_list|(
name|sidep
argument_list|)
expr_stmt|;
block|}
else|else
name|panel
operator|.
name|setLeftComponent
argument_list|(
literal|null
argument_list|)
expr_stmt|;
block|}
DECL|method|isPanelVisible (String name)
specifier|public
name|boolean
name|isPanelVisible
parameter_list|(
name|String
name|name
parameter_list|)
block|{
name|Object
name|o
init|=
name|components
operator|.
name|get
argument_list|(
name|name
argument_list|)
decl_stmt|;
if|if
condition|(
name|o
operator|!=
literal|null
condition|)
block|{
return|return
name|visible
operator|.
name|contains
argument_list|(
name|o
argument_list|)
return|;
block|}
else|else
block|{
name|System
operator|.
name|err
operator|.
name|println
argument_list|(
literal|"Side pane component '"
operator|+
name|name
operator|+
literal|"' unknown."
argument_list|)
expr_stmt|;
return|return
literal|false
return|;
block|}
block|}
DECL|method|togglePanel (String name)
specifier|public
name|void
name|togglePanel
parameter_list|(
name|String
name|name
parameter_list|)
block|{
name|Object
name|o
init|=
name|components
operator|.
name|get
argument_list|(
name|name
argument_list|)
decl_stmt|;
if|if
condition|(
name|o
operator|!=
literal|null
condition|)
block|{
if|if
condition|(
operator|!
name|visible
operator|.
name|contains
argument_list|(
name|o
argument_list|)
condition|)
block|{
name|visible
operator|.
name|add
argument_list|(
name|o
argument_list|)
expr_stmt|;
comment|//sidep.setComponents(visible);
name|updateView
argument_list|()
expr_stmt|;
operator|(
operator|(
name|SidePaneComponent
operator|)
name|o
operator|)
operator|.
name|componentOpening
argument_list|()
expr_stmt|;
block|}
else|else
block|{
name|visible
operator|.
name|remove
argument_list|(
name|o
argument_list|)
expr_stmt|;
comment|//sidep.setComponents(visible);
name|updateView
argument_list|()
expr_stmt|;
operator|(
operator|(
name|SidePaneComponent
operator|)
name|o
operator|)
operator|.
name|componentClosing
argument_list|()
expr_stmt|;
block|}
block|}
else|else
name|System
operator|.
name|err
operator|.
name|println
argument_list|(
literal|"Side pane component '"
operator|+
name|name
operator|+
literal|"' unknown."
argument_list|)
expr_stmt|;
comment|/* 	if (components.get(name) != null) { 	    if (!((SidePaneComponent)components.get(name)).isVisible()) { 		visibleComponents++; 		((SidePaneComponent)components.get(name)).setVisible(true); 		if (visibleComponents == 1) 		    panel.setLeftComponent(sidep);  		((SidePaneComponent)components.get(name)).componentOpening(); 		((SidePaneComponent)components.get(name)).setVisibility(true); 	    } else { 		hideAway((SidePaneComponent)components.get(name)); 	    } 	    return; // Component already there. 	} 	if (name.equals("groups")) { 	    if (metaData.getData("groups") == null) 		metaData.putData("groups", new Vector()); 	    panel.groupSelector = new GroupSelector 		(frame, panel, metaData.getData("groups"), this, prefs); 	    add("groups", panel.groupSelector); 	}        */
block|}
DECL|method|ensureVisible (String name)
specifier|public
specifier|synchronized
name|void
name|ensureVisible
parameter_list|(
name|String
name|name
parameter_list|)
block|{
name|Object
name|o
init|=
name|components
operator|.
name|get
argument_list|(
name|name
argument_list|)
decl_stmt|;
if|if
condition|(
name|o
operator|!=
literal|null
condition|)
block|{
if|if
condition|(
operator|!
name|visible
operator|.
name|contains
argument_list|(
name|o
argument_list|)
condition|)
block|{
name|visible
operator|.
name|add
argument_list|(
name|o
argument_list|)
expr_stmt|;
comment|//sidep.setComponents(visible);
name|updateView
argument_list|()
expr_stmt|;
operator|(
operator|(
name|SidePaneComponent
operator|)
name|o
operator|)
operator|.
name|componentOpening
argument_list|()
expr_stmt|;
block|}
block|}
else|else
name|System
operator|.
name|err
operator|.
name|println
argument_list|(
literal|"Side pane component '"
operator|+
name|name
operator|+
literal|"' unknown."
argument_list|)
expr_stmt|;
comment|/*Object o = components.get(name); 	if ((o == null) || ((SidePaneComponent)o).hasVisibility()) 	    return; 	togglePanel(name);*/
block|}
DECL|method|add (String name, SidePaneComponent comp)
specifier|public
specifier|synchronized
name|void
name|add
parameter_list|(
name|String
name|name
parameter_list|,
name|SidePaneComponent
name|comp
parameter_list|)
block|{
name|components
operator|.
name|put
argument_list|(
name|name
argument_list|,
name|comp
argument_list|)
expr_stmt|;
name|visible
operator|.
name|add
argument_list|(
name|comp
argument_list|)
expr_stmt|;
comment|//sidep.setComponents(visible);
name|updateView
argument_list|()
expr_stmt|;
name|comp
operator|.
name|componentOpening
argument_list|()
expr_stmt|;
comment|/*sidep.add(comp);         components.put(name, comp);         visibleComponents++;         if (visibleComponents == 1)             panel.setLeftComponent(sidep);           comp.componentOpening();         comp.setVisibility(true);*/
block|}
DECL|method|register (String name, SidePaneComponent comp)
specifier|public
specifier|synchronized
name|void
name|register
parameter_list|(
name|String
name|name
parameter_list|,
name|SidePaneComponent
name|comp
parameter_list|)
block|{
name|components
operator|.
name|put
argument_list|(
name|name
argument_list|,
name|comp
argument_list|)
expr_stmt|;
comment|/*comp.setVisible(false);       sidep.add(comp);       components.put(name, comp);*/
block|}
DECL|method|hasComponent (String name)
specifier|public
specifier|synchronized
name|boolean
name|hasComponent
parameter_list|(
name|String
name|name
parameter_list|)
block|{
return|return
operator|(
name|components
operator|.
name|get
argument_list|(
literal|"name"
argument_list|)
operator|!=
literal|null
operator|)
return|;
block|}
DECL|method|hideAway (String name)
specifier|public
specifier|synchronized
name|void
name|hideAway
parameter_list|(
name|String
name|name
parameter_list|)
block|{
name|Object
name|o
init|=
name|components
operator|.
name|get
argument_list|(
name|name
argument_list|)
decl_stmt|;
if|if
condition|(
name|o
operator|!=
literal|null
condition|)
block|{
operator|(
operator|(
name|SidePaneComponent
operator|)
name|o
operator|)
operator|.
name|componentClosing
argument_list|()
expr_stmt|;
if|if
condition|(
name|visible
operator|.
name|contains
argument_list|(
name|o
argument_list|)
condition|)
block|{
name|visible
operator|.
name|remove
argument_list|(
name|o
argument_list|)
expr_stmt|;
comment|//sidep.setComponents(visible);
name|updateView
argument_list|()
expr_stmt|;
block|}
block|}
else|else
name|System
operator|.
name|err
operator|.
name|println
argument_list|(
literal|"Side pane component '"
operator|+
name|name
operator|+
literal|"' unknown."
argument_list|)
expr_stmt|;
block|}
DECL|method|hideAway (SidePaneComponent comp)
specifier|public
specifier|synchronized
name|void
name|hideAway
parameter_list|(
name|SidePaneComponent
name|comp
parameter_list|)
block|{
name|comp
operator|.
name|componentClosing
argument_list|()
expr_stmt|;
name|visible
operator|.
name|remove
argument_list|(
name|comp
argument_list|)
expr_stmt|;
comment|//sidep.setComponents(visible);
name|updateView
argument_list|()
expr_stmt|;
comment|/*comp.componentClosing(); 	comp.setVisible(false);  // Swing method to make component invisible. 	comp.setVisibility(false); // Our own boolean to keep track of visibility. 	visibleComponents--; 	if (visibleComponents == 0) 	    panel.remove(sidep);       */
block|}
DECL|method|updateView ()
specifier|private
name|void
name|updateView
parameter_list|()
block|{
name|Vector
name|toShow
init|=
operator|new
name|Vector
argument_list|()
decl_stmt|;
for|for
control|(
name|Iterator
name|i
init|=
name|components
operator|.
name|keySet
argument_list|()
operator|.
name|iterator
argument_list|()
init|;
name|i
operator|.
name|hasNext
argument_list|()
condition|;
control|)
block|{
name|Object
name|key
init|=
name|i
operator|.
name|next
argument_list|()
decl_stmt|;
if|if
condition|(
name|visible
operator|.
name|contains
argument_list|(
name|components
operator|.
name|get
argument_list|(
name|key
argument_list|)
argument_list|)
condition|)
block|{
name|toShow
operator|.
name|add
argument_list|(
name|components
operator|.
name|get
argument_list|(
name|key
argument_list|)
argument_list|)
expr_stmt|;
block|}
block|}
name|sidep
operator|.
name|setComponents
argument_list|(
name|toShow
argument_list|)
expr_stmt|;
if|if
condition|(
name|visible
operator|.
name|size
argument_list|()
operator|>
literal|0
condition|)
name|panel
operator|.
name|setLeftComponent
argument_list|(
name|sidep
argument_list|)
expr_stmt|;
else|else
name|panel
operator|.
name|remove
argument_list|(
name|sidep
argument_list|)
expr_stmt|;
block|}
DECL|method|revalidate ()
specifier|public
name|void
name|revalidate
parameter_list|()
block|{
name|sidep
operator|.
name|revalidate
argument_list|()
expr_stmt|;
name|sidep
operator|.
name|repaint
argument_list|()
expr_stmt|;
block|}
block|}
end_class

end_unit

