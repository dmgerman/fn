begin_unit|revision:0.9.5;language:Java;cregit-version:0.0.1
begin_package
DECL|package|net.sf.jabref.logic.groups
package|package
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|logic
operator|.
name|groups
package|;
end_package

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|logic
operator|.
name|search
operator|.
name|matchers
operator|.
name|AndMatcher
import|;
end_import

begin_import
import|import
name|net
operator|.
name|sf
operator|.
name|jabref
operator|.
name|logic
operator|.
name|search
operator|.
name|matchers
operator|.
name|OrMatcher
import|;
end_import

begin_import
import|import
name|org
operator|.
name|junit
operator|.
name|Test
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Arrays
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|List
import|;
end_import

begin_import
import|import static
name|org
operator|.
name|junit
operator|.
name|Assert
operator|.
name|*
import|;
end_import

begin_class
DECL|class|GroupTreeNodeTest
specifier|public
class|class
name|GroupTreeNodeTest
block|{
comment|/**      * Gets the marked node in the following tree of explicit groups:      * Root      *      A ExplicitA, Including      *      A ExplicitParent, Independent (= parent)      *          B ExplicitNode, Refining (<-- this)      */
DECL|method|getNodeInSimpleTree (GroupTreeNode root)
specifier|public
name|GroupTreeNode
name|getNodeInSimpleTree
parameter_list|(
name|GroupTreeNode
name|root
parameter_list|)
block|{
name|root
operator|.
name|addSubgroup
argument_list|(
operator|new
name|ExplicitGroup
argument_list|(
literal|"ExplicitA"
argument_list|,
name|GroupHierarchyType
operator|.
name|INCLUDING
argument_list|)
argument_list|)
expr_stmt|;
name|GroupTreeNode
name|parent
init|=
name|root
operator|.
name|addSubgroup
argument_list|(
operator|new
name|ExplicitGroup
argument_list|(
literal|"ExplicitParent"
argument_list|,
name|GroupHierarchyType
operator|.
name|INDEPENDENT
argument_list|)
argument_list|)
decl_stmt|;
name|GroupTreeNode
name|node
init|=
name|parent
operator|.
name|addSubgroup
argument_list|(
operator|new
name|ExplicitGroup
argument_list|(
literal|"ExplicitNode"
argument_list|,
name|GroupHierarchyType
operator|.
name|REFINING
argument_list|)
argument_list|)
decl_stmt|;
return|return
name|node
return|;
block|}
DECL|method|getNodeInSimpleTree ()
specifier|public
name|GroupTreeNode
name|getNodeInSimpleTree
parameter_list|()
block|{
return|return
name|getNodeInSimpleTree
argument_list|(
name|getRoot
argument_list|()
argument_list|)
return|;
block|}
comment|/**      * Gets the marked node in the following tree:      * Root      *      A SearchA      *      A ExplicitA, Including      *      A ExplicitGrandParent (= grand parent)      *          B ExplicitB      *          B KeywordParent (= parent)      *              C KeywordNode (<-- this)      *                  D ExplicitChild (= child)      *              C SearchC      *              C ExplicitC      *              C KeywordC      *          B SearchB      *          B KeywordB      *      A KeywordA      */
DECL|method|getNodeInComplexTree (GroupTreeNode root)
specifier|public
name|GroupTreeNode
name|getNodeInComplexTree
parameter_list|(
name|GroupTreeNode
name|root
parameter_list|)
block|{
name|root
operator|.
name|addSubgroup
argument_list|(
name|getSearchGroup
argument_list|(
literal|"SearchA"
argument_list|)
argument_list|)
expr_stmt|;
name|root
operator|.
name|addSubgroup
argument_list|(
operator|new
name|ExplicitGroup
argument_list|(
literal|"ExplicitA"
argument_list|,
name|GroupHierarchyType
operator|.
name|INCLUDING
argument_list|)
argument_list|)
expr_stmt|;
name|GroupTreeNode
name|grandParent
init|=
name|root
operator|.
name|addSubgroup
argument_list|(
operator|new
name|ExplicitGroup
argument_list|(
literal|"ExplicitGrandParent"
argument_list|,
name|GroupHierarchyType
operator|.
name|INDEPENDENT
argument_list|)
argument_list|)
decl_stmt|;
name|root
operator|.
name|addSubgroup
argument_list|(
name|getKeywordGroup
argument_list|(
literal|"KeywordA"
argument_list|)
argument_list|)
expr_stmt|;
name|grandParent
operator|.
name|addSubgroup
argument_list|(
name|getExplict
argument_list|(
literal|"ExplicitB"
argument_list|)
argument_list|)
expr_stmt|;
name|GroupTreeNode
name|parent
init|=
name|grandParent
operator|.
name|addSubgroup
argument_list|(
name|getKeywordGroup
argument_list|(
literal|"KeywordParent"
argument_list|)
argument_list|)
decl_stmt|;
name|grandParent
operator|.
name|addSubgroup
argument_list|(
name|getSearchGroup
argument_list|(
literal|"SearchB"
argument_list|)
argument_list|)
expr_stmt|;
name|grandParent
operator|.
name|addSubgroup
argument_list|(
name|getKeywordGroup
argument_list|(
literal|"KeywordB"
argument_list|)
argument_list|)
expr_stmt|;
name|GroupTreeNode
name|node
init|=
name|parent
operator|.
name|addSubgroup
argument_list|(
name|getKeywordGroup
argument_list|(
literal|"KeywordNode"
argument_list|)
argument_list|)
decl_stmt|;
name|parent
operator|.
name|addSubgroup
argument_list|(
name|getSearchGroup
argument_list|(
literal|"SearchC"
argument_list|)
argument_list|)
expr_stmt|;
name|parent
operator|.
name|addSubgroup
argument_list|(
name|getExplict
argument_list|(
literal|"ExplicitC"
argument_list|)
argument_list|)
expr_stmt|;
name|parent
operator|.
name|addSubgroup
argument_list|(
name|getKeywordGroup
argument_list|(
literal|"KeywordC"
argument_list|)
argument_list|)
expr_stmt|;
name|node
operator|.
name|addSubgroup
argument_list|(
name|getExplict
argument_list|(
literal|"ExplicitChild"
argument_list|)
argument_list|)
expr_stmt|;
return|return
name|node
return|;
block|}
DECL|method|getKeywordGroup (String name)
specifier|private
name|AbstractGroup
name|getKeywordGroup
parameter_list|(
name|String
name|name
parameter_list|)
block|{
return|return
operator|new
name|KeywordGroup
argument_list|(
name|name
argument_list|,
literal|"searchField"
argument_list|,
literal|"searchExpression"
argument_list|,
literal|true
argument_list|,
literal|false
argument_list|,
name|GroupHierarchyType
operator|.
name|INDEPENDENT
argument_list|)
return|;
block|}
DECL|method|getSearchGroup (String name)
specifier|private
name|AbstractGroup
name|getSearchGroup
parameter_list|(
name|String
name|name
parameter_list|)
block|{
return|return
operator|new
name|SearchGroup
argument_list|(
name|name
argument_list|,
literal|"searchExpression"
argument_list|,
literal|true
argument_list|,
literal|false
argument_list|,
name|GroupHierarchyType
operator|.
name|INCLUDING
argument_list|)
return|;
block|}
DECL|method|getExplict (String name)
specifier|private
name|AbstractGroup
name|getExplict
parameter_list|(
name|String
name|name
parameter_list|)
block|{
return|return
operator|new
name|ExplicitGroup
argument_list|(
name|name
argument_list|,
name|GroupHierarchyType
operator|.
name|REFINING
argument_list|)
return|;
block|}
comment|/*     public GroupTreeNode getNodeInComplexTree() {         return getNodeInComplexTree(new TreeNodeMock());     }     */
comment|/**      * Gets the marked in the following tree:      * Root      *      A      *      A      *      A (<- this)      *      A      */
comment|/*     public GroupTreeNode getNodeAsChild(TreeNodeMock root) {         root.addChild(new TreeNodeMock());         root.addChild(new TreeNodeMock());         TreeNodeMock node = new TreeNodeMock();         root.addChild(node);         root.addChild(new TreeNodeMock());         return node;     }     */
DECL|method|getRoot ()
specifier|public
name|GroupTreeNode
name|getRoot
parameter_list|()
block|{
return|return
operator|new
name|GroupTreeNode
argument_list|(
operator|new
name|AllEntriesGroup
argument_list|()
argument_list|)
return|;
block|}
annotation|@
name|Test
DECL|method|getTreeAsStringInSimpleTree ()
specifier|public
name|void
name|getTreeAsStringInSimpleTree
parameter_list|()
throws|throws
name|Exception
block|{
name|GroupTreeNode
name|root
init|=
name|getRoot
argument_list|()
decl_stmt|;
name|getNodeInSimpleTree
argument_list|(
name|root
argument_list|)
expr_stmt|;
name|List
argument_list|<
name|String
argument_list|>
name|expected
init|=
name|Arrays
operator|.
name|asList
argument_list|(
literal|"0 AllEntriesGroup:"
argument_list|,
literal|"1 ExplicitGroup:ExplicitA;2;"
argument_list|,
literal|"1 ExplicitGroup:ExplicitParent;0;"
argument_list|,
literal|"2 ExplicitGroup:ExplicitNode;1;"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|expected
argument_list|,
name|root
operator|.
name|getTreeAsString
argument_list|()
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|getTreeAsStringInComplexTree ()
specifier|public
name|void
name|getTreeAsStringInComplexTree
parameter_list|()
throws|throws
name|Exception
block|{
name|GroupTreeNode
name|root
init|=
name|getRoot
argument_list|()
decl_stmt|;
name|getNodeInComplexTree
argument_list|(
name|root
argument_list|)
expr_stmt|;
name|List
argument_list|<
name|String
argument_list|>
name|expected
init|=
name|Arrays
operator|.
name|asList
argument_list|(
literal|"0 AllEntriesGroup:"
argument_list|,
literal|"1 SearchGroup:SearchA;2;searchExpression;1;0;"
argument_list|,
literal|"1 ExplicitGroup:ExplicitA;2;"
argument_list|,
literal|"1 ExplicitGroup:ExplicitGrandParent;0;"
argument_list|,
literal|"2 ExplicitGroup:ExplicitB;1;"
argument_list|,
literal|"2 KeywordGroup:KeywordParent;0;searchField;searchExpression;1;0;"
argument_list|,
literal|"3 KeywordGroup:KeywordNode;0;searchField;searchExpression;1;0;"
argument_list|,
literal|"4 ExplicitGroup:ExplicitChild;1;"
argument_list|,
literal|"3 SearchGroup:SearchC;2;searchExpression;1;0;"
argument_list|,
literal|"3 ExplicitGroup:ExplicitC;1;"
argument_list|,
literal|"3 KeywordGroup:KeywordC;0;searchField;searchExpression;1;0;"
argument_list|,
literal|"2 SearchGroup:SearchB;2;searchExpression;1;0;"
argument_list|,
literal|"2 KeywordGroup:KeywordB;0;searchField;searchExpression;1;0;"
argument_list|,
literal|"1 KeywordGroup:KeywordA;0;searchField;searchExpression;1;0;"
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|expected
argument_list|,
name|root
operator|.
name|getTreeAsString
argument_list|()
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|getSearchRuleForIndependentGroupReturnsGroupAsMatcher ()
specifier|public
name|void
name|getSearchRuleForIndependentGroupReturnsGroupAsMatcher
parameter_list|()
block|{
name|GroupTreeNode
name|node
init|=
operator|new
name|GroupTreeNode
argument_list|(
operator|new
name|ExplicitGroup
argument_list|(
literal|"node"
argument_list|,
name|GroupHierarchyType
operator|.
name|INDEPENDENT
argument_list|)
argument_list|)
decl_stmt|;
name|assertEquals
argument_list|(
name|node
operator|.
name|getGroup
argument_list|()
argument_list|,
name|node
operator|.
name|getSearchRule
argument_list|()
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|getSearchRuleForRefiningGroupReturnsParentAndGroupAsMatcher ()
specifier|public
name|void
name|getSearchRuleForRefiningGroupReturnsParentAndGroupAsMatcher
parameter_list|()
block|{
name|GroupTreeNode
name|parent
init|=
operator|new
name|GroupTreeNode
argument_list|(
operator|new
name|ExplicitGroup
argument_list|(
literal|"parent"
argument_list|,
name|GroupHierarchyType
operator|.
name|INDEPENDENT
argument_list|)
argument_list|)
decl_stmt|;
name|GroupTreeNode
name|node
init|=
name|parent
operator|.
name|addSubgroup
argument_list|(
operator|new
name|ExplicitGroup
argument_list|(
literal|"node"
argument_list|,
name|GroupHierarchyType
operator|.
name|REFINING
argument_list|)
argument_list|)
decl_stmt|;
name|AndMatcher
name|matcher
init|=
operator|new
name|AndMatcher
argument_list|()
decl_stmt|;
name|matcher
operator|.
name|addRule
argument_list|(
name|node
operator|.
name|getGroup
argument_list|()
argument_list|)
expr_stmt|;
name|matcher
operator|.
name|addRule
argument_list|(
name|parent
operator|.
name|getGroup
argument_list|()
argument_list|)
expr_stmt|;
name|assertEquals
argument_list|(
name|matcher
argument_list|,
name|node
operator|.
name|getSearchRule
argument_list|()
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Test
DECL|method|getSearchRuleForIncludingGroupReturnsGroupOrSubgroupAsMatcher ()
specifier|public
name|void
name|getSearchRuleForIncludingGroupReturnsGroupOrSubgroupAsMatcher
parameter_list|()
block|{
name|GroupTreeNode
name|node
init|=
operator|new
name|GroupTreeNode
argument_list|(
operator|new
name|ExplicitGroup
argument_list|(
literal|"node"
argument_list|,
name|GroupHierarchyType
operator|.
name|INCLUDING
argument_list|)
argument_list|)
decl_stmt|;
name|GroupTreeNode
name|child
init|=
name|node
operator|.
name|addSubgroup
argument_list|(
operator|new
name|ExplicitGroup
argument_list|(
literal|"child"
argument_list|,
name|GroupHierarchyType
operator|.
name|INDEPENDENT
argument_list|)
argument_list|)
decl_stmt|;
name|OrMatcher
name|matcher
init|=
operator|new
name|OrMatcher
argument_list|()
decl_stmt|;
name|matcher
operator|.
name|addRule
argument_list|(
name|node
operator|.
name|getGroup
argument_list|()
argument_list|)
expr_stmt|;
name|matcher
operator|.
name|addRule
argument_list|(
name|child
operator|.
name|getGroup
argument_list|()
argument_list|)
expr_stmt|;
name|assertEquals
argument_list|(
name|matcher
argument_list|,
name|node
operator|.
name|getSearchRule
argument_list|()
argument_list|)
expr_stmt|;
block|}
block|}
end_class

end_unit

